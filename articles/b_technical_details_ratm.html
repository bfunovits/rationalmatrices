<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Rational Matrices: Technical Details • rationalmatrices</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Rational Matrices: Technical Details">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rationalmatrices</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a_rational_matrices.html">Rational Matrices</a></li>
    <li><a class="dropdown-item" href="../articles/b_technical_details_ratm.html">Rational Matrices: Technical Details</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bfunovits/rationalmatrices/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Rational Matrices: Technical Details</h1>
                        <h4 data-toc-skip class="author">Wolfgang
Scherrer and Bernd Funovits</h4>
            
            <h4 data-toc-skip class="date">2026-01-18</h4>
      

      <div class="d-none name"><code>b_technical_details_ratm.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette provides technical implementation details and
mathematical theory underlying the <code>rationalmatrices</code>
package. It complements the main user guide (Rational Matrices vignette)
with in-depth coverage of algorithms, numerical methods, and theoretical
foundations.</p>
<p><strong>Topics covered:</strong> - <strong>Left Coprime
Polynomials</strong> - Part of Analysis &amp; Properties (#5) -
<strong>Column Reduced Matrix</strong> - Supporting theory for Normal
Forms (#4) - <strong>Realization Algorithms</strong> - Deep dive into
Realization Algorithms (#2) - <strong>Operations with State-Space
Realizations</strong> - Theory for State-Space Tools (#6) -
<strong>Schur, QZ, Lyapunov</strong> - Numerical Methods (#7) -
<strong>Reflect Poles and Zeroes</strong> - Theory for Pole/Zero
Reflection (#8)</p>
<p>For implementation details of these topics, see the source files
listed in CLAUDE.md and the main vignette.</p>
<hr>
</div>
<div class="section level2">
<h2 id="coprime-section">Left Coprime Polynomials<a class="anchor" aria-label="anchor" href="#coprime-section"></a>
</h2>
<div class="section level3">
<h3 id="functional-area-analysis-properties-5">Functional Area: Analysis &amp; Properties (#5)<a class="anchor" aria-label="anchor" href="#functional-area-analysis-properties-5"></a>
</h3>
<p>See <code>R/is_methods.R</code> for implementation.</p>
<p>A polynomial matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
is called <em>left prime</em>, if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c(z)</annotation></semantics></math>
has full row rank everywhere in the complex plane. Clearly this implies
that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
is square or “wide”, i.e. if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo>×</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(m \times n)</annotation></semantics></math>-dimensional
then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>≤</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m \leq n</annotation></semantics></math>
must hold.</p>
<p>A pair
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a,b)</annotation></semantics></math>
of (compatible) polynomial matrices is called <em>left coprime</em> if
the matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">c=[a,b]</annotation></semantics></math>
is left prime. This case is important for the structure of left matrix
fraction descriptions. Suppose
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>a</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c(z)=a^{-1} b(z)</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
is a square, non singular polynomial matrix. If the pair is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a,b)</annotation></semantics></math>
is <em>not</em> left coprime, then we may cancel a common, non
unimodular, factor and thus obtain a “simpler” representation for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c(z)</annotation></semantics></math>.</p>
<p>We discuss two strategies for testing whether a polynomial matrix is
left prime. The first approach uses a Hermite normal form (HNF) and the
second one tackles this problem via a (singular) pencil.</p>
<p>The approach via singular pencils is numerically stable and thus is
implemented in the function <code><a href="../reference/is.coprime.html">is.coprime()</a></code>. See also the
examples below.</p>
<p>First note that the problem is easy to tackle in the case that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
has degree zero. Here we just have to check the left kernel of the
coefficient matrix of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>z</mi><mn>0</mn></msup><annotation encoding="application/x-tex">z^0</annotation></semantics></math>.
Also the case where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
is “tall”, i.e. the number of rows is larger than the number of columns
is trivial. In this case
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
clearly cannot be left prime, since the rank of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c(z)</annotation></semantics></math>
is smaller than the number of rows for any
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>∈</mo><mi>ℂ</mi></mrow><annotation encoding="application/x-tex">z \in \mathbb{C}</annotation></semantics></math>.</p>
<p>Therefore throughout this section, we assume that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
is an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo>×</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(m \times n)</annotation></semantics></math>-dimensional
polynomial matrix with degree
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">p &gt; 0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>≤</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m \leq n</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="hermite-normal-form">Hermite Normal Form<a class="anchor" aria-label="anchor" href="#hermite-normal-form"></a>
</h3>
<p>Consider the <em>row Hermite form</em> obtained from elementary
column operations
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>u</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>h</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>u</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
c(z) = h(z) u(z) = h_1(z) u_1(z)
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>u</mi><annotation encoding="application/x-tex">u</annotation></semantics></math>
is an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>×</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(n \times n)</annotation></semantics></math>-dimensional
unimodular modular matrix,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>
is an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo>×</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(m \times n)</annotation></semantics></math>-dimensional
lower (quasi) triangular matrix.</p>
<p>The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo>×</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(m \times m)</annotation></semantics></math>-dimensional
matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>h</mi><mn>1</mn></msub><annotation encoding="application/x-tex">h_1</annotation></semantics></math>
is obtained from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>
by selecting the first
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
columns and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>u</mi><mn>1</mn></msub><annotation encoding="application/x-tex">u_1</annotation></semantics></math>
consists of the first
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
rows of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>u</mi><annotation encoding="application/x-tex">u</annotation></semantics></math>.
Note that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>h</mi><mn>1</mn></msub><annotation encoding="application/x-tex">h_1</annotation></semantics></math>
is a square, lower triangular matrix, where the diagonal elements are
either monic or zero, and if a diagonal element is non zero, then all
elements to the left of this element have a lower degree.</p>
<p>Furthermore note that the rank of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c(z)</annotation></semantics></math>
is equal to the rank of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">h_1(z)</annotation></semantics></math>
for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>∈</mo><mi>ℂ</mi></mrow><annotation encoding="application/x-tex">z \in \mathbb{C}</annotation></semantics></math>.
Therefore the rank of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c(z)</annotation></semantics></math>
is less than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
if and only
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
is a zero of the product of the diagonal entries:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mn>11</mn></msub><msub><mi>h</mi><mn>22</mn></msub><mi>⋯</mi><msub><mi>h</mi><mrow><mi>m</mi><mi>m</mi></mrow></msub></mrow><annotation encoding="application/x-tex">h_{11} h_{22} \cdots h_{mm}</annotation></semantics></math>.
The following cases may occur</p>
<ol style="list-style-type: decimal">
<li>All diagonal elements
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>h</mi><mrow><mi>i</mi><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">h_{ii}</annotation></semantics></math>
are constant (and hence
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mn>1</mn></msub><mo>=</mo><msub><mi>I</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">h_1 = I_m</annotation></semantics></math>
must hold). In this case
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">rk</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">\mbox{rk}(c(z))=m</annotation></semantics></math>
for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>∈</mo><mi>ℂ</mi></mrow><annotation encoding="application/x-tex">z\in \mathbb{C}</annotation></semantics></math>
and thus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
is <em>coprime</em>.</li>
<li>One of the diagonal elements is zero: In this case
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">rk</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">\mbox{rk}(c(z))&lt;m</annotation></semantics></math>
holds for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>∈</mo><mi>ℂ</mi></mrow><annotation encoding="application/x-tex">z\in \mathbb{C}</annotation></semantics></math>
and thus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
is <em>not coprime</em>.</li>
<li>The diagonal elements are non zero and at least one of them has a
degree larger than zero. In this case
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">rk</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">\mbox{rk}(c(z))=m</annotation></semantics></math>
except for the zeroes of the polynomial
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>h</mi><mn>11</mn></msub><msub><mi>h</mi><mn>22</mn></msub><mi>⋯</mi><msub><mi>h</mi><mrow><mi>m</mi><mi>m</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(h_{11} h_{22} \cdots h_{mm})</annotation></semantics></math>.
Also in this case,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
is <em>not coprime</em>.</li>
</ol>
<p>Hence, the polynomial
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
is left prime if and only if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mn>1</mn></msub><mo>=</mo><msub><mi>I</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">h_1 = I_m</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="generalized-pencils">Generalized Pencils<a class="anchor" aria-label="anchor" href="#generalized-pencils"></a>
</h3>
<p>As reference for generalized pencils, see</p>
<ul>
<li><span class="citation">[@Gantmacher1959, Chapter XII (in particular
§4 on page 35ff)]</span></li>
<li><span class="citation">[@Kailath80, page 393ff]</span></li>
<li><span class="citation">[@DemmelKagstroem1993]</span></li>
</ul>
<p>We first construct a <em>pencil</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo>−</mo><mi>B</mi><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(z)=(A-Bz)</annotation></semantics></math>
such that for any
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>∈</mo><mi>ℂ</mi></mrow><annotation encoding="application/x-tex">z \in \mathbb{C}</annotation></semantics></math>
the left kernel of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c(z)</annotation></semantics></math>
and of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(z)</annotation></semantics></math>
have the same dimension. This means that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
is left prime if and only if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
is left prime. Furthermore the zeroes of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
and of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
are the same.</p>
<p>The condition
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>u</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mn>0</mn></msub><mo>+</mo><msub><mi>c</mi><mn>1</mn></msub><mi>z</mi><mo>+</mo><mi>⋯</mi><mo>+</mo><msub><mi>c</mi><mi>p</mi></msub><msup><mi>z</mi><mi>p</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">
u c(z) = u (c_0 + c_1 z + \cdots + c_p z^p) = 0
</annotation></semantics></math> for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>∈</mo><mi>ℂ</mi></mrow><annotation encoding="application/x-tex">z \in \mathbb{C}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>∈</mo><msup><mi>ℂ</mi><mrow><mn>1</mn><mo>×</mo><mi>m</mi></mrow></msup><mo>,</mo><mi>u</mi><mo>≠</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">u \in \mathbb{C}^{1 \times m}, u \neq 0</annotation></semantics></math>
is equivalent to the condition that
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>v</mi><mn>1</mn></msub><mo>,</mo><msub><mi>v</mi><mn>2</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>v</mi><mi>p</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>c</mi><mn>0</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>I</mi><mi>n</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="center" style="text-align: center"><mo>⋱</mo></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>I</mi><mi>n</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>v</mi><mn>1</mn></msub><mo>,</mo><msub><mi>v</mi><mn>2</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>v</mi><mi>p</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mo>−</mo><msub><mi>c</mi><mn>1</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><mo>−</mo><msub><mi>c</mi><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><mo>−</mo><msub><mi>c</mi><mi>p</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>I</mi><mi>n</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="center" style="text-align: center"><mo>⋱</mo></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>I</mi><mi>n</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">
(v_1,v_2,\ldots,v_p)
\begin{pmatrix}
c_0 &amp; 0      &amp; \cdots  &amp; 0 \\
0   &amp; I_{n}      &amp; \cdots  &amp;  0 \\ 
0   &amp; \vdots &amp; \ddots  &amp;  \vdots \\ 
0   &amp; 0      &amp; \cdots  &amp; I_{n} \\ 
\end{pmatrix} = 
(v_1,v_2,\ldots,v_p)
\begin{pmatrix}
-c_1    &amp; \cdots &amp; -c_{p-1} &amp; -c_p \\
I_{n}      &amp; \cdots &amp; 0       &amp; 0 \\
\vdots &amp; \ddots &amp; \vdots  &amp; \vdots \\
0      &amp; \cdots &amp; I_{n} &amp; 0 
\end{pmatrix} z
</annotation></semantics></math> for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mn>1</mn></msub><mo>∈</mo><msup><mi>ℂ</mi><mrow><mn>1</mn><mo>×</mo><mi>m</mi></mrow></msup></mrow><annotation encoding="application/x-tex">v_1 \in \mathbb{C}^{1 \times m}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mn>1</mn></msub><mo>≠</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">v_1 \neq 0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>j</mi></msub><mo>∈</mo><msup><mi>ℂ</mi><mrow><mn>1</mn><mo>×</mo><mi>n</mi></mrow></msup></mrow><annotation encoding="application/x-tex">v_j\in \mathbb{C}^{1\times n}</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>2</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">i=2,\ldots ,p</annotation></semantics></math>.
This follows immediately be rewriting the above condition as
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>v</mi><mn>2</mn></msub><mi>z</mi></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>v</mi><mn>1</mn></msub><msub><mi>c</mi><mn>0</mn></msub><mo>+</mo><msub><mi>v</mi><mn>1</mn></msub><msub><mi>c</mi><mn>1</mn></msub><mi>z</mi><mo>=</mo><msub><mi>v</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mn>0</mn></msub><mo>+</mo><msub><mi>c</mi><mn>1</mn></msub><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>v</mi><mn>3</mn></msub><msup><mi>z</mi><mn>2</mn></msup></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>v</mi><mn>2</mn></msub><mo>+</mo><msub><mi>v</mi><mn>1</mn></msub><msub><mi>c</mi><mn>2</mn></msub><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>z</mi><mo>=</mo><msub><mi>v</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mn>0</mn></msub><mo>+</mo><msub><mi>c</mi><mn>1</mn></msub><mi>z</mi><mo>+</mo><msub><mi>c</mi><mn>2</mn></msub><msup><mi>z</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>v</mi><mn>4</mn></msub><msup><mi>z</mi><mn>3</mn></msup></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>v</mi><mn>3</mn></msub><mo>+</mo><msub><mi>v</mi><mn>1</mn></msub><msub><mi>c</mi><mn>3</mn></msub><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>z</mi><mn>2</mn></msup><mo>=</mo><msub><mi>v</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mn>0</mn></msub><mo>+</mo><msub><mi>c</mi><mn>1</mn></msub><mi>z</mi><mo>+</mo><msub><mi>c</mi><mn>2</mn></msub><msup><mi>z</mi><mn>2</mn></msup><mo>+</mo><msub><mi>c</mi><mn>3</mn></msub><msup><mi>z</mi><mn>3</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="left" style="text-align: left"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>v</mi><mi>p</mi></msub><msup><mi>z</mi><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msup></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>v</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mn>0</mn></msub><mo>+</mo><msub><mi>c</mi><mn>1</mn></msub><mi>z</mi><mo>+</mo><mi>⋯</mi><mo>+</mo><msub><mi>c</mi><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msub><msup><mi>z</mi><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mo>−</mo><msub><mi>v</mi><mn>1</mn></msub><msub><mi>c</mi><mi>p</mi></msub><msup><mi>z</mi><mi>p</mi></msup></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>v</mi><mi>p</mi></msub><msup><mi>z</mi><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msup></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{array}{rcl}
v_2 z   &amp;=&amp; v_1 c_0 + v_1 c_1 z = v_1 (c_0 + c_1 z) \\
v_3 z^2 &amp;=&amp; (v_2 + v_1 c_2 z) z = v_1 (c_0 + c_1 z + c_2 z^2) \\
v_4 z^3 &amp;=&amp; (v_3 + v_1 c_3 z) z^2 = v_1 (c_0 + c_1 z + c_2 z^2 + c_3 z^3) \\
 &amp; \vdots &amp;  \\
v_p z^{p-1} &amp;=&amp; v_1 (c_0 + c_1 z + \cdots + c_{p-1} z^{p-1}) \\
-v_1 c_p z^p &amp;=&amp; v_p z^{p-1}
\end{array}
</annotation></semantics></math> see also <span class="citation">@Kailath80</span>, page 393ff. Combining the last two
equations gives
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>=</mo><msub><mi>v</mi><mi>p</mi></msub><msup><mi>z</mi><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><msub><mi>v</mi><mn>1</mn></msub><msub><mi>c</mi><mi>p</mi></msub><msup><mi>z</mi><mi>p</mi></msup><mo>=</mo><msub><mi>v</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mn>0</mn></msub><mo>+</mo><msub><mi>c</mi><mn>1</mn></msub><mi>z</mi><mo>+</mo><mi>⋯</mi><mo>+</mo><msub><mi>c</mi><mi>p</mi></msub><msup><mi>z</mi><mi>p</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
0 = v_pz^{p-1} + v_1 c_p z^p = v_1 (c_0 + c_1 z + \cdots + c_{p} z^{p}).
</annotation></semantics></math></p>
<p>Therefore the matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c(z)</annotation></semantics></math>
has a non trivial left kernel if and only if the pencil
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo>−</mo><mi>B</mi><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(z) = (A - Bz)</annotation></semantics></math>,<br><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>c</mi><mn>0</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>I</mi><mi>n</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="center" style="text-align: center"><mo>⋱</mo></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>I</mi><mi>n</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><mi>B</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mo>−</mo><msub><mi>c</mi><mn>1</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><mo>−</mo><msub><mi>c</mi><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><mo>−</mo><msub><mi>c</mi><mi>p</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>I</mi><mi>n</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="center" style="text-align: center"><mo>⋱</mo></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>I</mi><mi>n</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
A = \begin{pmatrix}
c_0 &amp; 0      &amp; \cdots  &amp; 0 \\
0   &amp; I_{n}      &amp; \cdots  &amp;  0 \\ 
0   &amp; \vdots &amp; \ddots  &amp;  \vdots \\ 
0   &amp; 0      &amp; \cdots  &amp; I_{n} \\ 
\end{pmatrix}, \quad
B = \begin{pmatrix}
-c_1    &amp; \cdots &amp; -c_{p-1} &amp; -c_p \\
I_{n}      &amp; \cdots &amp; 0       &amp; 0 \\
\vdots &amp; \ddots &amp; \vdots  &amp; \vdots \\
0      &amp; \cdots &amp; I_{n} &amp; 0 
\end{pmatrix}, 
</annotation></semantics></math> has a non trivial left kernel. This
implies
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
is left prime if and only if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
is left prime.</p>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="staircase-form">Staircase Form<a class="anchor" aria-label="anchor" href="#staircase-form"></a>
</h4>
<p>In order to analyze the left kernel this pencil, we transform the
pencil (by multiplication with orthogonal matrices from the left and the
right) into a so called <em>staircase form</em>. To simplify notation we
set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo>+</mo><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">M=(m+n(p-1))</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mi>n</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">N = np</annotation></semantics></math>,
i.e. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>M</mi><mo>,</mo><mi>N</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(M,N)</annotation></semantics></math>
now denotes the dimension of the pencil
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(z)</annotation></semantics></math>.
Note that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>−</mo><mi>N</mi><mo>=</mo><mi>m</mi><mo>−</mo><mi>n</mi><mo>≠</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">M-N = m-n \neq 0</annotation></semantics></math>
in general, which means that we have to deal with <em>non regular</em>
pencils.</p>
<p>The procedure described below works for an arbitary pencil, i.e. we
do not impose the above special structure and we also consider the case
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>&gt;</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">M&gt;N</annotation></semantics></math>.</p>
<ol style="list-style-type: lower-alpha">
<li><p>If the pencil
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo>−</mo><mi>B</mi><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(z) = (A-Bz)</annotation></semantics></math>
is “tall”,
i.e. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>&gt;</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">M &gt; N</annotation></semantics></math>,
then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(z)</annotation></semantics></math>
has a non trivial left kernel for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>∈</mo><mi>ℂ</mi></mrow><annotation encoding="application/x-tex">z \in \mathbb{C}</annotation></semantics></math>.<br>
In this case
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
(and the matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>)
is <em>not</em> left prime.</p></li>
<li><p>If the pencil
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo>−</mo><mi>B</mi><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(z)=(A-Bz)</annotation></semantics></math>
is square,
i.e. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">M=N</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
is non singular, then the zeroes of the pencil
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(z)</annotation></semantics></math>
(and the zeroes of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c(z)</annotation></semantics></math>)
are the eigenvalues of the matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><msup><mi>B</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">AB^{-1}</annotation></semantics></math>.<br>
In this case
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
(and the matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>)
is <em>not</em> left prime.</p></li>
</ol>
<p>Now suppose that the <em>right kernel</em> of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mn>1</mn></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">N_1 &gt; 0</annotation></semantics></math>
dimensional. If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mn>1</mn></msub><mo>=</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">N_1 = N</annotation></semantics></math>,
i.e. if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">B=0</annotation></semantics></math>,
then two cases may occur:</p>
<ol start="3" style="list-style-type: lower-alpha">
<li>The matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
has full row rank.<br>
In this case the pencil
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
(and the matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>)
is left prime.</li>
<li>The matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
does not have full row rank and hence
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(z)</annotation></semantics></math>
has a non trivial left kernel for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>∈</mo><mi>ℂ</mi></mrow><annotation encoding="application/x-tex">z \in \mathbb{C}</annotation></semantics></math>.<br>
In this case
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
(and the matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>)
is <em>not</em> left prime.</li>
</ol>
<p>Finally suppose that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><msub><mi>N</mi><mn>1</mn></msub><mo>&lt;</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">0 &lt; N_1 &lt;N</annotation></semantics></math>
holds and let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><msub><mi>M</mi><mn>1</mn></msub><mo>≤</mo><msub><mi>N</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">0 \leq M_1 \leq N_1</annotation></semantics></math>
denote the rank of the first
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>N</mi><mn>1</mn></msub><annotation encoding="application/x-tex">N_1</annotation></semantics></math>
columns of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>V</mi></mrow><annotation encoding="application/x-tex">AV</annotation></semantics></math>.
Then there exists an orthogonal transformation,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>U</mi><annotation encoding="application/x-tex">U</annotation></semantics></math>
say, such that the first
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>M</mi><mn>1</mn></msub><annotation encoding="application/x-tex">M_1</annotation></semantics></math>
rows of the first
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>N</mi><mn>1</mn></msub><annotation encoding="application/x-tex">N_1</annotation></semantics></math>
columns of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mi>′</mi><mi>A</mi><mi>V</mi></mrow><annotation encoding="application/x-tex">U'AV</annotation></semantics></math>
have full rank
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>M</mi><mn>1</mn></msub><annotation encoding="application/x-tex">M_1</annotation></semantics></math>
and the remaining rows are zero.</p>
<p>Using the same symbols for the transformed pencil we get
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>A</mi><mn>11</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>A</mi><mn>12</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mn>0</mn><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>M</mi><mo>−</mo><msub><mi>M</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>×</mo><msub><mi>N</mi><mn>1</mn></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>A</mi><mn>22</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mn>0</mn><mrow><msub><mi>M</mi><mn>1</mn></msub><mo>×</mo><msub><mi>N</mi><mn>1</mn></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>B</mi><mn>12</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mn>0</mn><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>M</mi><mo>−</mo><msub><mi>M</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>×</mo><msub><mi>N</mi><mn>1</mn></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>B</mi><mn>22</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mi>z</mi><mo>,</mo><mspace width="1.0em"></mspace><msub><mi>A</mi><mn>11</mn></msub><mo>∈</mo><msup><mi>ℝ</mi><mrow><msub><mi>M</mi><mn>1</mn></msub><mo>×</mo><msub><mi>N</mi><mn>1</mn></msub></mrow></msup><mi>.</mi></mrow><annotation encoding="application/x-tex">
P (z) = 
\begin{pmatrix}
A_{11} &amp; A_{12} \\ 
0_{(M-M_1) \times N_1} &amp; A_{22} 
\end{pmatrix} 
- 
\begin{pmatrix}
0_{M_1\times N_1} &amp; B_{12} \\
0_{(M-M_1) \times N_1} &amp; B_{22}
\end{pmatrix}z,\quad A_{11} \in \mathbb{R}^{M_1 \times N_1}.
</annotation></semantics></math> Clearly
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(z)</annotation></semantics></math>
has full row rank if and only if the <em>reduced</em> pencil
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>A</mi><mn>22</mn></msub><mo>−</mo><msub><mi>B</mi><mn>22</mn></msub><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(A_{22} - B_{22} z)</annotation></semantics></math>
has full row rank.</p>
<p>Now we iterate this procedure with the reduced pencil
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>A</mi><mn>22</mn></msub><mo>−</mo><msub><mi>B</mi><mn>22</mn></msub><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(A_{22} - B_{22}z)</annotation></semantics></math>
until we end up with the following staircase form of the pencil:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>A</mi><mn>11</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>A</mi><mrow><mn>1</mn><mo>,</mo><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>A</mi><mrow><mn>1</mn><mi>k</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="center" style="text-align: center"><mo>⋱</mo></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mn>0</mn><mrow><msub><mi>M</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>×</mo><msub><mi>N</mi><mn>1</mn></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>A</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>A</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mn>0</mn><mrow><msub><mi>M</mi><mi>k</mi></msub><mo>×</mo><msub><mi>N</mi><mn>1</mn></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mn>0</mn><mrow><msub><mi>M</mi><mi>k</mi></msub><mo>×</mo><msub><mi>N</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>A</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mn>0</mn><mrow><msub><mi>M</mi><mn>1</mn></msub><mo>×</mo><msub><mi>N</mi><mn>1</mn></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>B</mi><mrow><mn>1</mn><mo>,</mo><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>B</mi><mrow><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="center" style="text-align: center"><mo>⋱</mo></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mn>0</mn><mrow><msub><mi>M</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>×</mo><msub><mi>N</mi><mn>1</mn></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mn>0</mn><mrow><msub><mi>M</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>×</mo><msub><mi>N</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>B</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mn>0</mn><mrow><msub><mi>M</mi><mi>k</mi></msub><mo>×</mo><msub><mi>N</mi><mn>1</mn></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mn>0</mn><mrow><msub><mi>M</mi><mi>k</mi></msub><mo>×</mo><msub><mi>N</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>B</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">
P (z) = 
\begin{pmatrix}
A_{11}                 &amp; \cdots &amp; A_{1,k-1}              &amp; A_{1k} \\ 
\vdots                 &amp; \ddots &amp; \vdots                 &amp; \vdots  \\
0_{M_{k-1} \times N_1} &amp; \cdots &amp; A_{k-1,k-1}            &amp; A_{k-1, k}\\
0_{M_k \times N_1}     &amp; \cdots &amp; 0_{M_k \times N_{k-1}} &amp; A_{kk}  \\
\end{pmatrix} 
- 
\begin{pmatrix}
0_{M_1 \times N_1}     &amp; \cdots &amp; B_{1,k-1}                   &amp; B_{1,k} \\ 
\vdots                 &amp; \ddots &amp;  \vdots                     &amp; \vdots   \\
0_{M_{k-1} \times N_1} &amp; \cdots &amp; 0_{M_{k-1} \times N_{k-1}}  &amp; B_{k-1,k} \\
0_{M_k \times N_1}     &amp; \cdots &amp; 0_{M_k \times N_{k-1}}      &amp; B_{kk} \\
\end{pmatrix} z
</annotation></semantics></math> The diagonal blocks are of dimension
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>M</mi><mi>i</mi></msub><mo>×</mo><msub><mi>N</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(M_i\times N_i)</annotation></semantics></math>.
The first
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(k-1)</annotation></semantics></math>
diagonal blocks of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
have full row rank (and hence
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><msub><mi>M</mi><mi>i</mi></msub><mo>≤</mo><msub><mi>N</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">0\leq M_i \leq N_i</annotation></semantics></math>)
and the first
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(k-1)</annotation></semantics></math>
diagonal block of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
are zero. Therefore
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(z)</annotation></semantics></math>
has full row rank if and only if the last block
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>A</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo>−</mo><msub><mi>B</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(A_{kk} - B_{kk}z)</annotation></semantics></math>
has full row rank. For this last block the following cases may
occur:</p>
<ol style="list-style-type: lower-alpha">
<li>If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>A</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo>−</mo><msub><mi>B</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(A_{kk} - B_{kk})</annotation></semantics></math>
is “tall”
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mi>k</mi></msub><mo>&gt;</mo><msub><mi>N</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">M_k &gt; N_k</annotation></semantics></math>),
then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(z)</annotation></semantics></math>
has a non trivial left kernel for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>∈</mo><mi>ℂ</mi></mrow><annotation encoding="application/x-tex">z \in \mathbb{C}</annotation></semantics></math>.<br>
In this case
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
(and the matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>)
is <em>not</em> left prime.</li>
<li>If the pencil
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>A</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo>−</mo><msub><mi>B</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(A_{kk} - B_{kk})</annotation></semantics></math>
is square
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mi>k</mi></msub><mo>=</mo><msub><mi>N</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">M_k=N_k</annotation></semantics></math>)
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>B</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">B_{kk}</annotation></semantics></math>
is non singular, then the zeroes of the pencil
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(z)</annotation></semantics></math>
(and the zeroes of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c(z)</annotation></semantics></math>)
are the eigenvalues of the matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><msubsup><mi>B</mi><mrow><mi>k</mi><mi>k</mi></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">A_{kk}B_{kk}^{-1}</annotation></semantics></math>.<br>
In this case
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
(and the matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>)
is <em>not</em> left prime.</li>
<li>If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>B</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">B_{kk}</annotation></semantics></math>
is zero and the matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
has full row rank, then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(z)</annotation></semantics></math>
has full row rank for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>∈</mo><mi>ℂ</mi></mrow><annotation encoding="application/x-tex">z\in \mathbb{C}</annotation></semantics></math>.<br>
In this case the pencil
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
(and the matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>)
is left prime.</li>
<li>If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>B</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">B_{kk}</annotation></semantics></math>
is zero and the matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
does not have full row rank, then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(z)</annotation></semantics></math>
has a non trivial left kernel for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>∈</mo><mi>ℂ</mi></mrow><annotation encoding="application/x-tex">z \in \mathbb{C}</annotation></semantics></math>.<br>
In this case
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
(and the matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>)
is <em>not</em> left prime.</li>
</ol>
<p>The function <code><a href="../reference/is.coprime.html">is.coprime()</a></code> uses this approach to test
wether a polynomial is left prime (or a pair of polynomials is left
coprime). In the default case the function just returns a boolean
variable. However, if the optional argument <code>only.answer</code> is
set to <code>FALSE</code>, then a list is returned which contains the
above described staircase form. The list contains the following
slots:</p>
<p><code>answer</code> is <code>TRUE</code>, if the polynomial is prime
(the pair is left coprime).<br><code>A</code>,<code>B</code> hold the two matrices
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
(in staircase form).<br><code>m</code>,<code>n</code> are two integer vectors which contain the
size of the blocks
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>M</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(M_i)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>N</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(N_i)</annotation></semantics></math>
respectively.<br><code>zeroes</code> is a vector which contains the zeroes of the pencil
(the polynomial
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>).
In the (co-)prime case this vector is empty and if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
is rank deficient for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>∈</mo><mi>ℂ</mi></mrow><annotation encoding="application/x-tex">z \in \mathbb{C}</annotation></semantics></math>
then <code>zeroes = NA_real_</code>.</p>
</div>
</div>
<div class="section level3">
<h3 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h3>
<p>We present three examples pertaining to the three different
outcomes:</p>
<ul>
<li>coprime polynomial matrices
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">a(z)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">b(z)</annotation></semantics></math>
</li>
<li>non-coprime polynomial matrices with a finite number of common
zeros</li>
<li>non-coprime polynomial matrices with reduced rank for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>∈</mo><mi>ℂ</mi></mrow><annotation encoding="application/x-tex">z\in\mathbb{C}</annotation></semantics></math>
</li>
</ul>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="coprime-polynomials">Coprime Polynomials<a class="anchor" aria-label="anchor" href="#coprime-polynomials"></a>
</h4>
<p>Two “generic” polynomials are coprime.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate a random (m x m), and a random (m x n) polynomial matrix, with degree p=2</span></span>
<span><span class="va">m</span> <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1803</span><span class="op">)</span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="../reference/test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">m</span>,<span class="va">m</span><span class="op">)</span>, degree <span class="op">=</span> <span class="fl">2</span>, digits <span class="op">=</span> <span class="fl">1</span>, random <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">=</span> <span class="fu"><a href="../reference/test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">m</span>,<span class="va">n</span><span class="op">)</span>, degree <span class="op">=</span> <span class="fl">2</span>, digits <span class="op">=</span> <span class="fl">1</span>, random <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="section level5 unnumbered">
<h5 class="unnumbered" id="hermite-form">Hermite Form<a class="anchor" aria-label="anchor" href="#hermite-form"></a>
</h5>
<p>The Hermite form of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\left( a(z), b(z)\right)</annotation></semantics></math>
is</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HNF</span> <span class="op">=</span> <span class="fu"><a href="../reference/hnf.html">hnf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span><span class="op">)</span>, from_left <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">HNF</span><span class="op">$</span><span class="va">h</span>, digits <span class="op">=</span> <span class="fl">2</span>, format <span class="op">=</span> <span class="st">'character'</span><span class="op">)</span></span>
<span><span class="co">#&gt; ( 2 x 5 ) matrix polynomial with degree &lt;= 0 </span></span>
<span><span class="co">#&gt;       [,1]  [,2]  [,3]  [,4]  [,5]</span></span>
<span><span class="co">#&gt; [1,]     1     0     0     0     0</span></span>
<span><span class="co">#&gt; [2,]     0     1     0     0     0</span></span></code></pre></div>
<p>The square submatrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>h</mi><mn>1</mn></msub><annotation encoding="application/x-tex">h_1</annotation></semantics></math>
of the Hermite form
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>
is equal to the identity matrix, hence
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a,b)</annotation></semantics></math>
are left coprime.</p>
</div>
<div class="section level5 unnumbered">
<h5 class="unnumbered" id="pencil">Pencil<a class="anchor" aria-label="anchor" href="#pencil"></a>
</h5>
<p>The method using the pencil gives the same answer:</p>
<ul>
<li>There are no common zeros.</li>
<li>The polynomial matrices are left coprime.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">=</span> <span class="fu"><a href="../reference/is.coprime.html">is.coprime</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, debug <span class="op">=</span> <span class="cn">FALSE</span>, only.answer <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"The polynomials are left coprime: "</span>, <span class="va">out</span><span class="op">$</span><span class="va">answer</span>,<span class="st">"\n"</span>, </span>
<span>    <span class="st">"The zeros of the pencil are: "</span>, <span class="va">out</span><span class="op">$</span><span class="va">zeroes</span>, sep <span class="op">=</span> <span class="st">''</span><span class="op">)</span></span>
<span><span class="co">#&gt; The polynomials are left coprime: TRUE</span></span>
<span><span class="co">#&gt; The zeros of the pencil are:</span></span></code></pre></div>
</div>
</div>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="not-coprime-finite-number-of-zeros">Not coprime: Finite Number of Zeros<a class="anchor" aria-label="anchor" href="#not-coprime-finite-number-of-zeros"></a>
</h4>
<p>Here we consider an example where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">c(z)= [a(z),b(z)]</annotation></semantics></math>
is rank deficient for some (but not all)
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>∈</mo><mi>ℂ</mi></mrow><annotation encoding="application/x-tex">z\in \mathbb{C}</annotation></semantics></math>.
We generate these polynomials by multiplying them with a common (matrix)
factor. We show that (at least) one singular value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c(z)</annotation></semantics></math>
evaluated at the zeros of the common factor is zero.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a0</span> <span class="op">=</span> <span class="va">a</span></span>
<span><span class="va">b0</span> <span class="op">=</span> <span class="va">b</span></span>
<span></span>
<span><span class="co"># Generate random common factor  with degree 1</span></span>
<span><span class="va">r</span> <span class="op">=</span> <span class="fu"><a href="../reference/test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">m</span>,<span class="va">m</span><span class="op">)</span>, degree <span class="op">=</span> <span class="fl">1</span>, digits <span class="op">=</span> <span class="fl">1</span>, random <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate polynomials with a common factor</span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="va">r</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="va">a0</span></span>
<span><span class="va">b</span> <span class="op">=</span> <span class="va">r</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="va">b0</span></span>
<span><span class="va">c</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span><span class="op">)</span></span>
<span></span>
<span><span class="va">z_r</span> <span class="op">=</span> <span class="fu"><a href="../reference/poles_and_zeroes.html">zeroes</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"The zeros of the common factor r(z) are: \n"</span>, <span class="va">z_r</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; The zeros of the common factor r(z) are: </span></span>
<span><span class="co">#&gt;  -0.2051932 5.377607</span></span>
<span></span>
<span><span class="va">d</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span><span class="fu"><a href="../reference/zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">c</span>, z <span class="op">=</span> <span class="va">z_r</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">d</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"minimal singular value of c(z_0): "</span>, <span class="va">d</span><span class="op">[</span><span class="va">m</span><span class="op">]</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="co">#&gt; minimal singular value of c(z_0): 1.007532e-16</span></span></code></pre></div>
<div class="section level5 unnumbered">
<h5 class="unnumbered" id="hermite-form-1">Hermite Form<a class="anchor" aria-label="anchor" href="#hermite-form-1"></a>
</h5>
<p>The Hermite Form of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c(z) = (a(z), b(z))</annotation></semantics></math>
is</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HNF</span> <span class="op">=</span> <span class="fu"><a href="../reference/hnf.html">hnf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span><span class="op">)</span>, from_left <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">HNF</span><span class="op">$</span><span class="va">h</span>, digits <span class="op">=</span> <span class="fl">2</span>, format <span class="op">=</span> <span class="st">'character'</span><span class="op">)</span></span>
<span><span class="co">#&gt; ( 2 x 5 ) matrix polynomial with degree &lt;= 2 </span></span>
<span><span class="co">#&gt;               [,1]                [,2]  [,3]  [,4]  [,5]</span></span>
<span><span class="co">#&gt; [1,]             1                   0     0     0     0</span></span>
<span><span class="co">#&gt; [2,]  2.49 - 0.39z  -1.1 - 5.17z + z^2     0     0     0</span></span></code></pre></div>
<p>We calculate the zeros of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">c(z)= [a(z),b(z)]</annotation></semantics></math>
by calculating the zeros of the diagonal elements of the square
submatrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">h_1(z)</annotation></semantics></math>.
Note that for this example the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(1,1)</annotation></semantics></math>
element is equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>.</p>
<p>The (common) zeros are therefore</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/poles_and_zeroes.html">zeroes</a></span><span class="op">(</span><span class="va">HNF</span><span class="op">$</span><span class="va">h</span><span class="op">[</span><span class="va">m</span>,<span class="va">m</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.2051932  5.3776070</span></span></code></pre></div>
<p>Note that these zeroes are identical to the zeroes of the common
factor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">r(z)</annotation></semantics></math>.</p>
</div>
<div class="section level5 unnumbered">
<h5 class="unnumbered" id="pencil-1">Pencil<a class="anchor" aria-label="anchor" href="#pencil-1"></a>
</h5>
<p>The outcome for the pencil is the same as above.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">=</span> <span class="fu"><a href="../reference/is.coprime.html">is.coprime</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, debug <span class="op">=</span> <span class="cn">FALSE</span>, only.answer <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"The polynomials are left coprime: "</span>, <span class="va">out</span><span class="op">$</span><span class="va">answer</span>,<span class="st">"\n"</span>, </span>
<span>    <span class="st">"The zeros of the pencil are: "</span>, <span class="va">out</span><span class="op">$</span><span class="va">zeroes</span>, sep <span class="op">=</span> <span class="st">''</span><span class="op">)</span></span>
<span><span class="co">#&gt; The polynomials are left coprime: FALSE</span></span>
<span><span class="co">#&gt; The zeros of the pencil are: 5.377607-0.2051932</span></span></code></pre></div>
</div>
</div>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="not-coprime-everywhere-rank-deficient">Not coprime: Everywhere Rank Deficient<a class="anchor" aria-label="anchor" href="#not-coprime-everywhere-rank-deficient"></a>
</h4>
<p>Finally let us consider the case, where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c(z) = (a(z),b(z))</annotation></semantics></math>
is rank deficient for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>.
We generate a pair of polynomial matrices of this kind by multiplying
the two polynomials
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">a(z), b(z)</annotation></semantics></math>
(from left) with a singular common factor.</p>
<p>To verify that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c(z)</annotation></semantics></math>
is of reduced row rank for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>∈</mo><mi>ℂ</mi></mrow><annotation encoding="application/x-tex">z\in\mathbb{C}</annotation></semantics></math>,
we print the singular values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c(z)</annotation></semantics></math>
at a randomly selected point.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate a square polynomial matrix with rank one!</span></span>
<span><span class="va">r</span> <span class="op">=</span> <span class="fu"><a href="../reference/test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">m</span>,<span class="fl">1</span><span class="op">)</span>, degree <span class="op">=</span> <span class="fl">1</span>, digits <span class="op">=</span> <span class="fl">1</span>, random <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> </span>
<span>    <span class="fu"><a href="../reference/test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">m</span><span class="op">)</span>, degree <span class="op">=</span> <span class="fl">1</span>, digits <span class="op">=</span> <span class="fl">1</span>, random <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">r</span>, format <span class="op">=</span> <span class="st">'c'</span><span class="op">)</span></span>
<span><span class="co">#&gt; ( 2 x 2 ) matrix polynomial with degree &lt;= 2 </span></span>
<span><span class="co">#&gt;                         [,1]                     [,2]</span></span>
<span><span class="co">#&gt; [1,]   1.36 - 1.43z - 2.1z^2  -0.72 + 2.07z - 1.35z^2</span></span>
<span><span class="co">#&gt; [2,]  1.53 + 3.47z + 1.82z^2  -0.81 - 0.36z + 1.17z^2</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="va">r</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="va">a0</span></span>
<span><span class="va">b</span> <span class="op">=</span> <span class="va">r</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="va">b0</span></span>
<span></span>
<span><span class="co"># Evaluate c(z) = (a(z),b(z)) at a random point z0 and print the corresponding singular values</span></span>
<span><span class="va">z0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">complex</a></span><span class="op">(</span>real <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, imaginary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span><span class="fu"><a href="../reference/zvalues.html">zvalues</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span><span class="op">)</span>, z <span class="op">=</span> <span class="va">z0</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span>, nu <span class="op">=</span> <span class="fl">0</span>, nv <span class="op">=</span> <span class="fl">0</span> <span class="op">)</span><span class="op">$</span><span class="va">d</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"The singular values of c(z) \n evaluated at z0 = "</span>, <span class="va">z0</span>, <span class="st">"\n are: "</span>, <span class="va">d</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; The singular values of c(z) </span></span>
<span><span class="co">#&gt;  evaluated at z0 =  0.3368112-0.2077692i </span></span>
<span><span class="co">#&gt;  are:  8.087889 6.256749e-16</span></span></code></pre></div>
<div class="section level5 unnumbered">
<h5 class="unnumbered" id="hermite-form-2">Hermite Form<a class="anchor" aria-label="anchor" href="#hermite-form-2"></a>
</h5>
<p>The Hermite Form of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c(z) = (a(z), b(z))</annotation></semantics></math>
is</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HNF</span> <span class="op">=</span> <span class="fu"><a href="../reference/hnf.html">hnf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span><span class="op">)</span>, from_left <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">HNF</span><span class="op">$</span><span class="va">h</span>, digits <span class="op">=</span> <span class="fl">1</span>, format <span class="op">=</span> <span class="st">'char'</span><span class="op">)</span></span>
<span><span class="co">#&gt; ( 2 x 5 ) matrix polynomial with degree &lt;= 1 </span></span>
<span><span class="co">#&gt;              [,1]  [,2]  [,3]  [,4]  [,5]</span></span>
<span><span class="co">#&gt; [1,]     -0.5 + z     0     0     0     0</span></span>
<span><span class="co">#&gt; [2,]  -0.6 - 0.9z     0     0     0     0</span></span></code></pre></div>
<p>The matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c(z)</annotation></semantics></math>
is rank deficient (for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>)
since
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mrow><mo stretchy="true" form="prefix">[</mo><mn>2</mn><mo>,</mo><mn>2</mn><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">h[2,2] = 0</annotation></semantics></math>!
The procedure <code>hnf</code> returns also an estimate of the rank of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c(z)</annotation></semantics></math>
(when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c(z)</annotation></semantics></math>
is considered as rational matrix). Here we get</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">HNF</span><span class="op">$</span><span class="va">rank</span>,<span class="st">'\n'</span><span class="op">)</span></span>
<span><span class="co">#&gt; 1</span></span></code></pre></div>
<p>which again means that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c(z)</annotation></semantics></math>
is rank deficient for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>∈</mo><mi>ℂ</mi></mrow><annotation encoding="application/x-tex">z \in \mathbb{C}</annotation></semantics></math>.</p>
</div>
<div class="section level5 unnumbered">
<h5 class="unnumbered" id="pencil-2">Pencil<a class="anchor" aria-label="anchor" href="#pencil-2"></a>
</h5>
<p>The result for pencils is the same.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">=</span> <span class="fu"><a href="../reference/is.coprime.html">is.coprime</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, debug <span class="op">=</span> <span class="cn">FALSE</span>, only.answer <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"The polynomials are left coprime: "</span>, <span class="va">out</span><span class="op">$</span><span class="va">answer</span>,<span class="st">"\n"</span>, </span>
<span>    <span class="st">"The zeros of the pencil are: "</span>, <span class="va">out</span><span class="op">$</span><span class="va">zeroes</span>, sep <span class="op">=</span> <span class="st">''</span><span class="op">)</span></span>
<span><span class="co">#&gt; The polynomials are left coprime: FALSE</span></span>
<span><span class="co">#&gt; The zeros of the pencil are: NA</span></span></code></pre></div>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="colreduced-section">Column Reduced Matrix<a class="anchor" aria-label="anchor" href="#colreduced-section"></a>
</h2>
<div class="section level3">
<h3 id="functional-area-polynomial-manipulation-4">Functional Area: Polynomial Manipulation (#4)<a class="anchor" aria-label="anchor" href="#functional-area-polynomial-manipulation-4"></a>
</h3>
<p>See <code>R/polm_methods.R</code> for implementation.</p>
<p><strong>Note:</strong> The functions <code>degree</code>
(<code>col_end_matrix</code>) and <code>col_reduce</code> use different
strategies to compute the column degrees (column end matrix).</p>
<ul>
<li>The first two consider the elements, whereas</li>
<li>
<code>col_reduce</code> considers the euclidean norm of the
respective columns.</li>
</ul>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>a</mi><mn>0</mn></msup><mo>+</mo><msup><mi>a</mi><mn>1</mn></msup><mi>z</mi><mo>+</mo><mi>⋯</mi><mo>+</mo><msup><mi>a</mi><mi>p</mi></msup><msup><mi>z</mi><mi>p</mi></msup></mrow><annotation encoding="application/x-tex">a(z) = a^0 + a^1 z + \cdots + a^p z^p</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mi>k</mi></msup><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow><mi>k</mi></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">a^k = (a^k_{ij})</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>a</mi><mi>j</mi><mi>k</mi></msubsup><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>a</mi><mrow><mn>1</mn><mi>j</mi></mrow><mi>k</mi></msubsup><mo>,</mo><mi>…</mi><mo>,</mo><msubsup><mi>a</mi><mrow><mi>m</mi><mi>j</mi></mrow><mi>k</mi></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mi>′</mi></mrow><annotation encoding="application/x-tex">a^k_j=(a^k_{1j}, \ldots, a^k_{mj})'</annotation></semantics></math>.
The function <code>degree</code> sets the degree of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>-th
column to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>j</mi></msub><annotation encoding="application/x-tex">p_j</annotation></semantics></math>
iff
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow><msub><mi>p</mi><mi>j</mi></msub></msubsup><mo>&gt;</mo><mi>τ</mi></mrow><annotation encoding="application/x-tex">a^{p_j}_{ij} &gt; \tau</annotation></semantics></math>
for at least one
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow><mi>k</mi></msubsup><mo>≤</mo><mi>τ</mi></mrow><annotation encoding="application/x-tex">a^{k}_{ij} \leq \tau</annotation></semantics></math>
for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>&gt;</mo><msub><mi>p</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">k&gt;p_j</annotation></semantics></math>.
The column end matrix is constructed correspondingly. The function
<code>col_reduce</code> sets the degree of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>-th
column to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>j</mi></msub><annotation encoding="application/x-tex">p_j</annotation></semantics></math>
iff
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="postfix">∥</mo><msubsup><mi>a</mi><mi>j</mi><msub><mi>p</mi><mi>j</mi></msub></msubsup><mo stretchy="false" form="postfix">∥</mo><mo>&gt;</mo><mi>τ</mi></mrow><annotation encoding="application/x-tex">\|a^{p_j}_{j}\| &gt; \tau</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="postfix">∥</mo><msubsup><mi>a</mi><mi>j</mi><mi>k</mi></msubsup><mo stretchy="false" form="postfix">∥</mo><mo>≤</mo><mi>τ</mi></mrow><annotation encoding="application/x-tex">\|a^{k}_{j}\| \leq \tau</annotation></semantics></math>
for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>&gt;</mo><msub><mi>p</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">k&gt;p_j</annotation></semantics></math>.</p>
<p>Therefore one may get different results!</p>
<p>The basic strategy to construct a column reduced matrix (for the case
that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">a(z)</annotation></semantics></math>
is square and non singular) is as follows. First permute the columns of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">a(z)</annotation></semantics></math>
such that the column degrees
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>≤</mo><msub><mi>p</mi><mn>2</mn></msub><mo>≤</mo><mi>⋯</mi><mo>≤</mo><msub><mi>p</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">p_1 \leq p_2 \leq \cdots \leq p_m</annotation></semantics></math>
are ordered. Now suppose that the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>-th
column,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>k</mi></msub><annotation encoding="application/x-tex">c_k</annotation></semantics></math>
say, of the column end matrix is linearly dependent from the previous
columns
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>j</mi></msub><annotation encoding="application/x-tex">c_j</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>j</mi><mo>&lt;</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">1\leq j &lt; k</annotation></semantics></math>),
i.e. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>k</mi></msub><mo>=</mo><msub><mi>α</mi><mn>1</mn></msub><msub><mi>c</mi><mn>1</mn></msub><mo>+</mo><mi>⋯</mi><msub><mi>α</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><msub><mi>c</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">c_k = \alpha_1 c_1 + \cdots \alpha_{k-1} c_{k-1}</annotation></semantics></math>.
Then we substract from the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>-th
column of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">a(z)</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>z</mi><mrow><msub><mi>p</mi><mi>k</mi></msub><mo>−</mo><msub><mi>p</mi><mi>j</mi></msub></mrow></msup><msub><mi>α</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">z^{p_k-p_j}\alpha_j</annotation></semantics></math>
times the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>-th
column. This operation reduces the degree of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>-th
column by one.</p>
<p>This procedure is repeated until the column end matrix is
regular.</p>
<p>See also <span class="citation">@Wolovich1974</span>.</p>
<p>The coefficients
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\alpha_j</annotation></semantics></math>
are determined from an SVD of the column end matrix.</p>
</div>
</div>
<div class="section level2">
<h2 id="realization-section">Realization Algorithms<a class="anchor" aria-label="anchor" href="#realization-section"></a>
</h2>
<div class="section level3">
<h3 id="functional-area-realization-algorithms-2">Functional Area: Realization Algorithms (#2)<a class="anchor" aria-label="anchor" href="#functional-area-realization-algorithms-2"></a>
</h3>
<p>See <code>R/as_methods.R</code> and related functions like
<code><a href="../reference/pseries2stsp.html">pseries2stsp()</a></code>, <code><a href="../reference/pseries2lmfd.html">pseries2lmfd()</a></code> for
implementation.</p>
</div>
<div class="section level3">
<h3 id="impulse-response">Impulse Response<a class="anchor" aria-label="anchor" href="#impulse-response"></a>
</h3>
<p>One of the main features of the rational functions is that the Hankel
matrix of the impulse response coefficients has finite rank:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>k</mi><mn>1</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>k</mi><mn>2</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>k</mi><mn>2</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>k</mi><mn>3</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
H = \begin{pmatrix}
k_1 &amp; k_2 &amp; \cdots \\
k_2 &amp; k_3 &amp; \cdots \\
\vdots &amp; \vdots &amp; 
\end{pmatrix}
</annotation></semantics></math> Note that the impulse response function
is only well defined if the rational matrix has no pole at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">z=0</annotation></semantics></math>.</p>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="lmfd">LMFD<a class="anchor" aria-label="anchor" href="#lmfd"></a>
</h4>
<p>We consider a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo>,</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(m,n)</annotation></semantics></math>-dimensional
rational matrix in LMFD form
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>a</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>k</mi><mn>0</mn></msub><mo>+</mo><msub><mi>k</mi><mn>1</mn></msub><mi>z</mi><mo>+</mo><msub><mi>k</mi><mn>2</mn></msub><msup><mi>z</mi><mn>2</mn></msup><mo>+</mo><mi>⋯</mi></mrow><annotation encoding="application/x-tex">
k(z) = a^{-1}(z) b(z) = k_0 + k_1 z + k_2 z^2 + \cdots
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>a</mi><mn>0</mn></msub><mo>+</mo><msub><mi>a</mi><mn>1</mn></msub><mi>z</mi><mo>+</mo><mi>⋯</mi><mo>+</mo><msub><mi>a</mi><mi>p</mi></msub><msup><mi>z</mi><mi>p</mi></msup></mrow><annotation encoding="application/x-tex">a(z)=a_0 + a_1 z + \cdots + a_p z^p</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>b</mi><mn>0</mn></msub><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub><mi>z</mi><mo>+</mo><mi>⋯</mi><mo>+</mo><msub><mi>b</mi><mi>p</mi></msub><msup><mi>z</mi><mi>p</mi></msup></mrow><annotation encoding="application/x-tex">b(z)=b_0 + b_1 z +\cdots + b_p z^p</annotation></semantics></math>.
W.l.o.g we set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">p=q</annotation></semantics></math>.
This implies
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>k</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>k</mi><mn>0</mn></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>a</mi><mn>0</mn></msub><mo>+</mo><msub><mi>a</mi><mn>1</mn></msub><mi>z</mi><mo>+</mo><mi>⋯</mi><mo>+</mo><msub><mi>a</mi><mi>p</mi></msub><msup><mi>z</mi><mi>p</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>k</mi><mn>1</mn></msub><mi>z</mi><mo>+</mo><msub><mi>k</mi><mn>2</mn></msub><mi>z</mi><mo>+</mo><mi>⋯</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>b</mi><mn>0</mn></msub><mo>−</mo><msub><mi>a</mi><mn>0</mn></msub><msub><mi>k</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>b</mi><mn>1</mn></msub><mo>−</mo><msub><mi>a</mi><mn>1</mn></msub><msub><mi>k</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>z</mi><mo>+</mo><mi>⋯</mi><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>b</mi><mi>p</mi></msub><mo>−</mo><msub><mi>a</mi><mi>p</mi></msub><msub><mi>k</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>z</mi><mi>p</mi></msup></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{array}{rcl}
a(z)(k(z) - k_0) &amp;=&amp; b(z) - a(z)k_0 \\
(a_0 + a_1 z + \cdots + a_p z^p)(k_1 z + k_2 z + \cdots ) &amp;=&amp; (b_0-a_0k_0) + (b_1-a_1 k_0) z + \cdots + (b_p-a_p k_0) z^p
\end{array}
</annotation></semantics></math> and thus
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>p</mi></munderover><msub><mi>a</mi><mrow><mi>p</mi><mo>−</mo><mi>i</mi></mrow></msub><msub><mi>k</mi><mrow><mi>j</mi><mo>+</mo><mi>i</mi></mrow></msub><mo>=</mo><mn>0</mn><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> for </mtext><mspace width="0.333em"></mspace></mrow><mi>j</mi><mo>≥</mo><mn>1</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">
\sum_{i=0}^p a_{p-i} k_{j+i} = 0 \mbox{ for } j\geq 1. 
</annotation></semantics></math> By the above identity it follows that
the Hankel matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>
has finite rank and that the coefficients of the polynomial
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">a(z)</annotation></semantics></math>
are closely related to the left kernel of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>.
In the following we discuss, how to construct a unique LMFD of the
rational matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">k()</annotation></semantics></math>
via the above identity.</p>
<p>In order to describe the linear dependence structure of the rows of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>
it is convenient to use a “double” index for the rows: Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∈</mo><msup><mi>ℝ</mi><mrow><mn>1</mn><mo>×</mo><mi>∞</mi></mrow></msup></mrow><annotation encoding="application/x-tex">h(i,j)\in \mathbb{R}^{1\times \infty}</annotation></semantics></math>
denote the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>-th
row in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>-th
block row of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>,
i.e. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">h(i,j)</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>m</mi><mo>+</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">((i-1)m+j)</annotation></semantics></math>-th
row of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>.</p>
<p>A selection
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝒮</mi><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>i</mi><mi>k</mi></msub><mo>,</mo><msub><mi>j</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>s</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\mathcal{S}=\{(i_k,j_k) \,|\, k=1,\ldots ,s\}</annotation></semantics></math>
of rows of the Hankel matrix is called a <em>nice</em> selection, if
there are no “holes” in the sense that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∈</mo><mi>𝒮</mi></mrow><annotation encoding="application/x-tex">(i,j)\in \mathcal{S}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i&gt;1</annotation></semantics></math>
implies that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∈</mo><mi>𝒮</mi></mrow><annotation encoding="application/x-tex">(i-1,j)\in \mathcal{S}</annotation></semantics></math>.
Nice selections may be described by a multi-index
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ν</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ν</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>ν</mi><mi>m</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\nu = (\nu_1, \ldots ,\nu_m)</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ν</mi><mi>j</mi></msub><mo>=</mo><mo>max</mo><mo stretchy="false" form="prefix">{</mo><mi>i</mi><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∈</mo><mi>𝒮</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\nu_j=\max \{i\,|\,(i,j)\in \mathcal{S}\}</annotation></semantics></math>.</p>
<p>Suppose that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>
has rank
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>.
In general there are many different selections of rows of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>
which form a basis for the row space of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>.
In the following we choose the <em>first</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>
rows of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>
which form a basis of the row space and denote the corresponding
selection with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝒮</mi><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>i</mi><mi>k</mi></msub><mo>,</mo><msub><mi>j</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>s</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\mathcal{S}=\{(i_k,j_k) \,|\, k=1,\ldots ,s\}</annotation></semantics></math>.
Due to the Hankel structure of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>
this is a nice selection in the above sense. The corresponding
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ν</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\nu_j</annotation></semantics></math>’s
are called <em>Kronecker indices</em> of the Hankel matrix (respectively
of the rational matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>⋅</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">k(\cdot)</annotation></semantics></math>).
Note that the sum of the Kronecker indices is equal to the rank of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><msub><mi>ν</mi><mi>j</mi></msub><mo>=</mo><mi>s</mi></mrow><annotation encoding="application/x-tex">\sum_{j=1}^m \nu _j = s</annotation></semantics></math>.</p>
<p>The row
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ν</mi><mi>j</mi></msub><mo>+</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">h(\nu_j+1,j)</annotation></semantics></math>
is linearly dependent on the previous (basis) rows and therefore
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ν</mi><mi>j</mi></msub><mo>+</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><munder><mo>∑</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ν</mi><mi>j</mi></msub><mo>+</mo><mn>1</mn><mo>−</mo><mi>i</mi><mo>,</mo><mi>l</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∈</mo><mi>𝒮</mi></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ν</mi><mi>j</mi></msub><mo>+</mo><mn>1</mn><mo>−</mo><mi>i</mi><mo>,</mo><mi>l</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ν</mi><mi>j</mi></msub><mo>+</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mtd></mtr></mtable></munder><msub><mi>a</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mi>l</mi></mrow></msub><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ν</mi><mi>j</mi></msub><mo>+</mo><mn>1</mn><mo>−</mo><mi>i</mi><mo>,</mo><mi>l</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">
h(\nu_j+1,j) + \sum_{\substack{(\nu_j+1-i,l) \in \mathcal{S} \\ (\nu_j+1-i,l) &lt; (\nu_j+1,j)}} a_{i,jl} h(\nu_j+1-i,l) = 0
</annotation></semantics></math> holds for suitably chosen coefficients
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mi>l</mi></mrow></msub><annotation encoding="application/x-tex">a_{i,jl}</annotation></semantics></math>.
The sum runs over all basis rows previous to the row
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ν</mi><mi>j</mi></msub><mo>+</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">h(\nu_j+1,j)</annotation></semantics></math>,
i.e. the notation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo>,</mo><mi>l</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">(k,l) &lt; (i,j)</annotation></semantics></math>
means
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>&lt;</mo><mi>i</mi></mrow><annotation encoding="application/x-tex">k &lt; i</annotation></semantics></math>)
or
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mi>i</mi></mrow><annotation encoding="application/x-tex">k=i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>&lt;</mo><mi>j</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">l&lt;j)</annotation></semantics></math>).
This equation now (uniquely) defines a polynomial matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>a</mi><mn>0</mn></msub><mo>+</mo><msub><mi>a</mi><mn>1</mn></msub><mi>z</mi><mo>+</mo><mi>⋯</mi><mo>+</mo><msub><mi>a</mi><mi>p</mi></msub><msup><mi>z</mi><mi>p</mi></msup></mrow><annotation encoding="application/x-tex">a(z) = a_0 + a_1 z + \cdots + a_p z^p</annotation></semantics></math>,
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><msub><mo>max</mo><mi>j</mi></msub><msub><mi>ν</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">p=\max_j{\nu_j}</annotation></semantics></math>.<br>
Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mi>l</mi></mrow></msub><annotation encoding="application/x-tex">a_{i,jl}</annotation></semantics></math>
denote the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mi>l</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(jl)</annotation></semantics></math>-th
entry of the matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mi>i</mi></msub><annotation encoding="application/x-tex">a_i</annotation></semantics></math>.
The entries
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mi>l</mi></mrow></msub><annotation encoding="application/x-tex">a_{i,jl}</annotation></semantics></math>,
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ν</mi><mi>j</mi></msub><mo>+</mo><mn>1</mn><mo>−</mo><mi>i</mi><mo>,</mo><mi>l</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∈</mo><mi>𝒮</mi></mrow><annotation encoding="application/x-tex">(\nu_j+1-i,l) \in \mathcal{S}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ν</mi><mi>j</mi></msub><mo>+</mo><mn>1</mn><mo>−</mo><mi>i</mi><mo>,</mo><mi>l</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ν</mi><mi>j</mi></msub><mo>+</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">(\nu_j+1-i,l) &lt; (\nu_j+1,j)</annotation></semantics></math>
are read off from the above equation,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mrow><mn>0</mn><mo>,</mo><mi>j</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">a_{0,jj}</annotation></semantics></math>
is set to one
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mn>0</mn><mo>,</mo><mi>j</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">a_{0,jj}=1</annotation></semantics></math>)
and all other entries are set to zero.</p>
<p>By construction
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>k</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">a(z)(k(z)-k_0)</annotation></semantics></math>
is a polynomial (with degree less than or equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><msub><mo>max</mo><mi>j</mi></msub><msub><mi>ν</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">p=\max_j\nu_j</annotation></semantics></math>).
In the last step we set
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>k</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>k</mi><mn>0</mn></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">
b(z) = a(z)(k(z)-k_0) + a(z)k_0.
</annotation></semantics></math></p>
<p>By the above construction one gets a unique LMFD representation of
the rational matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">k(z)</annotation></semantics></math>
with the following properties:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mn>0</mn></msub><annotation encoding="application/x-tex">a_0</annotation></semantics></math>
is a lower triangular matrix with ones on the diagonal.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mn>0</mn></msub><mo>=</mo><msub><mi>a</mi><mn>0</mn></msub><msub><mi>k</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">b_0 = a_0 k_0</annotation></semantics></math>.
In particular for a square rational matrix with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mn>0</mn></msub><mo>=</mo><msub><mi>I</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">k_0=I_m</annotation></semantics></math>
we have
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mn>0</mn></msub><mo>=</mo><msub><mi>a</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">b_0=a_0</annotation></semantics></math>.</li>
<li>the row degrees of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a(z),b(z))</annotation></semantics></math>
are equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ν</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>ν</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">\nu_1,\ldots,\nu_m</annotation></semantics></math>,<br>
</li>
<li>the elements
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">a_{ij}(z)</annotation></semantics></math>
are divisible by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>z</mi><msub><mi>ν</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></msup><annotation encoding="application/x-tex">z^{\nu_{ij}}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ν</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mo>max</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ν</mi><mi>i</mi></msub><mo>+</mo><mn>1</mn><mo>−</mo><msub><mi>ν</mi><mi>j</mi></msub><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\nu_{ij} = \max(\nu_i+1-\nu_j,1)</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>&gt;</mo><mi>i</mi></mrow><annotation encoding="application/x-tex">j&gt;i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ν</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mo>max</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ν</mi><mi>i</mi></msub><mo>+</mo><mn>1</mn><mo>−</mo><msub><mi>ν</mi><mi>j</mi></msub><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\nu_{ij} = \max(\nu_i+1-\nu_j,0)</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>&lt;</mo><mi>i</mi></mrow><annotation encoding="application/x-tex">j&lt;i</annotation></semantics></math>.</li>
<li>the pair
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a(z), b(z))</annotation></semantics></math>
is left coprime and row reduced.</li>
</ul>
<p>A pair
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a(z),b(z))</annotation></semantics></math>
which satisfied the above conditions is said to be in <em>echelon
canonical form</em>.</p>
</div>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="ho-kalman">Ho-Kalman<a class="anchor" aria-label="anchor" href="#ho-kalman"></a>
</h4>
<p>A quite analogous strategy may be used to construct a (unique) state
space realization of a rational matrix. Suppose that the Hankel matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>
has rank
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>
and that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>∈</mo><msup><mi>ℝ</mi><mrow><mi>s</mi><mo>×</mo><mi>∞</mi></mrow></msup></mrow><annotation encoding="application/x-tex">S\in \mathbb{R}^{s\times \infty}</annotation></semantics></math>
is such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>H</mi></mrow><annotation encoding="application/x-tex">SH</annotation></semantics></math>
is a basis for the row space of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>.
Then a state space representation of the rational matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>⋅</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">k(\cdot)</annotation></semantics></math>
is obtained by a solving the following equations
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>S</mi><msub><mi>H</mi><mrow><mo>−</mo><mn>1</mn><mo>,</mo><mi>.</mi></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mi>A</mi><mi>S</mi><mi>H</mi></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>H</mi><mrow><mn>1</mn><mo>,</mo><mi>.</mi></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mi>C</mi><mi>S</mi><mi>H</mi></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>S</mi><msub><mi>H</mi><mrow><mi>.</mi><mo>,</mo><mn>1</mn></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mi>B</mi></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>k</mi><mn>0</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mi>D</mi><mo>,</mo></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{array}{rcl}
SH_{-1,.} &amp;=&amp; A SH \\
H_{1,.} &amp;=&amp; C SH \\
SH_{.,1} &amp;=&amp; B \\
k_0 &amp;=&amp; D,
\end{array}
</annotation></semantics></math> where
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mrow><mo>−</mo><mn>1</mn><mo>,</mo><mi>.</mi></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>k</mi><mn>2</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>k</mi><mn>3</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>k</mi><mn>3</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>k</mi><mn>4</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mspace width="1.0em"></mspace><msub><mi>H</mi><mrow><mn>1</mn><mo>,</mo><mi>.</mi></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>k</mi><mn>1</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>k</mi><mn>2</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> and </mtext><mspace width="0.333em"></mspace></mrow><msub><mi>H</mi><mrow><mo>,</mo><mn>1</mn></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>k</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>k</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
H_{-1,.} = \begin{pmatrix}
k_2 &amp; k_3 &amp; \cdots \\
k_3 &amp; k_4 &amp; \cdots \\
\vdots &amp; \vdots &amp; 
\end{pmatrix}
\, \quad
H_{1,.} = \begin{pmatrix}
k_1 &amp; k_2 &amp; \cdots
\end{pmatrix}
\, \mbox{ and }
H_{,1} = \begin{pmatrix}
k_1 \\ 
k_2 \\
\vdots
\end{pmatrix}
</annotation></semantics></math></p>
<p>The obtained result clearly depends on the matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>,
i.e. on the choice of the basis of the row space of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>.</p>
<p>Two choices are implemented:</p>
<ul>
<li>echelon form: here
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>
is the selection matrix which selects the first
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>
linearly independent rows of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>.
The statespace realization obtained then is in <em>echelon canonical
form</em>.</li>
<li>balanced form: here
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>
is obtained via an SVD decomposition of a finite dimensional sub matrix
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>.
For more details, see …</li>
</ul>
</div>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="notes">Notes:<a class="anchor" aria-label="anchor" href="#notes"></a>
</h4>
<p>The above constructions for a LMFD or statespace representations also
work for a finite dimensional sub matrix
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mrow><mi>f</mi><mi>p</mi></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>k</mi><mn>1</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>k</mi><mn>2</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>k</mi><mi>p</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>k</mi><mn>2</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>k</mi><mn>3</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>k</mi><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>k</mi><mi>f</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>k</mi><mrow><mi>f</mi><mo>+</mo><mn>1</mn></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>k</mi><mrow><mi>f</mi><mo>+</mo><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
H_{fp} = 
\begin{pmatrix}
k_1 &amp; k_2 &amp; \cdots &amp; k_p \\
k_2 &amp; k_3 &amp; \cdots &amp; k_{p+1}\\
\vdots &amp; \vdots &amp;  &amp; \vdots \\
k_f &amp; k_{f+1} &amp; \cdots &amp; k_{f+p-1}
\end{pmatrix}
</annotation></semantics></math> provided that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>f</mi><mo>,</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(f,p)</annotation></semantics></math>
is “large enough”.</p>
<p>For a more detailed discussion on Kronecker indices and echelon
canonical forms, see <span class="citation">@Hannan.Deistler12</span>.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="stsp-ops-section">Operations with State-Space Realizations<a class="anchor" aria-label="anchor" href="#stsp-ops-section"></a>
</h2>
<div class="section level3">
<h3 id="functional-area-state-space-tools-6">Functional Area: State-Space Tools (#6)<a class="anchor" aria-label="anchor" href="#functional-area-state-space-tools-6"></a>
</h3>
<p>See <code>R/arithmetic_methods.R</code> and
<code>R/stsp_methods.R</code> for implementation.</p>
</div>
<div class="section level3">
<h3 id="addition">Addition<a class="anchor" aria-label="anchor" href="#addition"></a>
</h3>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>C</mi><mn>1</mn></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>z</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><msub><mi>A</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>B</mi><mn>1</mn></msub><mo>+</mo><msub><mi>D</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>C</mi><mn>2</mn></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>z</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><msub><mi>A</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>B</mi><mn>2</mn></msub><mo>+</mo><msub><mi>D</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
(C_1 (z^{-1} - A_1)^{-1} B_1 + D_1) + 
(C_2 (z^{-1} - A_2)^{-1} B_2 + D_2)
</annotation></semantics></math></p>
<p><span class="math display">$$
\left[\begin{array}{@{}cc|c@{}}
A_1      &amp; 0   &amp; B_1   \\
0        &amp; A_2 &amp; B_2 \\  \hline
C_1      &amp; C_2 &amp; D_1 + D_2
\end{array}\right]
$$</span></p>
<p>See <code><a href="../reference/Ops.ratm.html">Ops.ratm()</a></code> in particular <code>a + b</code>.</p>
</div>
<div class="section level3">
<h3 id="multiplication">Multiplication<a class="anchor" aria-label="anchor" href="#multiplication"></a>
</h3>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>C</mi><mn>1</mn></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>z</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><msub><mi>A</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>B</mi><mn>1</mn></msub><mo>+</mo><msub><mi>D</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>C</mi><mn>2</mn></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>z</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><msub><mi>A</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>B</mi><mn>2</mn></msub><mo>+</mo><msub><mi>D</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
(C_1 (z^{-1} - A_1)^{-1} B_1 + D_1) \cdot
(C_2 (z^{-1} - A_2)^{-1} B_2 + D_2)
</annotation></semantics></math></p>
<p><span class="math display">$$
\left[\begin{array}{@{}cc|c@{}}
A_1      &amp; B_1 C_2 &amp; B_1 D_2   \\
0        &amp; A_2     &amp; B_2 \\  \hline
C_1      &amp; D_1 C_2 &amp; D_1 D_2
\end{array}\right]
$$</span></p>
<p>See <code>a %r% b</code>.</p>
</div>
<div class="section level3">
<h3 id="inverse">Inverse<a class="anchor" aria-label="anchor" href="#inverse"></a>
</h3>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>C</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>z</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mi>A</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>B</mi><mo>+</mo><mi>D</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><annotation encoding="application/x-tex">
(C (z^{-1} - A)^{-1} B + D)^{-1}
</annotation></semantics></math></p>
<p><span class="math display">$$
\left[\begin{array}{@{}c|c@{}}
A - B D^{-1} C &amp; BD^{-1}   \\ \hline
-D^{-1}C       &amp; D^{-1}
\end{array}\right]
$$</span></p>
<p>See <code><a href="../reference/Ops.ratm.html">Ops.ratm()</a></code> in particular <code>x^{-1}</code>.</p>
</div>
<div class="section level3">
<h3 id="bind-by-columns-or-rows">Bind by columns or rows<a class="anchor" aria-label="anchor" href="#bind-by-columns-or-rows"></a>
</h3>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>C</mi><mn>1</mn></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>z</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><msub><mi>A</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>B</mi><mn>1</mn></msub><mo>+</mo><msub><mi>D</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">)</mo></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>C</mi><mn>2</mn></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>z</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><msub><mi>A</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>B</mi><mn>2</mn></msub><mo>+</mo><msub><mi>D</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">
\begin{pmatrix} 
C_1 (z^{-1} - A_1)^{-1} B_1 + D_1) &amp; 
C_2 (z^{-1} - A_2)^{-1} B_2 + D_2) 
\end{pmatrix}
</annotation></semantics></math></p>
<p><span class="math display">$$
\left[\begin{array}{@{}cc|cc@{}}
A_1      &amp; 0       &amp; B_1 &amp; 0   \\
0        &amp; A_2     &amp; 0   &amp; B_2 \\  \hline
C_1      &amp; C_2     &amp; D_1 &amp; D_2
\end{array}\right]
$$</span> See <code><a href="../reference/bind.html">cbind.ratm()</a></code>.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>C</mi><mn>1</mn></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>z</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><msub><mi>A</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>B</mi><mn>1</mn></msub><mo>+</mo><msub><mi>D</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>C</mi><mn>2</mn></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>z</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><msub><mi>A</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>B</mi><mn>2</mn></msub><mo>+</mo><msub><mi>D</mi><mn>2</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">
\begin{pmatrix} 
C_1 (z^{-1} - A_1)^{-1} B_1 + D_1 \\
C_2 (z^{-1} - A_2)^{-1} B_2 + D_2
\end{pmatrix}
</annotation></semantics></math></p>
<p><span class="math display">$$
\left[\begin{array}{@{}cc|c@{}}
A_1      &amp; 0       &amp; B_1 \\
0        &amp; A_2     &amp; B_2 \\  \hline
C_1      &amp; 0       &amp; D_1 \\
0        &amp; C_2     &amp; D_2
\end{array}\right]
$$</span> See <code><a href="../reference/bind.html">rbind.ratm()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="elementwise-multiplication">Elementwise Multiplication<a class="anchor" aria-label="anchor" href="#elementwise-multiplication"></a>
</h3>
<p>First consider the product of two
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo>×</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(m\times 1)</annotation></semantics></math>
matrices, and write the elementwise product as the product of a suitable
diagonal matrix with the second factor</p>
<p><span class="math display">$$
\left[\begin{array}{@{}cccc|c@{}}
A_1     &amp; \cdots  &amp; 0       &amp; B_1 C_{2,1}     &amp; B_1
D_{2,1}   \\
\vdots  &amp; \ddots  &amp; \vdots  &amp; \vdots          &amp;
\vdots        \\
0       &amp; \cdots  &amp; A_1     &amp; B_1 C_{2,m}     &amp; B_1
D_{2,m}   \\
0       &amp; \cdots  &amp; 0       &amp; A_2             &amp;
B_2           \\  \hline
C_{1,1} &amp; \cdots  &amp; 0       &amp; D_{1,1} C_{2,1} &amp; D_{1,1}
C_{2,1}  \\
\vdots  &amp; \ddots  &amp; \vdots  &amp; \vdots          &amp;
\vdots           \\
0       &amp; \cdots  &amp; C_{1,m} &amp; D_{1,m} C_{2,m} &amp; D_{1,m}
D_{2,m}  
\end{array}\right]
$$</span> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mrow><mi>i</mi><mo>,</mo><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">C_{i,k}</annotation></semantics></math>
denotes the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>-th
row of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mrow><mi>i</mi><mo>,</mo><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">D_{i,k}</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>-entry
of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo>×</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(m\times 1)</annotation></semantics></math>-dimensional
matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mi>i</mi></msub><annotation encoding="application/x-tex">D_i</annotation></semantics></math>.</p>
<p>It can be shown (???) that the controllability matrix of the above
statespace model has rank at most
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo>+</mo><msub><mi>s</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(s_1 + s_2)</annotation></semantics></math>.
Therefore we may construct an equivalent model with state dimension
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo>+</mo><msub><mi>s</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(s_1 + s_2)</annotation></semantics></math>.</p>
<p>Now we simply do this construction for all columns of the two factors
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">a(z)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">b(z)</annotation></semantics></math>
and then “column-bind” the result. The statespace realisation then has
state dimension
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo>+</mo><msub><mi>s</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">n(s_1+s_2)</annotation></semantics></math>.</p>
<p>For “wide” matrices
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>&lt;</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m&lt; n</annotation></semantics></math>)
we consider the transpose of the two factors. This gives statespace
realisations with
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mo>min</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo>,</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo>+</mo><msub><mi>s</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
s = \min(m,n)(s_1+s_2). 
</annotation></semantics></math></p>
<ul>
<li>proof ???</li>
<li>kann man die
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo>+</mo><msub><mi>s</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(s_1+s_2)</annotation></semantics></math>
Zustandsraum Darstellung direkt “hinschreiben”?</li>
</ul>
<p>See <code><a href="../reference/Ops.ratm.html">Ops.ratm()</a></code> in particular <code>a * b</code>.</p>
</div>
<div class="section level3">
<h3 id="transpose">Transpose<a class="anchor" aria-label="anchor" href="#transpose"></a>
</h3>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>C</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>z</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>I</mi><mo>−</mo><mi>A</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>B</mi><mo>+</mo><mi>D</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>′</mi><mo>=</mo><mi>B</mi><mi>′</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>z</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>I</mi><mo>−</mo><mi>A</mi><mi>′</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>C</mi><mo>+</mo><mi>D</mi><mi>′</mi></mrow><annotation encoding="application/x-tex">
(C(z^{-1}I - A)^{-1} B + D)' = B'(z^{-1}I - A')^{-1} C + D'
</annotation></semantics></math></p>
<p><span class="math display">$$
\left[\begin{array}{@{}c|c@{}}
A' &amp; C'  \\  \hline
B' &amp; D'
\end{array}\right]
$$</span></p>
<p>See <code><a href="https://rdrr.io/r/base/t.html" class="external-link">t()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="hermitean-transpose">Hermitean Transpose<a class="anchor" aria-label="anchor" href="#hermitean-transpose"></a>
</h3>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msup><mrow><mo stretchy="true" form="prefix">[</mo><mi>C</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>z</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>I</mi><mo>−</mo><mi>A</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>B</mi><mo>+</mo><mi>D</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>*</mo></msup></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mi>B</mi><mi>′</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mi>I</mi><mo>−</mo><mi>A</mi><mi>′</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>C</mi><mi>′</mi><mo>+</mo><mi>D</mi><mi>′</mi></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mi>B</mi><mi>′</mi><msup><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mi>A</mi><mi>′</mi><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>z</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>I</mi><mo>−</mo><msup><mi>A</mi><mrow><mo>−</mo><mi>T</mi></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>C</mi><mi>′</mi><mo>+</mo><mi>D</mi><mi>′</mi></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mi>B</mi><mi>′</mi><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><msup><mi>A</mi><mrow><mo>−</mo><mi>T</mi></mrow></msup><msup><mi>z</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mi>I</mi><mo>+</mo><msup><mi>z</mi><mn>2</mn></msup><msup><mi>A</mi><mrow><mo>−</mo><mi>T</mi></mrow></msup><mo>+</mo><msup><mi>z</mi><mn>3</mn></msup><msup><mi>A</mi><mrow><mo>−</mo><mn>2</mn><mi>T</mi></mrow></msup><mo>+</mo><mi>⋯</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mi>C</mi><mi>′</mi><mo>+</mo><mi>D</mi><mi>′</mi></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><msup><mi>A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>′</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>z</mi><mi>I</mi><mo>+</mo><msup><mi>z</mi><mn>2</mn></msup><msup><mi>A</mi><mrow><mo>−</mo><mi>T</mi></mrow></msup><mo>+</mo><msup><mi>Z</mi><mn>3</mn></msup><msup><mi>A</mi><mrow><mo>−</mo><mn>2</mn><mi>T</mi></mrow></msup><mo>+</mo><mi>⋯</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>C</mi><msup><mi>A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>′</mi><mo>+</mo><mi>D</mi><mi>′</mi><mo>−</mo><mi>B</mi><mi>′</mi><msup><mi>A</mi><mrow><mo>−</mo><mi>T</mi></mrow></msup><mi>C</mi><mi>′</mi></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><msup><mi>A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>′</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>z</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>I</mi><mo>−</mo><msup><mi>A</mi><mrow><mo>−</mo><mi>T</mi></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>C</mi><msup><mi>A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>′</mi><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>D</mi><mi>′</mi><mo>−</mo><mi>B</mi><mi>′</mi><msup><mi>A</mi><mrow><mo>−</mo><mi>T</mi></mrow></msup><mi>C</mi><mi>′</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{array}{rcl}
[C(z^{-1}I - A)^{-1} B + D]^* &amp;=&amp; B' (zI - A')^{-1} C' + D' \\
 &amp;=&amp; B' [(-A'z)(z^{-1}I -A^{-T})]^{-1}C' + D' \\
 &amp;=&amp; B' [(-A^{-T}z^{-1})(zI + z^2A^{-T} + z^3A^{-2T} + \cdots)]C' + D' \\
 &amp;=&amp; (-A^{-1}B)' [zI + z^2A^{-T} + Z^3A^{-2T} + \cdots)](CA^{-1})' + D' - B' A^{-T}C'\\
 &amp;=&amp; (-A^{-1}B)' (z^{-1} I - A^{-T})^{-1}(CA^{-1})' + (D' - B' A^{-T}C')\\
\end{array}
</annotation></semantics></math></p>
<p><span class="math display">$$
\left[\begin{array}{@{}c|c@{}}
A^{-T}      &amp; (CA^{-1})'  \\  \hline
(-A^{-1}B)' &amp; D' - B' A^{-T} C'
\end{array}\right]
$$</span></p>
<p>See <code><a href="../reference/Ht.html">Ht()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="derivative">Derivative<a class="anchor" aria-label="anchor" href="#derivative"></a>
</h3>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mi>d</mi><mrow><mi>d</mi><mi>z</mi></mrow></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mi>C</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>z</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mi>A</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>B</mi><mo>+</mo><mi>D</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mfrac><mi>d</mi><mrow><mi>d</mi><mi>z</mi></mrow></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mi>D</mi><mo>+</mo><mi>C</mi><mi>B</mi><mi>z</mi><mo>+</mo><mi>C</mi><mi>A</mi><mi>B</mi><msup><mi>z</mi><mn>2</mn></msup><mo>+</mo><mi>C</mi><msup><mi>A</mi><mn>2</mn></msup><mi>B</mi><msup><mi>z</mi><mn>3</mn></msup><mo>+</mo><mi>C</mi><msup><mi>A</mi><mn>2</mn></msup><mi>B</mi><msup><mi>z</mi><mn>4</mn></msup><mo>+</mo><mi>⋯</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mi>C</mi><mi>B</mi><mo>+</mo><mn>2</mn><mi>C</mi><mi>A</mi><mi>B</mi><mi>z</mi><mo>+</mo><mn>3</mn><mi>C</mi><msup><mi>A</mi><mn>2</mn></msup><mi>B</mi><msup><mi>z</mi><mn>2</mn></msup><mo>+</mo><mn>4</mn><mi>C</mi><msup><mi>A</mi><mn>2</mn></msup><mi>B</mi><msup><mi>z</mi><mn>3</mn></msup><mo>+</mo><mi>⋯</mi></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mover><mi>C</mi><mo accent="true">‾</mo></mover><mover><mi>A</mi><mo accent="true">‾</mo></mover><mover><mi>B</mi><mo accent="true">‾</mo></mover><mo>+</mo><mover><mi>C</mi><mo accent="true">‾</mo></mover><msup><mover><mi>A</mi><mo accent="true">‾</mo></mover><mn>2</mn></msup><mover><mi>B</mi><mo accent="true">‾</mo></mover><mi>z</mi><mo>+</mo><mover><mi>C</mi><mo accent="true">‾</mo></mover><msup><mover><mi>A</mi><mo accent="true">‾</mo></mover><mn>3</mn></msup><mover><mi>B</mi><mo accent="true">‾</mo></mover><msup><mi>z</mi><mn>2</mn></msup><mo>+</mo><mover><mi>C</mi><mo accent="true">‾</mo></mover><msup><mover><mi>A</mi><mo accent="true">‾</mo></mover><mn>4</mn></msup><mover><mi>B</mi><mo accent="true">‾</mo></mover><msup><mi>z</mi><mn>3</mn></msup><mo>+</mo><mi>⋯</mi></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{array}{rcl}
\frac{d}{dz} (C(z^{-1} - A)^{-1}B+D) &amp;=&amp; \frac{d}{dz}(D + CBz + CABz^2 + CA^2Bz^3  + CA^2Bz^4 + \cdots )\\
 &amp;=&amp; CB + 2CABz + 3CA^2Bz^2 + 4CA^2Bz^3 +\cdots \\
 &amp;=&amp; \bar{C}\bar{A}\bar{B} + \bar{C}\bar{A}^2\bar{B}z + \bar{C}\bar{A}^3\bar{B}z^2  + \bar{C}\bar{A}^4\bar{B}z^3 +\cdots \\
\end{array}
</annotation></semantics></math> with
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>C</mi><mo accent="true">‾</mo></mover><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>C</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="0.222em"></mspace><mover><mi>A</mi><mo accent="true">‾</mo></mover><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>A</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>I</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>A</mi></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> and </mtext><mspace width="0.333em"></mspace></mrow><mover><mi>B</mi><mo accent="true">‾</mo></mover><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>B</mi></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\bar{C} = \begin{pmatrix} C &amp; 0 \end{pmatrix},\ 
\bar{A} = \begin{pmatrix} A &amp; I \\ 0 &amp; A \end{pmatrix} \mbox{ and }
\bar{B} = \begin{pmatrix} 0 \\ B \end{pmatrix}.
</annotation></semantics></math> The corresponding statespace
realization is</p>
<p><span class="math display">$$
\left[\begin{array}{@{}cc|c@{}}
A     &amp; I       &amp; B  \\
0     &amp; A       &amp; AB \\  \hline
CA    &amp; C       &amp; CB
\end{array}\right]
$$</span> See <code><a href="../reference/derivative.html">derivative.stsp()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="construct-statespace-representation-of-rational-matrix-in-lmfd-form">Construct statespace representation of rational matrix in LMFD
form<a class="anchor" aria-label="anchor" href="#construct-statespace-representation-of-rational-matrix-in-lmfd-form"></a>
</h3>
<p>Suppose
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>a</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c(z)=a^{-1}(z) b(z)</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>a</mi><mn>0</mn></msub><mo>+</mo><msub><mi>a</mi><mn>1</mn></msub><mi>z</mi><mo>+</mo><msub><mi>a</mi><mn>2</mn></msub><msup><mi>z</mi><mn>2</mn></msup><mo>+</mo><mi>⋯</mi><mo>+</mo><msub><mi>a</mi><mi>p</mi></msub><msup><mi>z</mi><mi>p</mi></msup></mrow><annotation encoding="application/x-tex">a(z) = a_0 + a_1 z + a_2 z^2 + \cdots + a_p z^p</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>b</mi><mn>0</mn></msub><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub><mi>z</mi><mo>+</mo><mi>⋯</mi><mo>+</mo><msub><mi>b</mi><mi>q</mi></msub><msup><mi>z</mi><mi>q</mi></msup></mrow><annotation encoding="application/x-tex">b(z) = b_0 + b_1 z + \cdots + b_q z^q</annotation></semantics></math>
is given. The construction, detailed below, assumes that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mn>0</mn></msub><annotation encoding="application/x-tex">a_0</annotation></semantics></math>
is non singular and hence we rewrite the polynomial
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">a(z)</annotation></semantics></math>
as<br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>I</mi><mi>m</mi></msub><mo>−</mo><msub><mi>a</mi><mn>1</mn></msub><mi>z</mi><mo>−</mo><msub><mi>a</mi><mn>2</mn></msub><msup><mi>z</mi><mn>2</mn></msup><mo>−</mo><mi>⋯</mi><mo>−</mo><msub><mi>a</mi><mi>p</mi></msub><msup><mi>z</mi><mi>p</mi></msup></mrow><annotation encoding="application/x-tex">a(z) = I_m - a_1 z - a_2 z^2 - \cdots - a_p z^p</annotation></semantics></math>.
Furthermore we assume, w.l.o.g that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">p=q</annotation></semantics></math>.
The powerseries expansion of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>⋅</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c(\cdot)</annotation></semantics></math>
is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>k</mi><mn>0</mn></msub><mo>+</mo><msub><mi>k</mi><mn>1</mn></msub><mi>z</mi><mo>+</mo><mi>⋯</mi><mo>+</mo><msub><mi>k</mi><mi>p</mi></msub><msup><mi>z</mi><mi>p</mi></msup><mo>+</mo><mi>⋯</mi></mrow><annotation encoding="application/x-tex">c(z)=k_0 + k_1 z + \cdots + k_pz^p + \cdots</annotation></semantics></math>.</p>
<p>Then a statespace realization of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>⋅</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c(\cdot)</annotation></semantics></math>
is <span class="math display">$$
\left[\begin{array}{@{}cccc|c@{}}
a_1   &amp; \cdots &amp; a_{p-1} &amp; a_p    &amp; k_p     \\
I_m   &amp; \cdots &amp; 0       &amp; 0      &amp; k_{p-1} \\
\vdots&amp; \ddots &amp; \vdots  &amp; \vdots &amp; \vdots  \\
0     &amp; \cdots &amp; I_m     &amp; 0      &amp; k_1     \\ \hline
0     &amp; \cdots &amp; 0       &amp; I_m    &amp; k_0
\end{array}\right]
$$</span> This scheme is implemented in <code>as.stsp.lmfd</code> (and
<code>as.stsp.polm</code>).</p>
</div>
<div class="section level3">
<h3 id="construct-statespace-representation-of-rational-matrix-in-rmfd-form">Construct statespace representation of rational matrix in RMFD
form<a class="anchor" aria-label="anchor" href="#construct-statespace-representation-of-rational-matrix-in-rmfd-form"></a>
</h3>
<p>Likewise, it is possible to write an RMFD $k(z)=d(z) c^{-1}(z) $,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>c</mi><mn>0</mn></msub><mo>+</mo><msub><mi>c</mi><mn>1</mn></msub><mi>z</mi><mo>+</mo><msub><mi>c</mi><mn>2</mn></msub><msup><mi>z</mi><mn>2</mn></msup><mo>+</mo><mi>⋯</mi><mo>+</mo><msub><mi>c</mi><mi>p</mi></msub><msup><mi>z</mi><mi>p</mi></msup></mrow><annotation encoding="application/x-tex">c(z) = c_0 + c_1 z + c_2 z^2 + \cdots + c_p z^p</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>d</mi><mn>0</mn></msub><mo>+</mo><msub><mi>d</mi><mn>1</mn></msub><mi>z</mi><mo>+</mo><mi>⋯</mi><mo>+</mo><msub><mi>d</mi><mi>q</mi></msub><msup><mi>z</mi><mi>q</mi></msup></mrow><annotation encoding="application/x-tex">d(z) = d_0 + d_1 z + \cdots + d_q z^q</annotation></semantics></math>
is given. Again, we simplify the exposition by setting the non-singular
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mn>0</mn></msub><annotation encoding="application/x-tex">c_0</annotation></semantics></math>
equal to the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>-dimensional
identity matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mi>m</mi></msub><annotation encoding="application/x-tex">I_m</annotation></semantics></math>.
In the case
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>≥</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">p \geq q</annotation></semantics></math>,
the state space realization of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">k(z)</annotation></semantics></math>
is</p>
<p><span class="math display">$$
\left[\begin{array}{@{}cccc|c@{}}
c_1   &amp; \cdots &amp; c_{p-1} &amp; c_p    &amp; I_m     \\
I_m   &amp; \cdots &amp; 0       &amp; 0      &amp; 0 \\
\vdots&amp; \ddots &amp; \vdots  &amp; \vdots &amp; \vdots  \\
0     &amp; \cdots &amp; I_m     &amp; 0      &amp; 0     \\ \hline
d_1     &amp; \cdots &amp; d_{q-1}       &amp; d_q    &amp; d_0
\end{array}\right]
$$</span> If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&gt;</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">p&gt;q</annotation></semantics></math>,
some zeros appear in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>C</mi><annotation encoding="application/x-tex">C</annotation></semantics></math>
matrix. If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&lt;</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">p&lt;q</annotation></semantics></math>,
some zeros are padded into the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
matrix. This scheme is implemented in <code>as.stsp.rmfd</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="lyapunov-section">Schur, QZ Decomposition, Lyapunov and Riccati Equations<a class="anchor" aria-label="anchor" href="#lyapunov-section"></a>
</h2>
<div class="section level3">
<h3 id="functional-area-numerical-methods-7">Functional Area: Numerical Methods (#7)<a class="anchor" aria-label="anchor" href="#functional-area-numerical-methods-7"></a>
</h3>
<p>See <code>src/lyapunov.cpp</code>,
<code>inst/include/rationalmatrices_lyapunov.h</code>, and
<code>R/lyapunov.R</code> for implementation.</p>
</div>
<div class="section level3">
<h3 id="lyapunov-equation">Lyapunov Equation<a class="anchor" aria-label="anchor" href="#lyapunov-equation"></a>
</h3>
<p>The generalized (non-symmetric) Lyapunov equation is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><mi>A</mi><mi>X</mi><msup><mi>B</mi><mo>*</mo></msup><mo>+</mo><mi>Q</mi></mrow><annotation encoding="application/x-tex">
X = A X B^* + Q
</annotation></semantics></math></p>
<p>With a Schur factorization of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
we obtain a form with triangular matrices
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>X</mi><mn>11</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>X</mi><mn>12</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>X</mi><mn>21</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>X</mi><mn>22</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>A</mi><mn>11</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>A</mi><mn>12</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>A</mi><mn>22</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>X</mi><mn>11</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>X</mi><mn>12</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>X</mi><mn>21</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>X</mi><mn>22</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>B</mi><mn>11</mn><mo>*</mo></msubsup></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>B</mi><mn>12</mn><mo>*</mo></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>B</mi><mn>22</mn><mo>*</mo></msubsup></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Q</mi><mn>11</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Q</mi><mn>12</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Q</mi><mn>21</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Q</mi><mn>22</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>A</mi><mn>11</mn></msub><msub><mi>X</mi><mn>11</mn></msub><msubsup><mi>B</mi><mn>11</mn><mo>*</mo></msubsup><mo>+</mo><msub><mi>A</mi><mn>11</mn></msub><msub><mi>X</mi><mn>12</mn></msub><msubsup><mi>B</mi><mn>12</mn><mo>*</mo></msubsup><mo>+</mo><msub><mi>A</mi><mn>12</mn></msub><msub><mi>X</mi><mn>21</mn></msub><msubsup><mi>B</mi><mn>11</mn><mo>*</mo></msubsup><mo>+</mo><msub><mi>A</mi><mn>12</mn></msub><msub><mi>X</mi><mn>22</mn></msub><msubsup><mi>B</mi><mn>12</mn><mo>*</mo></msubsup></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>A</mi><mn>11</mn></msub><msub><mi>X</mi><mn>12</mn></msub><mo>+</mo><msub><mi>A</mi><mn>12</mn></msub><msub><mi>X</mi><mn>22</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><msubsup><mi>B</mi><mn>22</mn><mo>*</mo></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>A</mi><mn>22</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mn>21</mn></msub><msubsup><mi>B</mi><mn>11</mn><mo>*</mo></msubsup><mo>+</mo><msub><mi>X</mi><mn>22</mn></msub><msubsup><mi>B</mi><mn>12</mn><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>A</mi><mn>22</mn></msub><msub><mi>X</mi><mn>22</mn></msub><msubsup><mi>B</mi><mn>22</mn><mo>*</mo></msubsup></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Q</mi><mn>11</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Q</mi><mn>12</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Q</mi><mn>21</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Q</mi><mn>22</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{array}{rcl}
\begin{pmatrix}
X_{11} &amp; X_{12} \\
X_{21} &amp; X_{22} 
\end{pmatrix}
&amp;=&amp; 
\begin{pmatrix}
A_{11} &amp; A_{12} \\
0 &amp; A_{22} 
\end{pmatrix}
\begin{pmatrix}
X_{11} &amp; X_{12} \\
X_{21} &amp; X_{22} 
\end{pmatrix}
\begin{pmatrix}
B_{11}^* &amp; 0 \\
B_{12}^* &amp; B_{22}^* 
\end{pmatrix}
+
\begin{pmatrix}
Q_{11} &amp; Q_{12} \\
Q_{21} &amp; Q_{22} 
\end{pmatrix} \\
&amp;=&amp;
\begin{pmatrix}
A_{11}X_{11}B_{11}^* +  A_{11}X_{12}B_{12}^* + A_{12}X_{21}B_{11}^* + A_{12}X_{22}B_{12}^* &amp; 
    (A_{11}X_{12}+A_{12}X_{22})B_{22}^*
    \\
A_{22}(X_{21}B_{11}^*+X_{22}B_{12}^*) &amp; A_{22}X_{22}B^*_{22} 
\end{pmatrix}
+
\begin{pmatrix}
Q_{11} &amp; Q_{12} \\
Q_{21} &amp; Q_{22} 
\end{pmatrix}
\end{array}
</annotation></semantics></math></p>
<ul>
<li>22-block: solve for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>22</mn></msub><annotation encoding="application/x-tex">X_{22}</annotation></semantics></math>
</li>
<li>12-block: solve for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>12</mn></msub><annotation encoding="application/x-tex">X_{12}</annotation></semantics></math>
</li>
<li>21-block: solve for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>21</mn></msub><annotation encoding="application/x-tex">X_{21}</annotation></semantics></math>
</li>
<li>continue with 11-block</li>
</ul>
<p>we could also consider the non-square case, where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">m\times m</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n\times n</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Q</mi><annotation encoding="application/x-tex">Q</annotation></semantics></math>
is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m\times n</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="balancing-and-balanced-truncation">Balancing and Balanced Truncation<a class="anchor" aria-label="anchor" href="#balancing-and-balanced-truncation"></a>
</h3>
<p>Consider a pair of Grammians
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>,</mo><mi>Q</mi></mrow><annotation encoding="application/x-tex">P,Q</annotation></semantics></math>.
We first compute the sqare roots
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>=</mo><mi>M</mi><mi>M</mi><mi>′</mi></mrow><annotation encoding="application/x-tex">P=MM'</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo>=</mo><mi>N</mi><mi>N</mi><mi>′</mi></mrow><annotation encoding="application/x-tex">Q=NN'</annotation></semantics></math>
and then consider the SVD<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;The squared singular values of
&lt;math display=&quot;inline&quot; xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;′&lt;/mi&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;M'N&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;
are the eigenvalues of
&lt;math display=&quot;inline&quot; xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;′&lt;/mi&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mi&gt;′&lt;/mi&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;M'NN'M&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;.
Therefore the non zero, squared singular values are equal to the non
zero eigenvalues of
&lt;math display=&quot;inline&quot; xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;′&lt;/mi&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mi&gt;′&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;MM'NN'=PQ&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;.&lt;/p&gt;"><sup>1</sup></a> of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>′</mi><mi>N</mi></mrow><annotation encoding="application/x-tex">M'N</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>′</mi><mi>N</mi><mo>=</mo><mi>U</mi><mi>Σ</mi><mi>V</mi><mi>′</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>U</mi><mn>1</mn></msub><mo>,</mo><msub><mi>U</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Σ</mi><mn>11</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Σ</mi><mn>22</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>V</mi><mn>1</mn></msub><mo>,</mo><msub><mi>V</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">]</mo></mrow><mi>′</mi></mrow><annotation encoding="application/x-tex">
M'N = U \Sigma V' = 
[U_1, U_2] 
\begin{pmatrix}
\Sigma_{11} &amp; 0 \\
0 &amp; \Sigma_{22}
\end{pmatrix}
[V_1, V_2]'
</annotation></semantics></math> where the diagonal blocks
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Σ</mi><mn>11</mn></msub><annotation encoding="application/x-tex">\Sigma_{11}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Σ</mi><mn>22</mn></msub><annotation encoding="application/x-tex">\Sigma_{22}</annotation></semantics></math>
are of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo>,</mo><msub><mi>s</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(s_1,s_1)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>s</mi><mn>2</mn></msub><mo>,</mo><msub><mi>s</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(s_2,s_2)</annotation></semantics></math>
respectively. We assume that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Σ</mi><mn>11</mn></msub><annotation encoding="application/x-tex">\Sigma_{11}</annotation></semantics></math>
is positive definite and set
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>T</mi><mn>1</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><msubsup><mi>Σ</mi><mn>11</mn><mrow><mo>−</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msubsup><msub><mi>V</mi><mn>1</mn></msub><mi>′</mi><mi>N</mi><mi>′</mi></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>S</mi><mn>1</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mi>M</mi><msub><mi>U</mi><mn>1</mn></msub><msubsup><mi>Σ</mi><mn>11</mn><mrow><mo>−</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msubsup></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{array}{rcl}
T_1 &amp;=&amp; \Sigma_{11}^{-1/2} V_1' N' \\
S_1 &amp;=&amp; M U_1\Sigma_{11}^{-1/2}
\end{array}
</annotation></semantics></math> and note that
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>T</mi><mn>1</mn></msub><msub><mi>S</mi><mn>1</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><msubsup><mi>Σ</mi><mn>11</mn><mrow><mo>−</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msubsup><msub><mi>V</mi><mn>1</mn></msub><mi>′</mi><mi>N</mi><mi>′</mi><mi>M</mi><msub><mi>U</mi><mn>1</mn></msub><msubsup><mi>Σ</mi><mn>11</mn><mrow><mo>−</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><msubsup><mi>Σ</mi><mn>11</mn><mrow><mo>−</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msubsup><msub><mi>V</mi><mn>1</mn></msub><mi>′</mi><mi>V</mi><mi>Σ</mi><mi>U</mi><mi>′</mi><mi>M</mi><msub><mi>U</mi><mn>1</mn></msub><msubsup><mi>Σ</mi><mn>11</mn><mrow><mo>−</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msubsup><mo>=</mo><msub><mi>I</mi><msub><mi>s</mi><mn>1</mn></msub></msub></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{array}{rcl}
T_1 S_1 &amp;=&amp; \Sigma_{11}^{-1/2} V_1' N' M U_1\Sigma_{11}^{-1/2} \\
        &amp;=&amp; \Sigma_{11}^{-1/2} V_1' V \Sigma U' M U_1\Sigma_{11}^{-1/2} = I_{s_1}
\end{array}
</annotation></semantics></math> We extend these matrices to square
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo>×</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(s\times s)</annotation></semantics></math>
matrices
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>T</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>T</mi><mn>2</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> and </mtext><mspace width="0.333em"></mspace></mrow><mi>S</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>S</mi><mn>1</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>S</mi><mn>2</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
T = \begin{pmatrix} T_1 \\ T_2 \end{pmatrix} \mbox{ and } 
S = \begin{pmatrix} S_1 &amp; S_2 \end{pmatrix}
</annotation></semantics></math></p>
<p>such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>S</mi><mo>=</mo><mi>S</mi><mi>T</mi><mo>=</mo><msub><mi>I</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">TS=ST= I_s</annotation></semantics></math>,
i.e. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><msup><mi>T</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">S= T^{-1}</annotation></semantics></math>.
To this end we consider the SVD’s</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>S</mi><mn>1</mn></msub><msub><mi>T</mi><mn>1</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><msub><mover><mi>U</mi><mo accent="true">‾</mo></mover><mn>1</mn></msub><msub><mover><mi>Σ</mi><mo accent="true">‾</mo></mover><mn>11</mn></msub><msub><mover><mi>V</mi><mo accent="true">‾</mo></mover><mn>1</mn></msub><mi>′</mi></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="left" style="text-align: left"><msub><mover><mi>U</mi><mo accent="true">‾</mo></mover><mn>1</mn></msub><mo>,</mo><msub><mover><mi>V</mi><mo accent="true">‾</mo></mover><mn>1</mn></msub><mo>∈</mo><msup><mi>ℝ</mi><mrow><mi>s</mi><mo>×</mo><msub><mi>s</mi><mn>1</mn></msub></mrow></msup><mo>,</mo><mspace width="0.167em"></mspace><msub><mover><mi>Σ</mi><mo accent="true">‾</mo></mover><mn>11</mn></msub><mo>∈</mo><msup><mi>ℝ</mi><mrow><msub><mi>s</mi><mn>1</mn></msub><mo>×</mo><msub><mi>s</mi><mn>1</mn></msub></mrow></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mover><mi>U</mi><mo accent="true">‾</mo></mover><mn>2</mn></msub><mi>′</mi><msub><mover><mi>V</mi><mo accent="true">‾</mo></mover><mn>2</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mover><mi>U</mi><mo accent="true">̂</mo></mover><mover><mi>Σ</mi><mo accent="true">̂</mo></mover><mover><mi>V</mi><mo accent="true">̂</mo></mover><mi>′</mi></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="left" style="text-align: left"><mover><mi>U</mi><mo accent="true">̂</mo></mover><mo>,</mo><mover><mi>V</mi><mo accent="true">̂</mo></mover><mo>,</mo><mover><mi>Σ</mi><mo accent="true">̂</mo></mover><mo>∈</mo><msup><mi>ℝ</mi><mrow><msub><mi>s</mi><mn>2</mn></msub><mo>×</mo><msub><mi>s</mi><mn>2</mn></msub></mrow></msup></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{array}{rclcl}
S_1 T_1 &amp;=&amp; \bar{U}_1 \bar{\Sigma}_{11} \bar{V}_1' &amp;&amp;\bar{U}_1,\bar{V}_1\in \mathbb{R}^{s\times s_1},\, 
                                                     \bar{\Sigma}_{11} \in \mathbb{R}^{s_1 \times s_1} \\
\bar{U}_2'\bar{V}_2 &amp;=&amp; \hat{U}\hat{\Sigma}\hat{V}' &amp;&amp;\hat{U},\hat{V},\hat{\Sigma} \in \mathbb{R}^{s_2\times s_2}
\end{array}
</annotation></semantics></math> and set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub><mo>=</mo><msup><mover><mi>Σ</mi><mo accent="true">̂</mo></mover><mrow><mo>−</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msup><mover><mi>U</mi><mo accent="true">̂</mo></mover><mi>′</mi><msub><mover><mi>U</mi><mo accent="true">‾</mo></mover><mn>2</mn></msub><mi>′</mi></mrow><annotation encoding="application/x-tex">T_2 = \hat{\Sigma}^{-1/2}\hat{U}'\bar{U}_2'</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mn>2</mn></msub><mo>=</mo><msub><mover><mi>V</mi><mo accent="true">‾</mo></mover><mn>2</mn></msub><mover><mi>V</mi><mo accent="true">̂</mo></mover><msup><mover><mi>Σ</mi><mo accent="true">̂</mo></mover><mrow><mo>−</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">S_2 = \bar{V}_2\hat{V}\hat{\Sigma}^{-1/2}</annotation></semantics></math>.</p>
<p>We now consider the <em>transformed</em> statespace realization <span class="math display">$$
\left[\begin{array}{@{}c|c@{}}
A &amp; B \\ \hline
C &amp; D
\end{array}\right] \; \longrightarrow \;
\left[\begin{array}{@{}cc|c@{}}
T_1 A S_1 &amp; T_1 A S_2 &amp; T_1 B \\
T_2 A S_1 &amp; T_2 A S_2 &amp; T_2 B \\ \hline
C S_1 &amp; C S_2  &amp; D
\end{array}\right]
$$</span> and the Grammians are transformed as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>→</mo><mi>T</mi><mi>P</mi><mi>T</mi><mi>′</mi></mrow><annotation encoding="application/x-tex">P \rightarrow TPT'</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo>→</mo><mi>S</mi><mi>′</mi><mi>Q</mi><mi>S</mi></mrow><annotation encoding="application/x-tex">Q \rightarrow S' QS</annotation></semantics></math>.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>M</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>Σ</mi><mn>11</mn><mrow><mo>−</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msubsup><msub><mi>V</mi><mn>1</mn></msub><mi>′</mi><mi>N</mi><mi>′</mi><mi>M</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>T</mi><mn>2</mn></msub><mi>M</mi></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>Σ</mi><mn>11</mn><mrow><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msubsup><msub><mi>U</mi><mn>1</mn></msub><mi>′</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>T</mi><mn>2</mn></msub><mi>M</mi></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
T M = \begin{pmatrix} \Sigma_{11}^{-1/2} V_1' N' M \\ T_2 M \end{pmatrix} 
    = \begin{pmatrix} \Sigma_{11}^{1/2} U_1' \\ T_2 M \end{pmatrix} 
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>′</mi><mi>N</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>Σ</mi><mn>11</mn><mrow><mo>−</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msubsup><msub><mi>U</mi><mn>1</mn></msub><mi>′</mi><mi>M</mi><mi>′</mi><mi>N</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>S</mi><mn>2</mn></msub><mi>′</mi><mi>N</mi></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>Σ</mi><mn>11</mn><mrow><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msubsup><msub><mi>V</mi><mn>1</mn></msub><mi>′</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>S</mi><mn>2</mn></msub><mi>′</mi><mi>N</mi></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
S' N = \begin{pmatrix} \Sigma_{11}^{-1/2} U_1' M' N \\ S_2' N \end{pmatrix} 
    = \begin{pmatrix} \Sigma_{11}^{1/2} V_1' \\ S_2' N \end{pmatrix} 
</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>P</mi><mi>T</mi><mi>′</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mi>M</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mi>M</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>′</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>Σ</mi><mn>11</mn><mrow><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msubsup><msub><mi>U</mi><mn>1</mn></msub><mi>′</mi><msub><mi>U</mi><mn>1</mn></msub><msubsup><mi>Σ</mi><mn>11</mn><mrow><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>Σ</mi><mn>11</mn><mrow><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msubsup><msub><mi>U</mi><mn>1</mn></msub><mi>′</mi><mi>M</mi><mi>′</mi><msub><mi>T</mi><mn>2</mn></msub><mi>′</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>T</mi><mn>2</mn></msub><mi>M</mi><msub><mi>U</mi><mn>1</mn></msub><msubsup><mi>Σ</mi><mn>11</mn><mrow><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>T</mi><mn>2</mn></msub><mi>M</mi><mi>M</mi><mi>′</mi><msub><mi>T</mi><mn>2</mn></msub><mi>′</mi></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Σ</mi><mn>11</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>T</mi><mn>2</mn></msub><mi>P</mi><msub><mi>T</mi><mn>2</mn></msub><mi>′</mi></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
TPT' = (TM)(TM)' = 
\begin{pmatrix} 
\Sigma_{11}^{1/2} U_1' U_1 \Sigma_{11}^{1/2}  &amp; \Sigma_{11}^{1/2} U_1' M' T_2'  \\ 
T_2 M U_1 \Sigma_{11}^{1/2}                    &amp; T_2 MM' T_2' 
\end{pmatrix} = 
\begin{pmatrix} 
\Sigma_{11} &amp; 0 \\ 
0           &amp; T_2 P T_2' 
\end{pmatrix}
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>′</mi><mi>Q</mi><mi>S</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>S</mi><mi>′</mi><mi>N</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>S</mi><mi>′</mi><mi>N</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>′</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>Σ</mi><mn>11</mn><mrow><mo>−</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msubsup><msub><mi>V</mi><mn>1</mn></msub><mi>′</mi><msub><mi>V</mi><mn>1</mn></msub><msubsup><mi>Σ</mi><mn>11</mn><mrow><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>Σ</mi><mn>11</mn><mrow><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msubsup><msub><mi>V</mi><mn>1</mn></msub><mi>′</mi><mi>N</mi><mi>′</mi><msub><mi>S</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>S</mi><mn>2</mn></msub><mi>′</mi><mi>N</mi><msub><mi>V</mi><mn>1</mn></msub><msubsup><mi>Σ</mi><mn>11</mn><mrow><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>S</mi><mn>2</mn></msub><mi>′</mi><mi>N</mi><mi>N</mi><mi>′</mi><msub><mi>S</mi><mn>2</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Σ</mi><mn>11</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>S</mi><mn>2</mn></msub><mi>′</mi><mi>Q</mi><msub><mi>S</mi><mn>2</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
S'QS = (S'N)(S'N)' = 
\begin{pmatrix} 
\Sigma_{11}^{-1/2} V_1' V_1 \Sigma_{11}^{1/2}  &amp; \Sigma_{11}^{1/2} V_1' N' S_2  \\ 
S_2' N V_1 \Sigma_{11}^{1/2}                    &amp; S_2' NN' S_2  
\end{pmatrix} = 
\begin{pmatrix} 
\Sigma_{11} &amp; 0 \\ 
0           &amp; S_2' Q S_2 
\end{pmatrix}
</annotation></semantics></math> Here we have used that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub><mi>M</mi><msub><mi>U</mi><mn>1</mn></msub><msubsup><mi>Σ</mi><mn>11</mn><mrow><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msubsup><mo>=</mo><msub><mi>T</mi><mn>2</mn></msub><msub><mi>S</mi><mn>1</mn></msub><msub><mi>Σ</mi><mn>11</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">T_2 M U_1 \Sigma_{11}^{1/2} = T_2 S_1 \Sigma_{11} = 0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Σ</mi><mn>11</mn><mrow><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msubsup><msub><mi>V</mi><mn>1</mn></msub><mi>′</mi><mi>N</mi><mi>′</mi><msub><mi>S</mi><mn>2</mn></msub><mo>=</mo><msub><mi>Σ</mi><mn>11</mn></msub><msub><mi>T</mi><mn>1</mn></msub><msub><mi>S</mi><mn>2</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\Sigma_{11}^{1/2} V_1' N' S_2 = \Sigma_{11} T_1 S_2 = 0</annotation></semantics></math>.
Due to the block diagonal structure of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>P</mi><mi>T</mi><mi>′</mi></mrow><annotation encoding="application/x-tex">TPT'</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>′</mi><mi>Q</mi><mi>S</mi></mrow><annotation encoding="application/x-tex">S'QS</annotation></semantics></math>
we also immediately get</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>P</mi><mi>Q</mi><mi>S</mi><mo>=</mo><mi>T</mi><mi>P</mi><mi>T</mi><mi>′</mi><mi>S</mi><mi>′</mi><mi>Q</mi><mi>S</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>Σ</mi><mn>11</mn><mn>2</mn></msubsup></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>T</mi><mn>2</mn></msub><mi>P</mi><mi>Q</mi><msub><mi>S</mi><mn>2</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
TPQS = TPT' S'QS =  
\begin{pmatrix} 
\Sigma_{11}^2 &amp; 0 \\ 
0           &amp; T_2 P Q S_2 
\end{pmatrix}
</annotation></semantics></math></p>
<p>and</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub><mi>P</mi><mi>Q</mi><msub><mi>S</mi><mn>2</mn></msub><mo>=</mo><msub><mi>T</mi><mn>2</mn></msub><mi>M</mi><mi>M</mi><mi>′</mi><mi>N</mi><mi>N</mi><mi>′</mi><msub><mi>S</mi><mn>2</mn></msub><mo>=</mo><msub><mi>T</mi><mn>2</mn></msub><mi>M</mi><mi>U</mi><mi>Σ</mi><mi>V</mi><mi>′</mi><mi>N</mi><mi>′</mi><msub><mi>S</mi><mn>2</mn></msub><mo>=</mo><munder><munder><mrow><msub><mi>T</mi><mn>2</mn></msub><mi>M</mi><msub><mi>U</mi><mn>1</mn></msub></mrow><mo accent="true">⏟</mo></munder><mrow><mo>=</mo><mn>0</mn></mrow></munder><msub><mi>Σ</mi><mn>11</mn></msub><munder><munder><mrow><msub><mi>V</mi><mn>1</mn></msub><mi>′</mi><mi>N</mi><mi>′</mi><msub><mi>S</mi><mn>2</mn></msub></mrow><mo accent="true">⏟</mo></munder><mrow><mo>=</mo><mn>0</mn></mrow></munder><mo>+</mo><msub><mi>T</mi><mn>2</mn></msub><mi>M</mi><msub><mi>U</mi><mn>2</mn></msub><msub><mi>Σ</mi><mn>22</mn></msub><msub><mi>V</mi><mn>2</mn></msub><mi>′</mi><mi>N</mi><mi>′</mi><msub><mi>S</mi><mn>2</mn></msub><mo>=</mo><msub><mi>T</mi><mn>2</mn></msub><mi>M</mi><msub><mi>U</mi><mn>2</mn></msub><msub><mi>Σ</mi><mn>22</mn></msub><msub><mi>V</mi><mn>2</mn></msub><mi>′</mi><mi>N</mi><mi>′</mi><msub><mi>S</mi><mn>2</mn></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">
T_2 PQ S_2 = T_2 MM' NN' S_2 = T_2 M U\Sigma V' N'S_2 = 
 \underbrace{T_2 M U_1}_{=0}\Sigma_{11} \underbrace{V_1' N' S_2}_{=0} + T_2 M U_2\Sigma_{22} V_2' N' S_2 = 
 T_2 M U_2\Sigma_{22} V_2' N' S_2. 
</annotation></semantics></math></p>
<p>The following scenarios are of particular interest:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>2</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">s_2=0</annotation></semantics></math>:
The model is <em>minimal</em> and the above procedure renders the
statespace realization into balanced form.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>2</mn></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">s_2&gt;0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Σ</mi><mn>22</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\Sigma_{22} = 0</annotation></semantics></math>:
The above procedure renders the model in a form where the controllable
and observable states are clearly seperated from the non observable or
non controllable states. In particular the truncated model <span class="math display">$$
\left[\begin{array}{@{}c|c@{}}
T_1 A S_1 &amp; T_1 B \\
T_2 A S_1 &amp; T_2 B \\ \hline
C S_1     &amp; D
\end{array}\right]
$$</span> is equivalent to the original model and it is minimal and in
balanced form</li>
<li>If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>2</mn></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">s_2&gt;0</annotation></semantics></math>
but
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Σ</mi><mn>22</mn></msub><mo>≠</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\Sigma_{22} \neq 0</annotation></semantics></math>
then the truncated model is just an approximation of the original model.
The quality depends on the size of the neglected singular values. Note
also that the truncated model is not balanced.</li>
</ul>
<p>Note that the determination of the number of non zeroe singular
values is quite tricky. (difficult due to numerics). Currently the
number of non zero singular values is chosen as the number of singular
values which satisfy
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><mi>k</mi></msub><mo>&gt;</mo><mi>τ</mi><msub><mi>σ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\sigma_k &gt; \tau \sigma_1</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
is a user defined tolerance parameter.</p>
</div>
<div class="section level3">
<h3 id="reflect-section">Reflect Poles and Zeroes<a class="anchor" aria-label="anchor" href="#reflect-section"></a>
</h3>
<div class="section level4">
<h4 id="functional-area-polezero-reflection-8">Functional Area: Pole/Zero Reflection (#8)<a class="anchor" aria-label="anchor" href="#functional-area-polezero-reflection-8"></a>
</h4>
<p>See <code>R/reflect_poles_zeroes.R</code> for implementation.</p>
</div>
<div class="section level4">
<h4 id="all-pass-matrices">All-Pass Matrices<a class="anchor" aria-label="anchor" href="#all-pass-matrices"></a>
</h4>
<p>A rational matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">k(z)</annotation></semantics></math>
is all-pass if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>k</mi><mi>′</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>1</mn><mi>z</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>k</mi><mi>′</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>1</mn><mi>z</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>k</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>I</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">k(z) k'\left(\frac{1}{z}\right) = k'\left(\frac{1}{z}\right) k(z) = I_m</annotation></semantics></math>.
If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo>,</mo><mi>B</mi><mo>,</mo><mi>C</mi><mo>,</mo><mi>D</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(A,B,C,D)</annotation></semantics></math>
is a statespace realization of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">k(z)</annotation></semantics></math>
then the product
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>k</mi><mi>′</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>1</mn><mi>z</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">k(z) k'\left(\frac{1}{z}\right)</annotation></semantics></math>
has a realization given by <span class="math display">$$
\left[\begin{array}{@{}cc|c@{}}
A   &amp; -BB'A^{-T}   &amp; BD' - BB'A^{-T}C' \\
0   &amp; A^{-T}       &amp; A^{-T}C' \\ \hline
C   &amp; -DB'A^{-T}   &amp; DD' - DB' A^{-T} C'
\end{array}\right]
$$</span></p>
<p>A state transformation gives</p>
<p><span class="math display">$$
\left[
\begin{array}{@{}cc|c@{}}
I &amp; X &amp; 0 \\
0 &amp; I &amp; 0 \\ \hline
0 &amp; 0 &amp; I
\end{array}
\right]
\left[\begin{array}{@{}cc|c@{}}
A   &amp; -BB'A^{-T}   &amp; BD' - BB'A^{-T}C' \\
0   &amp; A^{-T}       &amp; A^{-T}C' \\ \hline
C   &amp; -DB'A^{-T}   &amp; DD' - DB' A^{-T} C'
\end{array}\right]
\left[
\begin{array}{@{}cc|c@{}}
I &amp; -X &amp; 0 \\
0 &amp; I &amp; 0 \\ \hline
0 &amp; 0 &amp; I
\end{array}
\right]
=
\left[\begin{array}{@{}cc|c@{}}
A   &amp; XA^{-T}-AX-BB'A^{-T}   &amp; BD' - BB'A^{-T}C' + X A^{-T}C'\\
0   &amp; A^{-T}                 &amp; A^{-T}C' \\ \hline
C   &amp; -DB'A^{-T}-CX   &amp; DD' - DB' A^{-T} C'
\end{array}\right]
$$</span></p>
<p>The (1,1) block is not controllable and the (2,2) block is not
observable if</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>X</mi><msup><mi>A</mi><mrow><mo>−</mo><mi>T</mi></mrow></msup><mo>−</mo><mi>A</mi><mi>X</mi><mo>−</mo><mi>B</mi><mi>B</mi><mi>′</mi><msup><mi>A</mi><mrow><mo>−</mo><mi>T</mi></mrow></msup></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mo>⇔</mo></mtd><mtd columnalign="right" style="text-align: right"><mi>X</mi><mo>−</mo><mi>A</mi><mi>X</mi><mi>A</mi><mi>′</mi><mo>−</mo><mi>B</mi><mi>B</mi><mi>′</mi></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mo>−</mo><mi>D</mi><mi>B</mi><mi>′</mi><msup><mi>A</mi><mrow><mo>−</mo><mi>T</mi></mrow></msup><mo>−</mo><mi>C</mi><mi>X</mi></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mo>⇔</mo></mtd><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">[</mo><mi>X</mi><mi>′</mi><mo>,</mo><msup><mi>A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>B</mi><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mo stretchy="true" form="prefix">[</mo><mi>C</mi><mo>,</mo><mi>D</mi><mo stretchy="true" form="postfix">]</mo></mrow><mi>′</mi></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>B</mi><mi>D</mi><mi>′</mi><mo>−</mo><mi>B</mi><mi>B</mi><mi>′</mi><msup><mi>A</mi><mrow><mo>−</mo><mi>T</mi></mrow></msup><mi>C</mi><mi>′</mi><mo>+</mo><mi>X</mi><msup><mi>A</mi><mrow><mo>−</mo><mi>T</mi></mrow></msup><mi>C</mi><mi>′</mi></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mo>⇔</mo></mtd><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">[</mo><mi>X</mi><msup><mi>A</mi><mrow><mo>−</mo><mi>T</mi></mrow></msup><mo>−</mo><mi>B</mi><mi>B</mi><mi>′</mi><msup><mi>A</mi><mrow><mo>−</mo><mi>T</mi></mrow></msup><mo>,</mo><mi>B</mi><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mo stretchy="true" form="prefix">[</mo><mi>C</mi><mo>,</mo><mi>D</mi><mo stretchy="true" form="postfix">]</mo></mrow><mi>′</mi></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="left" style="text-align: left"></mtd><mtd columnalign="center" style="text-align: center"><mo>⇔</mo></mtd><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">[</mo><mi>A</mi><mi>X</mi><mi>′</mi><mo>,</mo><mi>B</mi><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mo stretchy="true" form="prefix">[</mo><mi>C</mi><mo>,</mo><mi>D</mi><mo stretchy="true" form="postfix">]</mo></mrow><mi>′</mi></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{array}{rclcrcl}
XA^{-T}-AX-BB'A^{-T} &amp;=&amp; 0 &amp; \Longleftrightarrow   &amp; X -AXA' - BB' &amp;=&amp; 0 \\
-DB'A^{-T}-CX &amp;=&amp; 0        &amp;  \Longleftrightarrow  &amp; [X', A^{-1}B] [C, D]' &amp;=&amp; 0\\
BD' - BB'A^{-T}C' + X A^{-T}C' &amp;=&amp; 0 
                           &amp;  \Longleftrightarrow  &amp; [XA^{-T}-BB'A^{-T}, B][C, D]'  &amp;=&amp; 0\\
 &amp; &amp;                       &amp;  \Longleftrightarrow  &amp; [AX', B][C, D]'  &amp;=&amp; 0\\
\end{array}
</annotation></semantics></math> Furthermore
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>D</mi><mi>′</mi><mo>−</mo><mi>D</mi><mi>B</mi><mi>′</mi><msup><mi>A</mi><mrow><mo>−</mo><mi>T</mi></mrow></msup><mi>C</mi><mi>′</mi><mo>=</mo><mi>D</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>B</mi><mi>′</mi><msup><mi>A</mi><mrow><mo>−</mo><mi>T</mi></mrow></msup><mo>,</mo><mo>−</mo><mi>I</mi><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mo stretchy="true" form="prefix">[</mo><mi>C</mi><mo>,</mo><mi>D</mi><mo stretchy="true" form="postfix">]</mo></mrow><mi>′</mi><mo>=</mo><mi>I</mi></mrow><annotation encoding="application/x-tex">
DD' - DB' A^{-T} C' = D[B'A^{-T}, -I][C,D]' = I
</annotation></semantics></math> must hold.</p>
<p>It follows that we end up with the system <span class="math display">$$
\left[\begin{array}{@{}cc|c@{}}
A   &amp; 0   &amp; 0\\
0   &amp; A^{-T}                 &amp; A^{-T}C' \\ \hline
C   &amp; 0   &amp; I
\end{array}\right]
$$</span> whose transfer function is equal to
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>C</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>I</mi><msup><mi>z</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>A</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msup><mi>A</mi><mrow><mo>−</mo><mi>T</mi></mrow></msup></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msup><mi>A</mi><mrow><mo>−</mo><mi>T</mi></mrow></msup><mi>C</mi><mi>′</mi></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>I</mi><mi>m</mi></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">
\begin{pmatrix} C &amp; 0 \end{pmatrix} \left( I z^{-1} - \begin{pmatrix} A &amp; 0 \\ 0 &amp; A^{-T} \end{pmatrix} \right)^{-1} \begin{pmatrix} 0 \\ A^{-T}C' \end{pmatrix} + I_m,
</annotation></semantics></math> i.e. the identity matrix as
required.</p>
<p>In the following we need to construct an allpass matrix with given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo>,</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(A,B)</annotation></semantics></math>
(or given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo>,</mo><mi>C</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(A,C)</annotation></semantics></math>).</p>
<ol style="list-style-type: decimal">
<li>From the above Lyapunov equation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><mi>A</mi><mi>X</mi><mi>A</mi><mi>′</mi><mo>+</mo><mi>B</mi><mi>B</mi><mi>′</mi></mrow><annotation encoding="application/x-tex">X = AXA' + BB'</annotation></semantics></math>
determine
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>.</li>
<li>Determine the row space of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mi>C</mi><mo>,</mo><mi>D</mi><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[C,D]</annotation></semantics></math>
from the left kernel of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">[</mo><mi>A</mi><mi>X</mi><mi>′</mi><mo>,</mo><mi>B</mi><mo stretchy="true" form="postfix">]</mo></mrow><mi>′</mi></mrow><annotation encoding="application/x-tex">[AX',B]'</annotation></semantics></math>.</li>
<li>Determine the scaling matrix from the requirement
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>D</mi><mi>′</mi><mo>−</mo><mi>D</mi><mi>B</mi><mi>′</mi><msup><mi>A</mi><mrow><mo>−</mo><mi>T</mi></mrow></msup><mi>C</mi><mi>′</mi><mo>=</mo><mi>I</mi></mrow><annotation encoding="application/x-tex">DD' - DB' A^{-T} C' = I</annotation></semantics></math>.</li>
</ol>
<p><em>Note:</em> Wann gibt es Probleme? ….</p>
</div>
<div class="section level4">
<h4 id="zero-cancellations">zero cancellations<a class="anchor" aria-label="anchor" href="#zero-cancellations"></a>
</h4>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">k(z)</annotation></semantics></math>
be given. We want to find an allpass transfer function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>k</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{k}(z)</annotation></semantics></math>
such some of the poles of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">k(z)</annotation></semantics></math>
are cancelled in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mover><mi>k</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">k(z)\hat{k}(z)</annotation></semantics></math>.</p>
<p>Consider the state transformation of the realization of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mover><mi>k</mi><mo accent="true">̂</mo></mover></mrow><annotation encoding="application/x-tex">k\hat{k}</annotation></semantics></math>:</p>
<p><span class="math display">$$
\left[
\begin{array}{@{}ccc|c@{}}
I &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; I &amp; 0  &amp; 0 \\
I &amp; 0 &amp; I  &amp; 0 \\ \hline
0 &amp; 0 &amp; 0  &amp; I
\end{array}
\right]
\left[
\begin{array}{@{}ccc|c@{}}
A_{11} &amp; A_{12} &amp; B_{1}\hat{C} &amp; B_{1}\hat{D} \\
A_{21} &amp; A_{22} &amp; B_{2}\hat{C} &amp; B_{2}\hat{D} \\
     0 &amp; 0      &amp; \hat{A}      &amp; \hat{B} \\ \hline
C_{1}  &amp; C_{2}  &amp; D\hat{C}     &amp; D\hat{D}
\end{array}
\right]
\left[
\begin{array}{@{}ccc|c@{}}
I &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; I &amp; 0 &amp; 0 \\
-I &amp; 0 &amp; I &amp; 0 \\ \hline
0 &amp; 0 &amp; 0 &amp; I
\end{array}
\right] =
\left[
\begin{array}{@{}ccc|c@{}}
A_{11}-B_{1}\hat{C}    &amp; A_{12} &amp; B_{1}\hat{C} &amp;
B_{1}\hat{D}\\
A_{21}-B_{2}\hat{C}    &amp; A_{22} &amp; B_{2}\hat{C}           &amp;
B_2 \hat{D} \\
A_{11}-B_{1}\hat{C} -\hat{A}         &amp; A_{12}      &amp; \hat{A} +
B_{1}\hat{C}  &amp; B_{1}\hat{D} + \hat{B} \\ \hline
C_{1}-D\hat{C}  &amp; C_{2}  &amp; D\hat{C}                  &amp;
D\hat{D}
\end{array}
\right]
$$</span> The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(1,1)</annotation></semantics></math>
block is not observable if
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>A</mi><mn>21</mn></msub><mo>−</mo><msub><mi>B</mi><mn>2</mn></msub><mover><mi>C</mi><mo accent="true">̂</mo></mover></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mo>⇔</mo></mtd><mtd columnalign="right" style="text-align: right"><msub><mi>A</mi><mn>21</mn></msub><mo>−</mo><msub><mi>B</mi><mn>2</mn></msub><msup><mi>D</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>C</mi><mn>1</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>A</mi><mn>11</mn></msub><mo>−</mo><msub><mi>B</mi><mn>1</mn></msub><mover><mi>C</mi><mo accent="true">̂</mo></mover><mo>−</mo><mover><mi>A</mi><mo accent="true">̂</mo></mover></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mo>⇔</mo></mtd><mtd columnalign="right" style="text-align: right"><mover><mi>A</mi><mo accent="true">̂</mo></mover></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>A</mi><mn>11</mn></msub><mo>−</mo><msub><mi>B</mi><mn>1</mn></msub><msup><mi>D</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>C</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>C</mi><mn>1</mn></msub><mo>−</mo><mi>D</mi><mover><mi>C</mi><mo accent="true">̂</mo></mover></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mo>⇔</mo></mtd><mtd columnalign="right" style="text-align: right"><mover><mi>C</mi><mo accent="true">̂</mo></mover></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><msup><mi>D</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>C</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{array}{rclcrcl}
A_{21} - B_2 \hat{C} &amp;=&amp; 0 &amp;\Longleftrightarrow&amp; A_{21} - B_2 D^{-1} C_1 &amp;=&amp; 0\\
A_{11}-B_{1}\hat{C} -\hat{A} &amp;=&amp; 0 &amp;\Longleftrightarrow&amp; \hat{A} &amp;=&amp; A_{11} - B_1 D^{-1} C_1 \\
C_{1}-D\hat{C} &amp;=&amp; 0 &amp;\Longleftrightarrow&amp; \hat{C} &amp;=&amp; D^{-1} C_1 \\
\end{array}
</annotation></semantics></math></p>
</div>
<div class="section level4">
<h4 id="pole-cancellations">pole cancellations<a class="anchor" aria-label="anchor" href="#pole-cancellations"></a>
</h4>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">k(z)</annotation></semantics></math>
be given. We want to find an allpass transfer function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>k</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{k}(z)</annotation></semantics></math>
such some of the poles of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">k(z)</annotation></semantics></math>
are cancelled in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mover><mi>k</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">k(z)\hat{k}(z)</annotation></semantics></math>.</p>
<p>Consider the state transformation of the realization of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mover><mi>k</mi><mo accent="true">̂</mo></mover></mrow><annotation encoding="application/x-tex">k\hat{k}</annotation></semantics></math>:</p>
<p><span class="math display">$$
\left[
\begin{array}{@{}ccc|c@{}}
I &amp; 0 &amp; -I &amp; 0 \\
0 &amp; I &amp; 0  &amp; 0 \\
0 &amp; 0 &amp; I  &amp; 0 \\ \hline
0 &amp; 0 &amp; 0  &amp; I
\end{array}
\right]
\left[
\begin{array}{@{}ccc|c@{}}
A_{11} &amp; A_{12} &amp; B_{1}\hat{C} &amp; B_{1}\hat{D} \\
A_{21} &amp; A_{22} &amp; B_{2}\hat{C} &amp; B_{2}\hat{D} \\
     0 &amp; 0      &amp; \hat{A}      &amp; \hat{B} \\ \hline
C_{1}  &amp; C_{2}  &amp; D\hat{C}     &amp; D\hat{D}
\end{array}
\right]
\left[
\begin{array}{@{}ccc|c@{}}
I &amp; 0 &amp; I &amp; 0 \\
0 &amp; I &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; I &amp; 0 \\ \hline
0 &amp; 0 &amp; 0 &amp; I
\end{array}
\right] =
\left[
\begin{array}{@{}ccc|c@{}}
A_{11}    &amp; A_{12} &amp; A_{11} + B_{1}\hat{C} - \hat{A} &amp;
B_{1}\hat{D} - \hat{B} \\
A_{21}    &amp; A_{22} &amp; A_{21} + B_{2}\hat{C}           &amp; B_2
\hat{D} \\
0         &amp; 0      &amp; \hat{A}                         &amp;
\hat{B} \\ \hline
C_{1}     &amp; C_{2}  &amp; C_1 + D\hat{C}                  &amp;
D\hat{D}
\end{array}
\right]
$$</span></p>
<p>The (1,1) block is not controllable if</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>A</mi><mn>12</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mo>⇔</mo></mtd><mtd columnalign="right" style="text-align: right"><msub><mi>A</mi><mn>12</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mover><mi>A</mi><mo accent="true">̂</mo></mover></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>A</mi><mn>11</mn></msub><mo>+</mo><msub><mi>B</mi><mn>1</mn></msub><mover><mi>C</mi><mo accent="true">̂</mo></mover></mtd><mtd columnalign="center" style="text-align: center"><mo>⇔</mo></mtd><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>A</mi><mo accent="true">̂</mo></mover><mo>−</mo><mover><mi>B</mi><mo accent="true">̂</mo></mover><msup><mover><mi>D</mi><mo accent="true">̂</mo></mover><mrow><mo>−</mo><mn>1</mn></mrow></msup><mover><mi>C</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>A</mi><mn>11</mn></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mover><mi>B</mi><mo accent="true">̂</mo></mover></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>B</mi><mn>1</mn></msub><mover><mi>D</mi><mo accent="true">̂</mo></mover></mtd><mtd columnalign="center" style="text-align: center"><mo>⇔</mo></mtd><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>B</mi><mo accent="true">̂</mo></mover><msup><mover><mi>D</mi><mo accent="true">̂</mo></mover><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>B</mi><mn>1</mn></msub></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{array}{rclcrcl}
A_{12} &amp;=&amp; 0                       &amp; \Longleftrightarrow &amp; A_{12} &amp;=&amp; 0\\
\hat{A} &amp;=&amp; A_{11} + B_1 \hat{C}   &amp; \Longleftrightarrow &amp; (\hat{A} - \hat{B} \hat{D}^{-1} \hat{C}) &amp;=&amp; A_{11}\\
\hat{B} &amp;=&amp; B_1 \hat{D}            &amp; \Longleftrightarrow &amp; (\hat{B}\hat{D}^{-1}) &amp;=&amp; B_{1}
\end{array}
</annotation></semantics></math></p>
<p>Hence the
“<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>,</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A,B</annotation></semantics></math>”
matrices of the inverse of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mover><mi>k</mi><mo accent="true">̂</mo></mover><mrow><mo>−</mo><mn>1</mn></mrow></msup><annotation encoding="application/x-tex">\hat{k}^{-1}</annotation></semantics></math>
are determined.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="qr-section">QR Decomposition, Rank and Null Space<a class="anchor" aria-label="anchor" href="#qr-section"></a>
</h2>
<div class="section level3">
<h3 id="functional-area-utilities-helpers-10">Functional Area: Utilities &amp; Helpers (#10)<a class="anchor" aria-label="anchor" href="#functional-area-utilities-helpers-10"></a>
</h3>
<p>Supporting theory for rank computation and null space analysis in
polynomial operations.</p>
<p>Consider the following example</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tol</span> <span class="op">=</span> <span class="fl">1e-7</span></span>
<span><span class="va">tol2</span> <span class="op">=</span> <span class="va">tol</span><span class="op">/</span><span class="fl">10</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">tol2</span>, <span class="va">tol2</span><span class="op">^</span><span class="fl">2</span>, <span class="va">tol2</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">qr_x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/qr.html" class="external-link">qr</a></span><span class="op">(</span><span class="va">x</span>, tol <span class="op">=</span> <span class="va">tol</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x</span></span>
<span><span class="co">#&gt;      [,1]  [,2]  [,3]  [,4]</span></span>
<span><span class="co">#&gt; [1,]    1 0e+00 0e+00 0e+00</span></span>
<span><span class="co">#&gt; [2,]    0 1e-08 0e+00 0e+00</span></span>
<span><span class="co">#&gt; [3,]    0 0e+00 1e-16 0e+00</span></span>
<span><span class="co">#&gt; [4,]    0 0e+00 0e+00 1e-24</span></span>
<span><span class="va">qr_x</span><span class="op">$</span><span class="va">rank</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="va">qr_x</span><span class="op">$</span><span class="va">pivot</span></span>
<span><span class="co">#&gt; [1] 1 2 3 4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/qraux.html" class="external-link">qr.R</a></span><span class="op">(</span><span class="va">qr_x</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1]   [,2]   [,3]  [,4]</span></span>
<span><span class="co">#&gt; [1,]   -1  0e+00  0e+00 0e+00</span></span>
<span><span class="co">#&gt; [2,]    0 -1e-08  0e+00 0e+00</span></span>
<span><span class="co">#&gt; [3,]    0  0e+00 -1e-16 0e+00</span></span>
<span><span class="co">#&gt; [4,]    0  0e+00  0e+00 1e-24</span></span></code></pre></div>
<p>Is this the desired result for the rank (and the null space)? The
main reason for this somewhat strange results is that <code><a href="https://rdrr.io/r/base/qr.html" class="external-link">qr()</a></code>
considers a column as zero, if and only if the projection onto the space
spanned by the previous columns reduces the norm by a factor which is
larger than <code>tol</code>.</p>
<p>The following example works as desired</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="va">qr_x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/qr.html" class="external-link">qr</a></span><span class="op">(</span><span class="va">x</span>, tol <span class="op">=</span> <span class="va">tol</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x</span></span>
<span><span class="co">#&gt;      [,1]  [,2]  [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,]    1 1e+00 1e+00    1</span></span>
<span><span class="co">#&gt; [2,]    0 1e-08 0e+00    0</span></span>
<span><span class="co">#&gt; [3,]    0 0e+00 1e-16    0</span></span>
<span><span class="co">#&gt; [4,]    0 0e+00 0e+00    1</span></span>
<span><span class="va">qr_x</span><span class="op">$</span><span class="va">rank</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="va">qr_x</span><span class="op">$</span><span class="va">pivot</span></span>
<span><span class="co">#&gt; [1] 1 4 2 3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/qraux.html" class="external-link">qr.R</a></span><span class="op">(</span><span class="va">qr_x</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]   [,3]   [,4]</span></span>
<span><span class="co">#&gt; [1,]   -1   -1 -1e+00 -1e+00</span></span>
<span><span class="co">#&gt; [2,]    0   -1  0e+00  0e+00</span></span>
<span><span class="co">#&gt; [3,]    0    0 -1e-08  0e+00</span></span>
<span><span class="co">#&gt; [4,]    0    0  0e+00  1e-16</span></span></code></pre></div>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://scholar.google.com/citations?user=-Ytb9BYAAAAJ" class="external-link">Wolfgang Scherrer</a>, <a href="https://ch.linkedin.com/in/bernd-funovits-phd-cfa-a8215016" class="external-link">Bernd Funovits</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
