<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rationalmatrices">
<title>Rational Matrices: Technical Details • rationalmatrices</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Rational Matrices: Technical Details">
<meta property="og:description" content="rationalmatrices">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rationalmatrices</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a_rational_matrices.html">Rational Matrices</a>
    <a class="dropdown-item" href="../articles/b_technical_details_ratm.html">Rational Matrices: Technical Details</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Rational Matrices: Technical Details</h1>
                        <h4 data-toc-skip class="author">Wolfgang
Scherrer and Bernd Funovits</h4>
            
            <h4 data-toc-skip class="date">2023-12-02</h4>
      
      
      <div class="d-none name"><code>b_technical_details_ratm.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="left-coprime-polynomials">Left Coprime Polynomials<a class="anchor" aria-label="anchor" href="#left-coprime-polynomials"></a>
</h2>
<p>A polynomial matrix <span class="math inline">\(c\)</span> is called
<em>left prime</em>, if <span class="math inline">\(c(z)\)</span> has
full row rank everywhere in the complex plane. Clearly this implies that
<span class="math inline">\(c\)</span> is square or “wide”, i.e. if
<span class="math inline">\(c\)</span> is <span class="math inline">\((m
\times n)\)</span>-dimensional then <span class="math inline">\(m \leq
n\)</span> must hold.</p>
<p>A pair <span class="math inline">\((a,b)\)</span> of (compatible)
polynomial matrices is called <em>left coprime</em> if the matrix <span class="math inline">\(c=[a,b]\)</span> is left prime. This case is
important for the structure of left matrix fraction descriptions.
Suppose <span class="math inline">\(c(z)=a^{-1} b(z)\)</span>, where
<span class="math inline">\(a\)</span> is a square, non singular
polynomial matrix. If the pair is <span class="math inline">\((a,b)\)</span> is <em>not</em> left coprime, then
we may cancel a common, non unimodular, factor and thus obtain a
“simpler” representation for <span class="math inline">\(c(z)\)</span>.</p>
<p>We discuss two strategies for testing whether a polynomial matrix is
left prime. The first approach uses a Hermite normal form (HNF) and the
second one tackles this problem via a (singular) pencil.</p>
<p>The approach via singular pencils is numerically stable and thus is
implemented in the function <code><a href="../reference/is.coprime.html">is.coprime()</a></code>. See also the
examples below.</p>
<p>First note that the problem is easy to tackle in the case that <span class="math inline">\(c\)</span> has degree zero. Here we just have to
check the left kernel of the coefficient matrix of <span class="math inline">\(z^0\)</span>. Also the case where <span class="math inline">\(c\)</span> is “tall”, i.e. the number of rows is
larger than the number of columns is trivial. In this case <span class="math inline">\(c\)</span> clearly cannot be left prime, since the
rank of <span class="math inline">\(c(z)\)</span> is smaller than the
number of rows for any <span class="math inline">\(z \in
\mathbb{C}\)</span>.</p>
<p>Therefore throughout this section, we assume that <span class="math inline">\(c\)</span> is an <span class="math inline">\((m
\times n)\)</span>-dimensional polynomial matrix with degree <span class="math inline">\(p &gt; 0\)</span> and <span class="math inline">\(m \leq n\)</span>.</p>
<div class="section level3">
<h3 id="hermite-normal-form">Hermite Normal Form<a class="anchor" aria-label="anchor" href="#hermite-normal-form"></a>
</h3>
<p>Consider the <em>row Hermite form</em> obtained from elementary
column operations <span class="math display">\[
c(z) = h(z) u(z) = h_1(z) u_1(z)
\]</span> where <span class="math inline">\(u\)</span> is an <span class="math inline">\((n \times n)\)</span>-dimensional unimodular
modular matrix, <span class="math inline">\(h\)</span> is an <span class="math inline">\((m \times n)\)</span>-dimensional lower (quasi)
triangular matrix.</p>
<p>The <span class="math inline">\((m \times m)\)</span>-dimensional
matrix <span class="math inline">\(h_1\)</span> is obtained from <span class="math inline">\(h\)</span> by selecting the first <span class="math inline">\(m\)</span> columns and <span class="math inline">\(u_1\)</span> consists of the first <span class="math inline">\(m\)</span> rows of <span class="math inline">\(u\)</span>. Note that <span class="math inline">\(h_1\)</span> is a square, lower triangular matrix,
where the diagonal elements are either monic or zero, and if a diagonal
element is non zero, then all elements to the left of this element have
a lower degree.</p>
<p>Furthermore note that the rank of <span class="math inline">\(c(z)\)</span> is equal to the rank of <span class="math inline">\(h_1(z)\)</span> for all <span class="math inline">\(z \in \mathbb{C}\)</span>. Therefore the rank of
<span class="math inline">\(c(z)\)</span> is less than <span class="math inline">\(m\)</span> if and only <span class="math inline">\(z\)</span> is a zero of the product of the
diagonal entries: <span class="math inline">\(h_{11} h_{22} \cdots
h_{mm}\)</span>. The following cases may occur</p>
<ol style="list-style-type: decimal">
<li>All diagonal elements <span class="math inline">\(h_{ii}\)</span>
are constant (and hence <span class="math inline">\(h_1 = I_m\)</span>
must hold). In this case <span class="math inline">\(\mbox{rk}(c(z))=m\)</span> for all <span class="math inline">\(z\in \mathbb{C}\)</span> and thus <span class="math inline">\(c\)</span> is <em>coprime</em>.</li>
<li>One of the diagonal elements is zero: In this case <span class="math inline">\(\mbox{rk}(c(z))&lt;m\)</span> holds for all <span class="math inline">\(z\in \mathbb{C}\)</span> and thus <span class="math inline">\(c\)</span> is <em>not coprime</em>.</li>
<li>The diagonal elements are non zero and at least one of them has a
degree larger than zero. In this case <span class="math inline">\(\mbox{rk}(c(z))=m\)</span> except for the zeroes
of the polynomial <span class="math inline">\((h_{11} h_{22} \cdots
h_{mm})\)</span>. Also in this case, <span class="math inline">\(c\)</span> is <em>not coprime</em>.</li>
</ol>
<p>Hence, the polynomial <span class="math inline">\(c\)</span> is left
prime if and only if <span class="math inline">\(h_1 = I_m\)</span>.</p>
</div>
<div class="section level3">
<h3 id="generalized-pencils">Generalized Pencils<a class="anchor" aria-label="anchor" href="#generalized-pencils"></a>
</h3>
<p>As reference for generalized pencils, see</p>
<ul>
<li><span class="citation">[@Gantmacher1959, Chapter XII (in particular
§4 on page 35ff)]</span></li>
<li><span class="citation">[@Kailath80, page 393ff]</span></li>
<li><span class="citation">[@DemmelKagstroem1993]</span></li>
</ul>
<p>We first construct a <em>pencil</em> <span class="math inline">\(P(z)=(A-Bz)\)</span> such that for any <span class="math inline">\(z \in \mathbb{C}\)</span> the left kernel of <span class="math inline">\(c(z)\)</span> and of <span class="math inline">\(P(z)\)</span> have the same dimension. This means
that <span class="math inline">\(c\)</span> is left prime if and only if
<span class="math inline">\(P\)</span> is left prime. Furthermore the
zeroes of <span class="math inline">\(P\)</span> and of <span class="math inline">\(c\)</span> are the same.</p>
<p>The condition <span class="math display">\[
u c(z) = u (c_0 + c_1 z + \cdots + c_p z^p) = 0
\]</span> for <span class="math inline">\(z \in \mathbb{C}\)</span> and
<span class="math inline">\(u \in \mathbb{C}^{1 \times m}, u \neq
0\)</span> is equivalent to the condition that <span class="math display">\[
(v_1,v_2,\ldots,v_p)
\begin{pmatrix}
c_0 &amp; 0      &amp; \cdots  &amp; 0 \\
0   &amp; I_{n}      &amp; \cdots  &amp;  0 \\
0   &amp; \vdots &amp; \ddots  &amp;  \vdots \\
0   &amp; 0      &amp; \cdots  &amp; I_{n} \\
\end{pmatrix} =
(v_1,v_2,\ldots,v_p)
\begin{pmatrix}
-c_1    &amp; \cdots &amp; -c_{p-1} &amp; -c_p \\
I_{n}      &amp; \cdots &amp; 0       &amp; 0 \\
\vdots &amp; \ddots &amp; \vdots  &amp; \vdots \\
0      &amp; \cdots &amp; I_{n} &amp; 0
\end{pmatrix} z
\]</span> for <span class="math inline">\(v_1 \in \mathbb{C}^{1 \times
m}\)</span>, <span class="math inline">\(v_1 \neq 0\)</span> and <span class="math inline">\(v_j\in \mathbb{C}^{1\times n}\)</span> for <span class="math inline">\(i=2,\ldots ,p\)</span>. This follows immediately
be rewriting the above condition as <span class="math display">\[
\begin{array}{rcl}
v_2 z   &amp;=&amp; v_1 c_0 + v_1 c_1 z = v_1 (c_0 + c_1 z) \\
v_3 z^2 &amp;=&amp; (v_2 + v_1 c_2 z) z = v_1 (c_0 + c_1 z + c_2 z^2) \\
v_4 z^3 &amp;=&amp; (v_3 + v_1 c_3 z) z^2 = v_1 (c_0 + c_1 z + c_2 z^2 +
c_3 z^3) \\
&amp; \vdots &amp;  \\
v_p z^{p-1} &amp;=&amp; v_1 (c_0 + c_1 z + \cdots + c_{p-1} z^{p-1}) \\
-v_1 c_p z^p &amp;=&amp; v_p z^{p-1}
\end{array}
\]</span> see also <span class="citation">@Kailath80</span>, page 393ff.
Combining the last two equations gives <span class="math display">\[
0 = v_pz^{p-1} + v_1 c_p z^p = v_1 (c_0 + c_1 z + \cdots + c_{p} z^{p}).
\]</span></p>
<p>Therefore the matrix <span class="math inline">\(c(z)\)</span> has a
non trivial left kernel if and only if the pencil <span class="math inline">\(P(z) = (A - Bz)\)</span>,<br><span class="math display">\[
A = \begin{pmatrix}
c_0 &amp; 0      &amp; \cdots  &amp; 0 \\
0   &amp; I_{n}      &amp; \cdots  &amp;  0 \\
0   &amp; \vdots &amp; \ddots  &amp;  \vdots \\
0   &amp; 0      &amp; \cdots  &amp; I_{n} \\
\end{pmatrix}, \quad
B = \begin{pmatrix}
-c_1    &amp; \cdots &amp; -c_{p-1} &amp; -c_p \\
I_{n}      &amp; \cdots &amp; 0       &amp; 0 \\
\vdots &amp; \ddots &amp; \vdots  &amp; \vdots \\
0      &amp; \cdots &amp; I_{n} &amp; 0
\end{pmatrix},
\]</span> has a non trivial left kernel. This implies <span class="math inline">\(c\)</span> is left prime if and only if <span class="math inline">\(P\)</span> is left prime.</p>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="staircase-form">Staircase Form<a class="anchor" aria-label="anchor" href="#staircase-form"></a>
</h4>
<p>In order to analyze the left kernel this pencil, we transform the
pencil (by multiplication with orthogonal matrices from the left and the
right) into a so called <em>staircase form</em>. To simplify notation we
set <span class="math inline">\(M=(m+n(p-1))\)</span> and <span class="math inline">\(N = np\)</span>, i.e. <span class="math inline">\((M,N)\)</span> now denotes the dimension of the
pencil <span class="math inline">\(P(z)\)</span>. Note that <span class="math inline">\(M-N = m-n \neq 0\)</span> in general, which means
that we have to deal with <em>non regular</em> pencils.</p>
<p>The procedure described below works for an arbitary pencil, i.e. we
do not impose the above special structure and we also consider the case
<span class="math inline">\(M&gt;N\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li><p>If the pencil <span class="math inline">\(P(z) = (A-Bz)\)</span>
is “tall”, i.e. <span class="math inline">\(M &gt; N\)</span>, then
<span class="math inline">\(P(z)\)</span> has a non trivial left kernel
for all <span class="math inline">\(z \in \mathbb{C}\)</span>.<br>
In this case <span class="math inline">\(P\)</span> (and the matrix
<span class="math inline">\(c\)</span>) is <em>not</em> left
prime.</p></li>
<li><p>If the pencil <span class="math inline">\(P(z)=(A-Bz)\)</span> is
square, i.e. <span class="math inline">\(M=N\)</span>, and <span class="math inline">\(B\)</span> is non singular, then the zeroes of the
pencil <span class="math inline">\(P(z)\)</span> (and the zeroes of
<span class="math inline">\(c(z)\)</span>) are the eigenvalues of the
matrix <span class="math inline">\(AB^{-1}\)</span>.<br>
In this case <span class="math inline">\(P\)</span> (and the matrix
<span class="math inline">\(c\)</span>) is <em>not</em> left
prime.</p></li>
</ol>
<p>Now suppose that the <em>right kernel</em> of <span class="math inline">\(B\)</span> is <span class="math inline">\(N_1 &gt;
0\)</span> dimensional. If <span class="math inline">\(N_1 = N\)</span>,
i.e. if <span class="math inline">\(B=0\)</span>, then two cases may
occur:</p>
<ol start="3" style="list-style-type: lower-alpha">
<li>The matrix <span class="math inline">\(A\)</span> has full row
rank.<br>
In this case the pencil <span class="math inline">\(P\)</span> (and the
matrix <span class="math inline">\(c\)</span>) is left prime.</li>
<li>The matrix <span class="math inline">\(A\)</span> does not have full
row rank and hence <span class="math inline">\(P(z)\)</span> has a non
trivial left kernel for all <span class="math inline">\(z \in
\mathbb{C}\)</span>.<br>
In this case <span class="math inline">\(P\)</span> (and the matrix
<span class="math inline">\(c\)</span>) is <em>not</em> left prime.</li>
</ol>
<p>Finally suppose that <span class="math inline">\(0 &lt; N_1
&lt;N\)</span> holds and let <span class="math inline">\(0 \leq M_1 \leq
N_1\)</span> denote the rank of the first <span class="math inline">\(N_1\)</span> columns of <span class="math inline">\(AV\)</span>. Then there exists an orthogonal
transformation, <span class="math inline">\(U\)</span> say, such that
the first <span class="math inline">\(M_1\)</span> rows of the first
<span class="math inline">\(N_1\)</span> columns of <span class="math inline">\(U'AV\)</span> have full rank <span class="math inline">\(M_1\)</span> and the remaining rows are zero.</p>
<p>Using the same symbols for the transformed pencil we get <span class="math display">\[
P (z) =
\begin{pmatrix}
A_{11} &amp; A_{12} \\
0_{(M-M_1) \times N_1} &amp; A_{22}
\end{pmatrix}
-
\begin{pmatrix}
0_{M_1\times N_1} &amp; B_{12} \\
0_{(M-M_1) \times N_1} &amp; B_{22}
\end{pmatrix}z,\quad A_{11} \in \mathbb{R}^{M_1 \times N_1}.
\]</span> Clearly <span class="math inline">\(P(z)\)</span> has full row
rank if and only if the <em>reduced</em> pencil <span class="math inline">\((A_{22} - B_{22} z)\)</span> has full row
rank.</p>
<p>Now we iterate this procedure with the reduced pencil <span class="math inline">\((A_{22} - B_{22}z)\)</span> until we end up with
the following staircase form of the pencil: <span class="math display">\[
P (z) =
\begin{pmatrix}
A_{11}                 &amp; \cdots &amp; A_{1,k-1}              &amp;
A_{1k} \\
\vdots                 &amp; \ddots &amp; \vdots                 &amp;
\vdots  \\
0_{M_{k-1} \times N_1} &amp; \cdots &amp; A_{k-1,k-1}            &amp;
A_{k-1, k}\\
0_{M_k \times N_1}     &amp; \cdots &amp; 0_{M_k \times N_{k-1}} &amp;
A_{kk}  \\
\end{pmatrix}
-
\begin{pmatrix}
0_{M_1 \times N_1}     &amp; \cdots &amp;
B_{1,k-1}                   &amp; B_{1,k} \\
\vdots                 &amp; \ddots
&amp;  \vdots                     &amp; \vdots   \\
0_{M_{k-1} \times N_1} &amp; \cdots &amp; 0_{M_{k-1} \times
N_{k-1}}  &amp; B_{k-1,k} \\
0_{M_k \times N_1}     &amp; \cdots &amp; 0_{M_k \times
N_{k-1}}      &amp; B_{kk} \\
\end{pmatrix} z
\]</span> The diagonal blocks are of dimension <span class="math inline">\((M_i\times N_i)\)</span>. The first <span class="math inline">\((k-1)\)</span> diagonal blocks of <span class="math inline">\(A\)</span> have full row rank (and hence <span class="math inline">\(0\leq M_i \leq N_i\)</span>) and the first <span class="math inline">\((k-1)\)</span> diagonal block of <span class="math inline">\(B\)</span> are zero. Therefore <span class="math inline">\(P(z)\)</span> has full row rank if and only if the
last block <span class="math inline">\((A_{kk} - B_{kk}z)\)</span> has
full row rank. For this last block the following cases may occur:</p>
<ol style="list-style-type: lower-alpha">
<li>If <span class="math inline">\((A_{kk} - B_{kk})\)</span> is “tall”
(<span class="math inline">\(M_k &gt; N_k\)</span>), then <span class="math inline">\(P(z)\)</span> has a non trivial left kernel for
all <span class="math inline">\(z \in \mathbb{C}\)</span>.<br>
In this case <span class="math inline">\(P\)</span> (and the matrix
<span class="math inline">\(c\)</span>) is <em>not</em> left prime.</li>
<li>If the pencil <span class="math inline">\((A_{kk} - B_{kk})\)</span>
is square (<span class="math inline">\(M_k=N_k\)</span>) and <span class="math inline">\(B_{kk}\)</span> is non singular, then the zeroes
of the pencil <span class="math inline">\(P(z)\)</span> (and the zeroes
of <span class="math inline">\(c(z)\)</span>) are the eigenvalues of the
matrix <span class="math inline">\(A_{kk}B_{kk}^{-1}\)</span>.<br>
In this case <span class="math inline">\(P\)</span> (and the matrix
<span class="math inline">\(c\)</span>) is <em>not</em> left prime.</li>
<li>If <span class="math inline">\(B_{kk}\)</span> is zero and the
matrix <span class="math inline">\(A\)</span> has full row rank, then
<span class="math inline">\(P(z)\)</span> has full row rank for all
<span class="math inline">\(z\in \mathbb{C}\)</span>.<br>
In this case the pencil <span class="math inline">\(P\)</span> (and the
matrix <span class="math inline">\(c\)</span>) is left prime.</li>
<li>If <span class="math inline">\(B_{kk}\)</span> is zero and the
matrix <span class="math inline">\(A\)</span> does not have full row
rank, then <span class="math inline">\(P(z)\)</span> has a non trivial
left kernel for all <span class="math inline">\(z \in
\mathbb{C}\)</span>.<br>
In this case <span class="math inline">\(P\)</span> (and the matrix
<span class="math inline">\(c\)</span>) is <em>not</em> left prime.</li>
</ol>
<p>The function <code><a href="../reference/is.coprime.html">is.coprime()</a></code> uses this approach to test
wether a polynomial is left prime (or a pair of polynomials is left
coprime). In the default case the function just returns a boolean
variable. However, if the optional argument <code>only.answer</code> is
set to <code>FALSE</code>, then a list is returned which contains the
above described staircase form. The list contains the following
slots:</p>
<p><code>answer</code> is <code>TRUE</code>, if the polynomial is prime
(the pair is left coprime).<br><code>A</code>,<code>B</code> hold the two matrices <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> (in staircase form).<br><code>m</code>,<code>n</code> are two integer vectors which contain the
size of the blocks <span class="math inline">\((M_i)\)</span> and <span class="math inline">\((N_i)\)</span> respectively.<br><code>zeroes</code> is a vector which contains the zeroes of the pencil
(the polynomial <span class="math inline">\(c\)</span>). In the
(co-)prime case this vector is empty and if <span class="math inline">\(P\)</span> is rank deficient for all <span class="math inline">\(z \in \mathbb{C}\)</span> then
<code>zeroes = NA_real_</code>.</p>
</div>
</div>
<div class="section level3">
<h3 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h3>
<p>We present three examples pertaining to the three different
outcomes:</p>
<ul>
<li>coprime polynomial matrices <span class="math inline">\(a(z)\)</span> and <span class="math inline">\(b(z)\)</span>
</li>
<li>non-coprime polynomial matrices with a finite number of common
zeros</li>
<li>non-coprime polynomial matrices with reduced rank for all <span class="math inline">\(z\in\mathbb{C}\)</span>
</li>
</ul>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="coprime-polynomials">Coprime Polynomials<a class="anchor" aria-label="anchor" href="#coprime-polynomials"></a>
</h4>
<p>Two “generic” polynomials are coprime.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate a random (m x m), and a random (m x n) polynomial matrix, with degree p=2</span></span>
<span><span class="va">m</span> <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1803</span><span class="op">)</span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="../reference/test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">m</span>,<span class="va">m</span><span class="op">)</span>, degree <span class="op">=</span> <span class="fl">2</span>, digits <span class="op">=</span> <span class="fl">1</span>, random <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">=</span> <span class="fu"><a href="../reference/test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">m</span>,<span class="va">n</span><span class="op">)</span>, degree <span class="op">=</span> <span class="fl">2</span>, digits <span class="op">=</span> <span class="fl">1</span>, random <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="section level5 unnumbered">
<h5 class="unnumbered" id="hermite-form">Hermite Form<a class="anchor" aria-label="anchor" href="#hermite-form"></a>
</h5>
<p>The Hermite form of <span class="math inline">\(\left( a(z),
b(z)\right)\)</span> is</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HNF</span> <span class="op">=</span> <span class="fu"><a href="../reference/hnf.html">hnf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span><span class="op">)</span>, from_left <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">HNF</span><span class="op">$</span><span class="va">h</span>, digits <span class="op">=</span> <span class="fl">2</span>, format <span class="op">=</span> <span class="st">'character'</span><span class="op">)</span></span>
<span><span class="co">#&gt; ( 2 x 5 ) matrix polynomial with degree &lt;= 0 </span></span>
<span><span class="co">#&gt;       [,1]  [,2]  [,3]  [,4]  [,5]</span></span>
<span><span class="co">#&gt; [1,]     1     0     0     0     0</span></span>
<span><span class="co">#&gt; [2,]     0     1     0     0     0</span></span></code></pre></div>
<p>The square submatrix <span class="math inline">\(h_1\)</span> of the
Hermite form <span class="math inline">\(h\)</span> is equal to the
identity matrix, hence <span class="math inline">\((a,b)\)</span> are
left coprime.</p>
</div>
<div class="section level5 unnumbered">
<h5 class="unnumbered" id="pencil">Pencil<a class="anchor" aria-label="anchor" href="#pencil"></a>
</h5>
<p>The method using the pencil gives the same answer:</p>
<ul>
<li>There are no common zeros.</li>
<li>The polynomial matrices are left coprime.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">=</span> <span class="fu"><a href="../reference/is.coprime.html">is.coprime</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, debug <span class="op">=</span> <span class="cn">FALSE</span>, only.answer <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"The polynomials are left coprime: "</span>, <span class="va">out</span><span class="op">$</span><span class="va">answer</span>,<span class="st">"\n"</span>, </span>
<span>    <span class="st">"The zeros of the pencil are: "</span>, <span class="va">out</span><span class="op">$</span><span class="va">zeroes</span>, sep <span class="op">=</span> <span class="st">''</span><span class="op">)</span></span>
<span><span class="co">#&gt; The polynomials are left coprime: TRUE</span></span>
<span><span class="co">#&gt; The zeros of the pencil are:</span></span></code></pre></div>
</div>
</div>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="not-coprime-finite-number-of-zeros">Not coprime: Finite Number of Zeros<a class="anchor" aria-label="anchor" href="#not-coprime-finite-number-of-zeros"></a>
</h4>
<p>Here we consider an example where <span class="math inline">\(c(z)=
[a(z),b(z)]\)</span> is rank deficient for some (but not all) <span class="math inline">\(z\in \mathbb{C}\)</span>. We generate these
polynomials by multiplying them with a common (matrix) factor. We show
that (at least) one singular value of <span class="math inline">\(c(z)\)</span> evaluated at the zeros of the common
factor is zero.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a0</span> <span class="op">=</span> <span class="va">a</span></span>
<span><span class="va">b0</span> <span class="op">=</span> <span class="va">b</span></span>
<span></span>
<span><span class="co"># Generate random common factor  with degree 1</span></span>
<span><span class="va">r</span> <span class="op">=</span> <span class="fu"><a href="../reference/test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">m</span>,<span class="va">m</span><span class="op">)</span>, degree <span class="op">=</span> <span class="fl">1</span>, digits <span class="op">=</span> <span class="fl">1</span>, random <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate polynomials with a common factor</span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="va">r</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="va">a0</span></span>
<span><span class="va">b</span> <span class="op">=</span> <span class="va">r</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="va">b0</span></span>
<span><span class="va">c</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span><span class="op">)</span></span>
<span></span>
<span><span class="va">z_r</span> <span class="op">=</span> <span class="fu"><a href="../reference/poles_and_zeroes.html">zeroes</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"The zeros of the common factor r(z) are: \n"</span>, <span class="va">z_r</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; The zeros of the common factor r(z) are: </span></span>
<span><span class="co">#&gt;  -0.2051932 5.377607</span></span>
<span></span>
<span><span class="va">d</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span><span class="fu"><a href="../reference/zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">c</span>, z <span class="op">=</span> <span class="va">z_r</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">d</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"minimal singular value of c(z_0): "</span>, <span class="va">d</span><span class="op">[</span><span class="va">m</span><span class="op">]</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="co">#&gt; minimal singular value of c(z_0): 1.007532e-16</span></span></code></pre></div>
<div class="section level5 unnumbered">
<h5 class="unnumbered" id="hermite-form-1">Hermite Form<a class="anchor" aria-label="anchor" href="#hermite-form-1"></a>
</h5>
<p>The Hermite Form of <span class="math inline">\(c(z) = (a(z),
b(z))\)</span> is</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HNF</span> <span class="op">=</span> <span class="fu"><a href="../reference/hnf.html">hnf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span><span class="op">)</span>, from_left <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">HNF</span><span class="op">$</span><span class="va">h</span>, digits <span class="op">=</span> <span class="fl">2</span>, format <span class="op">=</span> <span class="st">'character'</span><span class="op">)</span></span>
<span><span class="co">#&gt; ( 2 x 5 ) matrix polynomial with degree &lt;= 2 </span></span>
<span><span class="co">#&gt;               [,1]                [,2]  [,3]  [,4]  [,5]</span></span>
<span><span class="co">#&gt; [1,]             1                   0     0     0     0</span></span>
<span><span class="co">#&gt; [2,]  2.49 - 0.39z  -1.1 - 5.17z + z^2     0     0     0</span></span></code></pre></div>
<p>We calculate the zeros of <span class="math inline">\(c(z)=
[a(z),b(z)]\)</span> by calculating the zeros of the diagonal elements
of the square submatrix <span class="math inline">\(h_1(z)\)</span>.
Note that for this example the <span class="math inline">\((1,1)\)</span> element is equal to <span class="math inline">\(1\)</span>.</p>
<p>The (common) zeros are therefore</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/poles_and_zeroes.html">zeroes</a></span><span class="op">(</span><span class="va">HNF</span><span class="op">$</span><span class="va">h</span><span class="op">[</span><span class="va">m</span>,<span class="va">m</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.2051932  5.3776070</span></span></code></pre></div>
<p>Note that these zeroes are identical to the zeroes of the common
factor <span class="math inline">\(r(z)\)</span>.</p>
</div>
<div class="section level5 unnumbered">
<h5 class="unnumbered" id="pencil-1">Pencil<a class="anchor" aria-label="anchor" href="#pencil-1"></a>
</h5>
<p>The outcome for the pencil is the same as above.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">=</span> <span class="fu"><a href="../reference/is.coprime.html">is.coprime</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, debug <span class="op">=</span> <span class="cn">FALSE</span>, only.answer <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"The polynomials are left coprime: "</span>, <span class="va">out</span><span class="op">$</span><span class="va">answer</span>,<span class="st">"\n"</span>, </span>
<span>    <span class="st">"The zeros of the pencil are: "</span>, <span class="va">out</span><span class="op">$</span><span class="va">zeroes</span>, sep <span class="op">=</span> <span class="st">''</span><span class="op">)</span></span>
<span><span class="co">#&gt; The polynomials are left coprime: FALSE</span></span>
<span><span class="co">#&gt; The zeros of the pencil are: 5.377607-0.2051932</span></span></code></pre></div>
</div>
</div>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="not-coprime-everywhere-rank-deficient">Not coprime: Everywhere Rank Deficient<a class="anchor" aria-label="anchor" href="#not-coprime-everywhere-rank-deficient"></a>
</h4>
<p>Finally let us consider the case, where <span class="math inline">\(c(z) = (a(z),b(z))\)</span> is rank deficient for
all <span class="math inline">\(z\)</span>. We generate a pair of
polynomial matrices of this kind by multiplying the two polynomials
<span class="math inline">\(a(z), b(z)\)</span> (from left) with a
singular common factor.</p>
<p>To verify that <span class="math inline">\(c(z)\)</span> is of
reduced row rank for all <span class="math inline">\(z\in\mathbb{C}\)</span>, we print the singular
values of <span class="math inline">\(c(z)\)</span> at a randomly
selected point.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate a square polynomial matrix with rank one!</span></span>
<span><span class="va">r</span> <span class="op">=</span> <span class="fu"><a href="../reference/test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">m</span>,<span class="fl">1</span><span class="op">)</span>, degree <span class="op">=</span> <span class="fl">1</span>, digits <span class="op">=</span> <span class="fl">1</span>, random <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> </span>
<span>    <span class="fu"><a href="../reference/test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">m</span><span class="op">)</span>, degree <span class="op">=</span> <span class="fl">1</span>, digits <span class="op">=</span> <span class="fl">1</span>, random <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">r</span>, format <span class="op">=</span> <span class="st">'c'</span><span class="op">)</span></span>
<span><span class="co">#&gt; ( 2 x 2 ) matrix polynomial with degree &lt;= 2 </span></span>
<span><span class="co">#&gt;                         [,1]                     [,2]</span></span>
<span><span class="co">#&gt; [1,]   1.36 - 1.43z - 2.1z^2  -0.72 + 2.07z - 1.35z^2</span></span>
<span><span class="co">#&gt; [2,]  1.53 + 3.47z + 1.82z^2  -0.81 - 0.36z + 1.17z^2</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="va">r</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="va">a0</span></span>
<span><span class="va">b</span> <span class="op">=</span> <span class="va">r</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="va">b0</span></span>
<span></span>
<span><span class="co"># Evaluate c(z) = (a(z),b(z)) at a random point z0 and print the corresponding singular values</span></span>
<span><span class="va">z0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">complex</a></span><span class="op">(</span>real <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, imaginary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span><span class="fu"><a href="../reference/zvalues.html">zvalues</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span><span class="op">)</span>, z <span class="op">=</span> <span class="va">z0</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span>, nu <span class="op">=</span> <span class="fl">0</span>, nv <span class="op">=</span> <span class="fl">0</span> <span class="op">)</span><span class="op">$</span><span class="va">d</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"The singular values of c(z) \n evaluated at z0 = "</span>, <span class="va">z0</span>, <span class="st">"\n are: "</span>, <span class="va">d</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; The singular values of c(z) </span></span>
<span><span class="co">#&gt;  evaluated at z0 =  0.3368112-0.2077692i </span></span>
<span><span class="co">#&gt;  are:  8.087889 6.256749e-16</span></span></code></pre></div>
<div class="section level5 unnumbered">
<h5 class="unnumbered" id="hermite-form-2">Hermite Form<a class="anchor" aria-label="anchor" href="#hermite-form-2"></a>
</h5>
<p>The Hermite Form of <span class="math inline">\(c(z) = (a(z),
b(z))\)</span> is</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HNF</span> <span class="op">=</span> <span class="fu"><a href="../reference/hnf.html">hnf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span><span class="op">)</span>, from_left <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">HNF</span><span class="op">$</span><span class="va">h</span>, digits <span class="op">=</span> <span class="fl">1</span>, format <span class="op">=</span> <span class="st">'char'</span><span class="op">)</span></span>
<span><span class="co">#&gt; ( 2 x 5 ) matrix polynomial with degree &lt;= 1 </span></span>
<span><span class="co">#&gt;              [,1]  [,2]  [,3]  [,4]  [,5]</span></span>
<span><span class="co">#&gt; [1,]     -0.5 + z     0     0     0     0</span></span>
<span><span class="co">#&gt; [2,]  -0.6 - 0.9z     0     0     0     0</span></span></code></pre></div>
<p>The matrix <span class="math inline">\(c(z)\)</span> is rank
deficient (for all <span class="math inline">\(z\)</span>) since <span class="math inline">\(h[2,2] = 0\)</span>! The procedure
<code>hnf</code> returns also an estimate of the rank of <span class="math inline">\(c(z)\)</span> (when <span class="math inline">\(c(z)\)</span> is considered as rational matrix).
Here we get</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">HNF</span><span class="op">$</span><span class="va">rank</span>,<span class="st">'\n'</span><span class="op">)</span></span>
<span><span class="co">#&gt; 1</span></span></code></pre></div>
<p>which again means that <span class="math inline">\(c(z)\)</span> is
rank deficient for all <span class="math inline">\(z \in
\mathbb{C}\)</span>.</p>
</div>
<div class="section level5 unnumbered">
<h5 class="unnumbered" id="pencil-2">Pencil<a class="anchor" aria-label="anchor" href="#pencil-2"></a>
</h5>
<p>The result for pencils is the same.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">=</span> <span class="fu"><a href="../reference/is.coprime.html">is.coprime</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, debug <span class="op">=</span> <span class="cn">FALSE</span>, only.answer <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"The polynomials are left coprime: "</span>, <span class="va">out</span><span class="op">$</span><span class="va">answer</span>,<span class="st">"\n"</span>, </span>
<span>    <span class="st">"The zeros of the pencil are: "</span>, <span class="va">out</span><span class="op">$</span><span class="va">zeroes</span>, sep <span class="op">=</span> <span class="st">''</span><span class="op">)</span></span>
<span><span class="co">#&gt; The polynomials are left coprime: FALSE</span></span>
<span><span class="co">#&gt; The zeros of the pencil are: NA</span></span></code></pre></div>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="column-reduced-matrix">Column Reduced Matrix<a class="anchor" aria-label="anchor" href="#column-reduced-matrix"></a>
</h2>
<p><strong>Note:</strong> The functions <code>degree</code>
(<code>col_end_matrix</code>) and <code>col_reduce</code> use different
strategies to compute the column degrees (column end matrix).</p>
<ul>
<li>The first two consider the elements, whereas</li>
<li>
<code>col_reduce</code> considers the euclidean norm of the
respective columns.</li>
</ul>
<p>Let <span class="math inline">\(a(z) = a^0 + a^1 z + \cdots + a^p
z^p\)</span>, <span class="math inline">\(a^k = (a^k_{ij})\)</span> and
<span class="math inline">\(a^k_j=(a^k_{1j}, \ldots,
a^k_{mj})'\)</span>. The function <code>degree</code> sets the
degree of the <span class="math inline">\(j\)</span>-th column to <span class="math inline">\(p_j\)</span> iff <span class="math inline">\(a^{p_j}_{ij} &gt; \tau\)</span> for at least one
<span class="math inline">\(i\)</span> and <span class="math inline">\(a^{k}_{ij} \leq \tau\)</span> for all <span class="math inline">\(i\)</span> and <span class="math inline">\(k&gt;p_j\)</span>. The column end matrix is
constructed correspondingly. The function <code>col_reduce</code> sets
the degree of the <span class="math inline">\(j\)</span>-th column to
<span class="math inline">\(p_j\)</span> iff <span class="math inline">\(\|a^{p_j}_{j}\| &gt; \tau\)</span> and <span class="math inline">\(\|a^{k}_{j}\| \leq \tau\)</span> for all <span class="math inline">\(k&gt;p_j\)</span>.</p>
<p>Therefore one may get different results!</p>
<p>The basic strategy to construct a column reduced matrix (for the case
that <span class="math inline">\(a(z)\)</span> is square and non
singular) is as follows. First permute the columns of <span class="math inline">\(a(z)\)</span> such that the column degrees <span class="math inline">\(p_1 \leq p_2 \leq \cdots \leq p_m\)</span> are
ordered. Now suppose that the <span class="math inline">\(k\)</span>-th
column, <span class="math inline">\(c_k\)</span> say, of the column end
matrix is linearly dependent from the previous columns (<span class="math inline">\(c_j\)</span>, <span class="math inline">\(1\leq j
&lt; k\)</span>), i.e. <span class="math inline">\(c_k = \alpha_1 c_1 +
\cdots \alpha_{k-1} c_{k-1}\)</span>. Then we substract from the <span class="math inline">\(k\)</span>-th column of <span class="math inline">\(a(z)\)</span>, <span class="math inline">\(z^{p_k-p_j}\alpha_j\)</span> times the <span class="math inline">\(j\)</span>-th column. This operation reduces the
degree of the <span class="math inline">\(k\)</span>-th column by
one.</p>
<p>This procedure is repeated until the column end matrix is
regular.</p>
<p>See also <span class="citation">@Wolovich1974</span>.</p>
<p>The coefficients <span class="math inline">\(\alpha_j\)</span> are
determined from an SVD of the column end matrix.</p>
</div>
<div class="section level2">
<h2 id="realization-algorithms">Realization Algorithms<a class="anchor" aria-label="anchor" href="#realization-algorithms"></a>
</h2>
<div class="section level3">
<h3 id="impulse-response">Impulse Response<a class="anchor" aria-label="anchor" href="#impulse-response"></a>
</h3>
<p>One of the main features of the rational functions is that the Hankel
matrix of the impulse response coefficients has finite rank:</p>
<p><span class="math display">\[
H = \begin{pmatrix}
k_1 &amp; k_2 &amp; \cdots \\
k_2 &amp; k_3 &amp; \cdots \\
\vdots &amp; \vdots &amp;
\end{pmatrix}
\]</span> Note that the impulse response function is only well defined
if the rational matrix has no pole at <span class="math inline">\(z=0\)</span>.</p>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="lmfd">LMFD<a class="anchor" aria-label="anchor" href="#lmfd"></a>
</h4>
<p>We consider a <span class="math inline">\((m,n)\)</span>-dimensional
rational matrix in LMFD form <span class="math display">\[
k(z) = a^{-1}(z) b(z) = k_0 + k_1 z + k_2 z^2 + \cdots
\]</span> where <span class="math inline">\(a(z)=a_0 + a_1 z + \cdots +
a_p z^p\)</span> and <span class="math inline">\(b(z)=b_0 + b_1 z
+\cdots + b_p z^p\)</span>. W.l.o.g we set <span class="math inline">\(p=q\)</span>. This implies <span class="math display">\[
\begin{array}{rcl}
a(z)(k(z) - k_0) &amp;=&amp; b(z) - a(z)k_0 \\
(a_0 + a_1 z + \cdots + a_p z^p)(k_1 z + k_2 z + \cdots ) &amp;=&amp;
(b_0-a_0k_0) + (b_1-a_1 k_0) z + \cdots + (b_p-a_p k_0) z^p
\end{array}
\]</span> and thus <span class="math display">\[
\sum_{i=0}^p a_{p-i} k_{j+i} = 0 \mbox{ for } j\geq 1.
\]</span> By the above identity it follows that the Hankel matrix <span class="math inline">\(H\)</span> has finite rank and that the
coefficients of the polynomial <span class="math inline">\(a(z)\)</span>
are closely related to the left kernel of <span class="math inline">\(H\)</span>. In the following we discuss, how to
construct a unique LMFD of the rational matrix <span class="math inline">\(k()\)</span> via the above identity.</p>
<p>In order to describe the linear dependence structure of the rows of
<span class="math inline">\(H\)</span> it is convenient to use a
“double” index for the rows: Let <span class="math inline">\(h(i,j)\in
\mathbb{R}^{1\times \infty}\)</span> denote the <span class="math inline">\(j\)</span>-th row in the <span class="math inline">\(i\)</span>-th block row of <span class="math inline">\(H\)</span>, i.e. <span class="math inline">\(h(i,j)\)</span> is the <span class="math inline">\(((i-1)m+j)\)</span>-th row of <span class="math inline">\(H\)</span>.</p>
<p>A selection <span class="math inline">\(\mathcal{S}=\{(i_k,j_k) \,|\,
k=1,\ldots ,s\}\)</span> of rows of the Hankel matrix is called a
<em>nice</em> selection, if there are no “holes” in the sense that <span class="math inline">\((i,j)\in \mathcal{S}\)</span>, <span class="math inline">\(i&gt;1\)</span> implies that <span class="math inline">\((i-1,j)\in \mathcal{S}\)</span>. Nice selections
may be described by a multi-index <span class="math inline">\(\nu =
(\nu_1, \ldots ,\nu_m)\)</span>, where <span class="math inline">\(\nu_j=\max \{i\,|\,(i,j)\in
\mathcal{S}\}\)</span>.</p>
<p>Suppose that <span class="math inline">\(H\)</span> has rank <span class="math inline">\(s\)</span>. In general there are many different
selections of rows of <span class="math inline">\(H\)</span> which form
a basis for the row space of <span class="math inline">\(H\)</span>. In
the following we choose the <em>first</em> <span class="math inline">\(s\)</span> rows of <span class="math inline">\(H\)</span> which form a basis of the row space and
denote the corresponding selection with <span class="math inline">\(\mathcal{S}=\{(i_k,j_k) \,|\, k=1,\ldots
,s\}\)</span>. Due to the Hankel structure of <span class="math inline">\(H\)</span> this is a nice selection in the above
sense. The corresponding <span class="math inline">\(\nu_j\)</span>’s
are called <em>Kronecker indices</em> of the Hankel matrix (respectively
of the rational matrix <span class="math inline">\(k(\cdot)\)</span>).
Note that the sum of the Kronecker indices is equal to the rank of <span class="math inline">\(H\)</span>: <span class="math inline">\(\sum_{j=1}^m \nu _j = s\)</span>.</p>
<p>The row <span class="math inline">\(h(\nu_j+1,j)\)</span> is linearly
dependent on the previous (basis) rows and therefore <span class="math display">\[
h(\nu_j+1,j) + \sum_{\substack{(\nu_j+1-i,l) \in \mathcal{S} \\
(\nu_j+1-i,l) &lt; (\nu_j+1,j)}} a_{i,jl} h(\nu_j+1-i,l) = 0
\]</span> holds for suitably chosen coefficients <span class="math inline">\(a_{i,jl}\)</span>. The sum runs over all basis
rows previous to the row <span class="math inline">\(h(\nu_j+1,j)\)</span>, i.e. the notation <span class="math inline">\((k,l) &lt; (i,j)\)</span> means (<span class="math inline">\(k &lt; i\)</span>) or (<span class="math inline">\(k=i\)</span> and <span class="math inline">\(l&lt;j)\)</span>). This equation now (uniquely)
defines a polynomial matrix <span class="math inline">\(a(z) = a_0 + a_1
z + \cdots + a_p z^p\)</span>, with <span class="math inline">\(p=\max_j{\nu_j}\)</span>.<br>
Let <span class="math inline">\(a_{i,jl}\)</span> denote the <span class="math inline">\((jl)\)</span>-th entry of the matrix <span class="math inline">\(a_i\)</span>. The entries <span class="math inline">\(a_{i,jl}\)</span>, for <span class="math inline">\((\nu_j+1-i,l) \in \mathcal{S}\)</span> and <span class="math inline">\((\nu_j+1-i,l) &lt; (\nu_j+1,j)\)</span> are read
off from the above equation, <span class="math inline">\(a_{0,jj}\)</span> is set to one (<span class="math inline">\(a_{0,jj}=1\)</span>) and all other entries are set
to zero.</p>
<p>By construction <span class="math inline">\(a(z)(k(z)-k_0)\)</span>
is a polynomial (with degree less than or equal to <span class="math inline">\(p=\max_j\nu_j\)</span>). In the last step we set
<span class="math display">\[
b(z) = a(z)(k(z)-k_0) + a(z)k_0.
\]</span></p>
<p>By the above construction one gets a unique LMFD representation of
the rational matrix <span class="math inline">\(k(z)\)</span> with the
following properties:</p>
<ul>
<li>
<span class="math inline">\(a_0\)</span> is a lower triangular
matrix with ones on the diagonal.</li>
<li>
<span class="math inline">\(b_0 = a_0 k_0\)</span>. In particular
for a square rational matrix with <span class="math inline">\(k_0=I_m\)</span> we have <span class="math inline">\(b_0=a_0\)</span>.</li>
<li>the row degrees of <span class="math inline">\((a(z),b(z))\)</span>
are equal to <span class="math inline">\(\nu_1,\ldots,\nu_m\)</span>,<br>
</li>
<li>the elements <span class="math inline">\(a_{ij}(z)\)</span> are
divisible by <span class="math inline">\(z^{\nu_{ij}}\)</span>, where
<span class="math inline">\(\nu_{ij} = \max(\nu_i+1-\nu_j,1)\)</span>
for <span class="math inline">\(j&gt;i\)</span> and <span class="math inline">\(\nu_{ij} = \max(\nu_i+1-\nu_j,0)\)</span> for
<span class="math inline">\(j&lt;i\)</span>.</li>
<li>the pair <span class="math inline">\((a(z), b(z))\)</span> is left
coprime and row reduced.</li>
</ul>
<p>A pair <span class="math inline">\((a(z),b(z))\)</span> which
satisfied the above conditions is said to be in <em>echelon canonical
form</em>.</p>
</div>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="ho-kalman">Ho-Kalman<a class="anchor" aria-label="anchor" href="#ho-kalman"></a>
</h4>
<p>A quite analogous strategy may be used to construct a (unique) state
space realization of a rational matrix. Suppose that the Hankel matrix
<span class="math inline">\(H\)</span> has rank <span class="math inline">\(s\)</span> and that <span class="math inline">\(S\in \mathbb{R}^{s\times \infty}\)</span> is such
that <span class="math inline">\(SH\)</span> is a basis for the row
space of <span class="math inline">\(H\)</span>. Then a state space
representation of the rational matrix <span class="math inline">\(k(\cdot)\)</span> is obtained by a solving the
following equations <span class="math display">\[
\begin{array}{rcl}
SH_{-1,.} &amp;=&amp; A SH \\
H_{1,.} &amp;=&amp; C SH \\
SH_{.,1} &amp;=&amp; B \\
k_0 &amp;=&amp; D,
\end{array}
\]</span> where <span class="math display">\[
H_{-1,.} = \begin{pmatrix}
k_2 &amp; k_3 &amp; \cdots \\
k_3 &amp; k_4 &amp; \cdots \\
\vdots &amp; \vdots &amp;
\end{pmatrix}
\, \quad
H_{1,.} = \begin{pmatrix}
k_1 &amp; k_2 &amp; \cdots
\end{pmatrix}
\, \mbox{ and }
H_{,1} = \begin{pmatrix}
k_1 \\
k_2 \\
\vdots
\end{pmatrix}
\]</span></p>
<p>The obtained result clearly depends on the matrix <span class="math inline">\(S\)</span>, i.e. on the choice of the basis of the
row space of <span class="math inline">\(H\)</span>.</p>
<p>Two choices are implemented:</p>
<ul>
<li>echelon form: here <span class="math inline">\(S\)</span> is the
selection matrix which selects the first <span class="math inline">\(s\)</span> linearly independent rows of <span class="math inline">\(H\)</span>. The statespace realization obtained
then is in <em>echelon canonical form</em>.</li>
<li>balanced form: here <span class="math inline">\(S\)</span> is
obtained via an SVD decomposition of a finite dimensional sub matrix of
<span class="math inline">\(H\)</span>. For more details, see …</li>
</ul>
</div>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="notes">Notes:<a class="anchor" aria-label="anchor" href="#notes"></a>
</h4>
<p>The above constructions for a LMFD or statespace representations also
work for a finite dimensional sub matrix <span class="math display">\[
H_{fp} =
\begin{pmatrix}
k_1 &amp; k_2 &amp; \cdots &amp; k_p \\
k_2 &amp; k_3 &amp; \cdots &amp; k_{p+1}\\
\vdots &amp; \vdots &amp;  &amp; \vdots \\
k_f &amp; k_{f+1} &amp; \cdots &amp; k_{f+p-1}
\end{pmatrix}
\]</span> provided that <span class="math inline">\((f,p)\)</span> is
“large enough”.</p>
<p>For a more detailed discussion on Kronecker indices and echelon
canonical forms, see <span class="citation">@Hannan.Deistler12</span>.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="operations-withon-statespace-realizations">Operations with/on Statespace Realizations<a class="anchor" aria-label="anchor" href="#operations-withon-statespace-realizations"></a>
</h2>
<div class="section level3">
<h3 id="addition">Addition<a class="anchor" aria-label="anchor" href="#addition"></a>
</h3>
<p><span class="math display">\[
(C_1 (z^{-1} - A_1)^{-1} B_1 + D_1) +
(C_2 (z^{-1} - A_2)^{-1} B_2 + D_2)
\]</span></p>
<p><span class="math display">\[
\left[\begin{array}{@{}cc|c@{}}
A_1      &amp; 0   &amp; B_1   \\
0        &amp; A_2 &amp; B_2 \\  \hline
C_1      &amp; C_2 &amp; D_1 + D_2
\end{array}\right]
\]</span></p>
<p>See <code><a href="../reference/Ops.ratm.html">Ops.ratm()</a></code> in particular <code>a + b</code>.</p>
</div>
<div class="section level3">
<h3 id="multiplication">Multiplication<a class="anchor" aria-label="anchor" href="#multiplication"></a>
</h3>
<p><span class="math display">\[
(C_1 (z^{-1} - A_1)^{-1} B_1 + D_1) \cdot
(C_2 (z^{-1} - A_2)^{-1} B_2 + D_2)
\]</span></p>
<p><span class="math display">\[
\left[\begin{array}{@{}cc|c@{}}
A_1      &amp; B_1 C_2 &amp; B_1 D_2   \\
0        &amp; A_2     &amp; B_2 \\  \hline
C_1      &amp; D_1 C_2 &amp; D_1 D_2
\end{array}\right]
\]</span></p>
<p>See <code>a %r% b</code>.</p>
</div>
<div class="section level3">
<h3 id="inverse">Inverse<a class="anchor" aria-label="anchor" href="#inverse"></a>
</h3>
<p><span class="math display">\[
(C (z^{-1} - A)^{-1} B + D)^{-1}
\]</span></p>
<p><span class="math display">\[
\left[\begin{array}{@{}c|c@{}}
A - B D^{-1} C &amp; BD^{-1}   \\ \hline
-D^{-1}C       &amp; D^{-1}
\end{array}\right]
\]</span></p>
<p>See <code><a href="../reference/Ops.ratm.html">Ops.ratm()</a></code> in particular <code>x^{-1}</code>.</p>
</div>
<div class="section level3">
<h3 id="bind-by-columns-or-rows">Bind by columns or rows<a class="anchor" aria-label="anchor" href="#bind-by-columns-or-rows"></a>
</h3>
<p><span class="math display">\[
\begin{pmatrix}
C_1 (z^{-1} - A_1)^{-1} B_1 + D_1) &amp;
C_2 (z^{-1} - A_2)^{-1} B_2 + D_2)
\end{pmatrix}
\]</span></p>
<p><span class="math display">\[
\left[\begin{array}{@{}cc|cc@{}}
A_1      &amp; 0       &amp; B_1 &amp; 0   \\
0        &amp; A_2     &amp; 0   &amp; B_2 \\  \hline
C_1      &amp; C_2     &amp; D_1 &amp; D_2
\end{array}\right]
\]</span> See <code><a href="../reference/bind.html">cbind.ratm()</a></code>.</p>
<p><span class="math display">\[
\begin{pmatrix}
C_1 (z^{-1} - A_1)^{-1} B_1 + D_1 \\
C_2 (z^{-1} - A_2)^{-1} B_2 + D_2
\end{pmatrix}
\]</span></p>
<p><span class="math display">\[
\left[\begin{array}{@{}cc|c@{}}
A_1      &amp; 0       &amp; B_1 \\
0        &amp; A_2     &amp; B_2 \\  \hline
C_1      &amp; 0       &amp; D_1 \\
0        &amp; C_2     &amp; D_2
\end{array}\right]
\]</span> See <code><a href="../reference/bind.html">rbind.ratm()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="elementwise-multiplication">Elementwise Multiplication<a class="anchor" aria-label="anchor" href="#elementwise-multiplication"></a>
</h3>
<p>First consider the product of two <span class="math inline">\((m\times 1)\)</span> matrices, and write the
elementwise product as the product of a suitable diagonal matrix with
the second factor</p>
<p><span class="math display">\[
\left[\begin{array}{@{}cccc|c@{}}
A_1     &amp; \cdots  &amp; 0       &amp; B_1 C_{2,1}     &amp; B_1
D_{2,1}   \\
\vdots  &amp; \ddots  &amp; \vdots  &amp; \vdots          &amp;
\vdots        \\
0       &amp; \cdots  &amp; A_1     &amp; B_1 C_{2,m}     &amp; B_1
D_{2,m}   \\
0       &amp; \cdots  &amp; 0       &amp; A_2             &amp;
B_2           \\  \hline
C_{1,1} &amp; \cdots  &amp; 0       &amp; D_{1,1} C_{2,1} &amp; D_{1,1}
C_{2,1}  \\
\vdots  &amp; \ddots  &amp; \vdots  &amp; \vdots          &amp;
\vdots           \\
0       &amp; \cdots  &amp; C_{1,m} &amp; D_{1,m} C_{2,m} &amp; D_{1,m}
D_{2,m}  
\end{array}\right]
\]</span> where <span class="math inline">\(C_{i,k}\)</span> denotes the
<span class="math inline">\(k\)</span>-th row of <span class="math inline">\(C_i\)</span> and <span class="math inline">\(D_{i,k}\)</span> is the <span class="math inline">\(k\)</span>-entry of the <span class="math inline">\((m\times 1)\)</span>-dimensional matrix <span class="math inline">\(D_i\)</span>.</p>
<p>It can be shown (???) that the controllability matrix of the above
statespace model has rank at most <span class="math inline">\((s_1 +
s_2)\)</span>. Therefore we may construct an equivalent model with state
dimension <span class="math inline">\((s_1 + s_2)\)</span>.</p>
<p>Now we simply do this construction for all columns of the two factors
<span class="math inline">\(a(z)\)</span> and <span class="math inline">\(b(z)\)</span> and then “column-bind” the result.
The statespace realisation then has state dimension <span class="math inline">\(n(s_1+s_2)\)</span>.</p>
<p>For “wide” matrices (<span class="math inline">\(m&lt; n\)</span>) we
consider the transpose of the two factors. This gives statespace
realisations with <span class="math display">\[
s = \min(m,n)(s_1+s_2).
\]</span></p>
<ul>
<li>proof ???</li>
<li>kann man die <span class="math inline">\((s_1+s_2)\)</span>
Zustandsraum Darstellung direkt “hinschreiben”?</li>
</ul>
<p>See <code><a href="../reference/Ops.ratm.html">Ops.ratm()</a></code> in particular <code>a * b</code>.</p>
</div>
<div class="section level3">
<h3 id="transpose">Transpose<a class="anchor" aria-label="anchor" href="#transpose"></a>
</h3>
<p><span class="math display">\[
(C(z^{-1}I - A)^{-1} B + D)' = B'(z^{-1}I - A')^{-1} C +
D'
\]</span></p>
<p><span class="math display">\[
\left[\begin{array}{@{}c|c@{}}
A' &amp; C'  \\  \hline
B' &amp; D'
\end{array}\right]
\]</span></p>
<p>See <code><a href="https://rdrr.io/r/base/t.html" class="external-link">t()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="hermitean-transpose">Hermitean Transpose<a class="anchor" aria-label="anchor" href="#hermitean-transpose"></a>
</h3>
<p><span class="math display">\[
\begin{array}{rcl}
[C(z^{-1}I - A)^{-1} B + D]^* &amp;=&amp; B' (zI - A')^{-1}
C' + D' \\
&amp;=&amp; B' [(-A'z)(z^{-1}I -A^{-T})]^{-1}C' + D' \\
&amp;=&amp; B' [(-A^{-T}z^{-1})(zI + z^2A^{-T} + z^3A^{-2T} +
\cdots)]C' + D' \\
&amp;=&amp; (-A^{-1}B)' [zI + z^2A^{-T} + Z^3A^{-2T} +
\cdots)](CA^{-1})' + D' - B' A^{-T}C'\\
&amp;=&amp; (-A^{-1}B)' (z^{-1} I - A^{-T})^{-1}(CA^{-1})' +
(D' - B' A^{-T}C')\\
\end{array}
\]</span></p>
<p><span class="math display">\[
\left[\begin{array}{@{}c|c@{}}
A^{-T}      &amp; (CA^{-1})'  \\  \hline
(-A^{-1}B)' &amp; D' - B' A^{-T} C'
\end{array}\right]
\]</span></p>
<p>See <code><a href="../reference/Ht.html">Ht()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="derivative">Derivative<a class="anchor" aria-label="anchor" href="#derivative"></a>
</h3>
<p><span class="math display">\[
\begin{array}{rcl}
\frac{d}{dz} (C(z^{-1} - A)^{-1}B+D) &amp;=&amp; \frac{d}{dz}(D + CBz +
CABz^2 + CA^2Bz^3  + CA^2Bz^4 + \cdots )\\
&amp;=&amp; CB + 2CABz + 3CA^2Bz^2 + 4CA^2Bz^3 +\cdots \\
&amp;=&amp; \bar{C}\bar{A}\bar{B} + \bar{C}\bar{A}^2\bar{B}z +
\bar{C}\bar{A}^3\bar{B}z^2  + \bar{C}\bar{A}^4\bar{B}z^3 +\cdots \\
\end{array}
\]</span> with <span class="math display">\[
\bar{C} = \begin{pmatrix} C &amp; 0 \end{pmatrix},\
\bar{A} = \begin{pmatrix} A &amp; I \\ 0 &amp; A \end{pmatrix} \mbox{
and }
\bar{B} = \begin{pmatrix} 0 \\ B \end{pmatrix}.
\]</span> The corresponding statespace realization is</p>
<p><span class="math display">\[
\left[\begin{array}{@{}cc|c@{}}
A     &amp; I       &amp; B  \\
0     &amp; A       &amp; AB \\  \hline
CA    &amp; C       &amp; CB
\end{array}\right]
\]</span> See <code><a href="../reference/derivative.html">derivative.stsp()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="construct-statespace-representation-of-rational-matrix-in-lmfd-form">Construct statespace representation of rational matrix in LMFD
form<a class="anchor" aria-label="anchor" href="#construct-statespace-representation-of-rational-matrix-in-lmfd-form"></a>
</h3>
<p>Suppose <span class="math inline">\(c(z)=a^{-1}(z) b(z)\)</span> with
<span class="math inline">\(a(z) = a_0 + a_1 z + a_2 z^2 + \cdots + a_p
z^p\)</span>, <span class="math inline">\(b(z) = b_0 + b_1 z + \cdots +
b_q z^q\)</span> is given. The construction, detailed below, assumes
that <span class="math inline">\(a_0\)</span> is non singular and hence
we rewrite the polynomial <span class="math inline">\(a(z)\)</span>
as<br><span class="math inline">\(a(z) = I_m - a_1 z - a_2 z^2 - \cdots - a_p
z^p\)</span>. Furthermore we assume, w.l.o.g that <span class="math inline">\(p=q\)</span>. The powerseries expansion of <span class="math inline">\(c(\cdot)\)</span> is <span class="math inline">\(c(z)=k_0 + k_1 z + \cdots + k_pz^p +
\cdots\)</span>.</p>
<p>Then a statespace realization of <span class="math inline">\(c(\cdot)\)</span> is <span class="math display">\[
\left[\begin{array}{@{}cccc|c@{}}
a_1   &amp; \cdots &amp; a_{p-1} &amp; a_p    &amp; k_p     \\
I_m   &amp; \cdots &amp; 0       &amp; 0      &amp; k_{p-1} \\
\vdots&amp; \ddots &amp; \vdots  &amp; \vdots &amp; \vdots  \\
0     &amp; \cdots &amp; I_m     &amp; 0      &amp; k_1     \\ \hline
0     &amp; \cdots &amp; 0       &amp; I_m    &amp; k_0
\end{array}\right]
\]</span> This scheme is implemented in <code>as.stsp.lmfd</code> (and
<code>as.stsp.polm</code>).</p>
</div>
<div class="section level3">
<h3 id="construct-statespace-representation-of-rational-matrix-in-rmfd-form">Construct statespace representation of rational matrix in RMFD
form<a class="anchor" aria-label="anchor" href="#construct-statespace-representation-of-rational-matrix-in-rmfd-form"></a>
</h3>
<p>Likewise, it is possible to write an RMFD $k(z)=d(z) c^{-1}(z) $,
where <span class="math inline">\(c(z) = c_0 + c_1 z + c_2 z^2 + \cdots
+ c_p z^p\)</span>, and <span class="math inline">\(d(z) = d_0 + d_1 z +
\cdots + d_q z^q\)</span> is given. Again, we simplify the exposition by
setting the non-singular <span class="math inline">\(c_0\)</span> equal
to the <span class="math inline">\(m\)</span>-dimensional identity
matrix <span class="math inline">\(I_m\)</span>. In the case <span class="math inline">\(p \geq q\)</span>, the state space realization of
<span class="math inline">\(k(z)\)</span> is</p>
<p><span class="math display">\[
\left[\begin{array}{@{}cccc|c@{}}
c_1   &amp; \cdots &amp; c_{p-1} &amp; c_p    &amp; I_m     \\
I_m   &amp; \cdots &amp; 0       &amp; 0      &amp; 0 \\
\vdots&amp; \ddots &amp; \vdots  &amp; \vdots &amp; \vdots  \\
0     &amp; \cdots &amp; I_m     &amp; 0      &amp; 0     \\ \hline
d_1     &amp; \cdots &amp; d_{q-1}       &amp; d_q    &amp; d_0
\end{array}\right]
\]</span> If <span class="math inline">\(p&gt;q\)</span>, some zeros
appear in the <span class="math inline">\(C\)</span> matrix. If <span class="math inline">\(p&lt;q\)</span>, some zeros are padded into the
<span class="math inline">\(A\)</span> matrix. This scheme is
implemented in <code>as.stsp.rmfd</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="schur-qz-decomposition-lyapunov-and-riccati-equations">Schur, QZ decomposition, Lyapunov and Riccati Equations<a class="anchor" aria-label="anchor" href="#schur-qz-decomposition-lyapunov-and-riccati-equations"></a>
</h2>
<div class="section level3">
<h3 id="lyapunov-equation">Lyapunov equation<a class="anchor" aria-label="anchor" href="#lyapunov-equation"></a>
</h3>
<p>The generalized (non-symmetric) Lyapunov equation is</p>
<p><span class="math display">\[
X = A X B^* + Q
\]</span></p>
<p>With a Schur factorization of <span class="math inline">\(A\)</span>
and <span class="math inline">\(B\)</span> we obtain a form with
triangular matrices <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span></p>
<p><span class="math display">\[
\begin{array}{rcl}
\begin{pmatrix}
X_{11} &amp; X_{12} \\
X_{21} &amp; X_{22}
\end{pmatrix}
&amp;=&amp;
\begin{pmatrix}
A_{11} &amp; A_{12} \\
0 &amp; A_{22}
\end{pmatrix}
\begin{pmatrix}
X_{11} &amp; X_{12} \\
X_{21} &amp; X_{22}
\end{pmatrix}
\begin{pmatrix}
B_{11}^* &amp; 0 \\
B_{12}^* &amp; B_{22}^*
\end{pmatrix}
+
\begin{pmatrix}
Q_{11} &amp; Q_{12} \\
Q_{21} &amp; Q_{22}
\end{pmatrix} \\
&amp;=&amp;
\begin{pmatrix}
A_{11}X_{11}B_{11}^* +  A_{11}X_{12}B_{12}^* + A_{12}X_{21}B_{11}^* +
A_{12}X_{22}B_{12}^* &amp;
    (A_{11}X_{12}+A_{12}X_{22})B_{22}^*
    \\
A_{22}(X_{21}B_{11}^*+X_{22}B_{12}^*) &amp; A_{22}X_{22}B^*_{22}
\end{pmatrix}
+
\begin{pmatrix}
Q_{11} &amp; Q_{12} \\
Q_{21} &amp; Q_{22}
\end{pmatrix}
\end{array}
\]</span></p>
<ul>
<li>22-block: solve for <span class="math inline">\(X_{22}\)</span>
</li>
<li>12-block: solve for <span class="math inline">\(X_{12}\)</span>
</li>
<li>21-block: solve for <span class="math inline">\(X_{21}\)</span>
</li>
<li>continue with 11-block</li>
</ul>
<p>we could also consider the non-square case, where <span class="math inline">\(A\)</span> is <span class="math inline">\(m\times
m\)</span>, <span class="math inline">\(B\)</span> is <span class="math inline">\(n\times n\)</span> and <span class="math inline">\(Q\)</span> is <span class="math inline">\(m\times
n\)</span>.</p>
</div>
<div class="section level3">
<h3 id="balancing-and-balanced-truncation">Balancing and Balanced Truncation<a class="anchor" aria-label="anchor" href="#balancing-and-balanced-truncation"></a>
</h3>
<p>Consider a pair of Grammians <span class="math inline">\(P,Q\)</span>. We first compute the sqare roots
<span class="math inline">\(P=MM'\)</span> and <span class="math inline">\(Q=NN'\)</span> and then consider the SVD<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;The squared singular values of &lt;span class=&quot;math inline&quot;&gt;\(M'N\)&lt;/span&gt; are the eigenvalues of &lt;span class=&quot;math inline&quot;&gt;\(M'NN'M\)&lt;/span&gt;. Therefore the non zero,
squared singular values are equal to the non zero eigenvalues of &lt;span class=&quot;math inline&quot;&gt;\(MM'NN'=PQ\)&lt;/span&gt;.&lt;/p&gt;"><sup>1</sup></a> of <span class="math inline">\(M'N\)</span>:</p>
<p><span class="math display">\[
M'N = U \Sigma V' =
[U_1, U_2]
\begin{pmatrix}
\Sigma_{11} &amp; 0 \\
0 &amp; \Sigma_{22}
\end{pmatrix}
[V_1, V_2]'
\]</span> where the diagonal blocks <span class="math inline">\(\Sigma_{11}\)</span>, <span class="math inline">\(\Sigma_{22}\)</span> are of size <span class="math inline">\((s_1,s_1)\)</span> and <span class="math inline">\((s_2,s_2)\)</span> respectively. We assume that
<span class="math inline">\(\Sigma_{11}\)</span> is positive definite
and set <span class="math display">\[
\begin{array}{rcl}
T_1 &amp;=&amp; \Sigma_{11}^{-1/2} V_1' N' \\
S_1 &amp;=&amp; M U_1\Sigma_{11}^{-1/2}
\end{array}
\]</span> and note that <span class="math display">\[
\begin{array}{rcl}
T_1 S_1 &amp;=&amp; \Sigma_{11}^{-1/2} V_1' N' M
U_1\Sigma_{11}^{-1/2} \\
        &amp;=&amp; \Sigma_{11}^{-1/2} V_1' V \Sigma U' M
U_1\Sigma_{11}^{-1/2} = I_{s_1}
\end{array}
\]</span> We extend these matrices to square <span class="math inline">\((s\times s)\)</span> matrices <span class="math display">\[
T = \begin{pmatrix} T_1 \\ T_2 \end{pmatrix} \mbox{ and }
S = \begin{pmatrix} S_1 &amp; S_2 \end{pmatrix}
\]</span></p>
<p>such that <span class="math inline">\(TS=ST= I_s\)</span>, i.e. <span class="math inline">\(S= T^{-1}\)</span>. To this end we consider the
SVD’s</p>
<p><span class="math display">\[
\begin{array}{rclcl}
S_1 T_1 &amp;=&amp; \bar{U}_1 \bar{\Sigma}_{11} \bar{V}_1'
&amp;&amp;\bar{U}_1,\bar{V}_1\in \mathbb{R}^{s\times s_1},\,
                                                     \bar{\Sigma}_{11}
\in \mathbb{R}^{s_1 \times s_1} \\
\bar{U}_2'\bar{V}_2 &amp;=&amp; \hat{U}\hat{\Sigma}\hat{V}'
&amp;&amp;\hat{U},\hat{V},\hat{\Sigma} \in \mathbb{R}^{s_2\times s_2}
\end{array}
\]</span> and set <span class="math inline">\(T_2 =
\hat{\Sigma}^{-1/2}\hat{U}'\bar{U}_2'\)</span> and <span class="math inline">\(S_2 =
\bar{V}_2\hat{V}\hat{\Sigma}^{-1/2}\)</span>.</p>
<p>We now consider the <em>transformed</em> statespace realization <span class="math display">\[
\left[\begin{array}{@{}c|c@{}}
A &amp; B \\ \hline
C &amp; D
\end{array}\right] \; \longrightarrow \;
\left[\begin{array}{@{}cc|c@{}}
T_1 A S_1 &amp; T_1 A S_2 &amp; T_1 B \\
T_2 A S_1 &amp; T_2 A S_2 &amp; T_2 B \\ \hline
C S_1 &amp; C S_2  &amp; D
\end{array}\right]
\]</span> and the Grammians are transformed as <span class="math inline">\(P \rightarrow TPT'\)</span> and <span class="math inline">\(Q \rightarrow S' QS\)</span>.</p>
<p><span class="math display">\[
T M = \begin{pmatrix} \Sigma_{11}^{-1/2} V_1' N' M \\ T_2 M
\end{pmatrix}
    = \begin{pmatrix} \Sigma_{11}^{1/2} U_1' \\ T_2 M \end{pmatrix}
\]</span></p>
<p><span class="math display">\[
S' N = \begin{pmatrix} \Sigma_{11}^{-1/2} U_1' M' N \\
S_2' N \end{pmatrix}
    = \begin{pmatrix} \Sigma_{11}^{1/2} V_1' \\ S_2' N
\end{pmatrix}
\]</span> <span class="math display">\[
TPT' = (TM)(TM)' =
\begin{pmatrix}
\Sigma_{11}^{1/2} U_1' U_1 \Sigma_{11}^{1/2}  &amp;
\Sigma_{11}^{1/2} U_1' M' T_2'  \\
T_2 M U_1 \Sigma_{11}^{1/2}                    &amp; T_2 MM'
T_2'
\end{pmatrix} =
\begin{pmatrix}
\Sigma_{11} &amp; 0 \\
0           &amp; T_2 P T_2'
\end{pmatrix}
\]</span></p>
<p><span class="math display">\[
S'QS = (S'N)(S'N)' =
\begin{pmatrix}
\Sigma_{11}^{-1/2} V_1' V_1 \Sigma_{11}^{1/2}  &amp;
\Sigma_{11}^{1/2} V_1' N' S_2  \\
S_2' N V_1 \Sigma_{11}^{1/2}                    &amp; S_2'
NN' S_2  
\end{pmatrix} =
\begin{pmatrix}
\Sigma_{11} &amp; 0 \\
0           &amp; S_2' Q S_2
\end{pmatrix}
\]</span> Here we have used that <span class="math inline">\(T_2 M U_1
\Sigma_{11}^{1/2} = T_2 S_1 \Sigma_{11} = 0\)</span> and <span class="math inline">\(\Sigma_{11}^{1/2} V_1' N' S_2 =
\Sigma_{11} T_1 S_2 = 0\)</span>. Due to the block diagonal structure of
<span class="math inline">\(TPT'\)</span> and <span class="math inline">\(S'QS\)</span> we also immediately get</p>
<p><span class="math display">\[
TPQS = TPT' S'QS =  
\begin{pmatrix}
\Sigma_{11}^2 &amp; 0 \\
0           &amp; T_2 P Q S_2
\end{pmatrix}
\]</span></p>
<p>and</p>
<p><span class="math display">\[
T_2 PQ S_2 = T_2 MM' NN' S_2 = T_2 M U\Sigma V' N'S_2 =
\underbrace{T_2 M U_1}_{=0}\Sigma_{11} \underbrace{V_1' N'
S_2}_{=0} + T_2 M U_2\Sigma_{22} V_2' N' S_2 =
T_2 M U_2\Sigma_{22} V_2' N' S_2.
\]</span></p>
<p>The following scenarios are of particular interest:</p>
<ul>
<li>
<span class="math inline">\(s_2=0\)</span>: The model is
<em>minimal</em> and the above procedure renders the statespace
realization into balanced form.</li>
<li>
<span class="math inline">\(s_2&gt;0\)</span> and <span class="math inline">\(\Sigma_{22} = 0\)</span>: The above procedure
renders the model in a form where the controllable and observable states
are clearly seperated from the non observable or non controllable
states. In particular the truncated model <span class="math display">\[
\left[\begin{array}{@{}c|c@{}}
T_1 A S_1 &amp; T_1 B \\
T_2 A S_1 &amp; T_2 B \\ \hline
C S_1     &amp; D
\end{array}\right]
\]</span> is equivalent to the original model and it is minimal and in
balanced form</li>
<li>If <span class="math inline">\(s_2&gt;0\)</span> but <span class="math inline">\(\Sigma_{22} \neq 0\)</span> then the truncated
model is just an approximation of the original model. The quality
depends on the size of the neglected singular values. Note also that the
truncated model is not balanced.</li>
</ul>
<p>Note that the determination of the number of non zeroe singular
values is quite tricky. (difficult due to numerics). Currently the
number of non zero singular values is chosen as the number of singular
values which satisfy <span class="math inline">\(\sigma_k &gt; \tau
\sigma_1\)</span> where <span class="math inline">\(\tau\)</span> is a
user defined tolerance parameter.</p>
</div>
<div class="section level3">
<h3 id="reflect-poles-and-zeroes">Reflect Poles and Zeroes<a class="anchor" aria-label="anchor" href="#reflect-poles-and-zeroes"></a>
</h3>
<div class="section level4">
<h4 id="all-pass-matrices">All-Pass Matrices<a class="anchor" aria-label="anchor" href="#all-pass-matrices"></a>
</h4>
<p>A rational matrix <span class="math inline">\(k(z)\)</span> is
all-pass if <span class="math inline">\(k(z)
k'\left(\frac{1}{z}\right) = k'\left(\frac{1}{z}\right) k(z) =
I_m\)</span>. If <span class="math inline">\((A,B,C,D)\)</span> is a
statespace realization of <span class="math inline">\(k(z)\)</span> then
the product <span class="math inline">\(k(z)
k'\left(\frac{1}{z}\right)\)</span> has a realization given by <span class="math display">\[
\left[\begin{array}{@{}cc|c@{}}
A   &amp; -BB'A^{-T}   &amp; BD' - BB'A^{-T}C' \\
0   &amp; A^{-T}       &amp; A^{-T}C' \\ \hline
C   &amp; -DB'A^{-T}   &amp; DD' - DB' A^{-T} C'
\end{array}\right]
\]</span></p>
<p>A state transformation gives</p>
<p><span class="math display">\[
\left[
\begin{array}{@{}cc|c@{}}
I &amp; X &amp; 0 \\
0 &amp; I &amp; 0 \\ \hline
0 &amp; 0 &amp; I
\end{array}
\right]
\left[\begin{array}{@{}cc|c@{}}
A   &amp; -BB'A^{-T}   &amp; BD' - BB'A^{-T}C' \\
0   &amp; A^{-T}       &amp; A^{-T}C' \\ \hline
C   &amp; -DB'A^{-T}   &amp; DD' - DB' A^{-T} C'
\end{array}\right]
\left[
\begin{array}{@{}cc|c@{}}
I &amp; -X &amp; 0 \\
0 &amp; I &amp; 0 \\ \hline
0 &amp; 0 &amp; I
\end{array}
\right]
=
\left[\begin{array}{@{}cc|c@{}}
A   &amp; XA^{-T}-AX-BB'A^{-T}   &amp; BD' - BB'A^{-T}C'
+ X A^{-T}C'\\
0   &amp; A^{-T}                 &amp; A^{-T}C' \\ \hline
C   &amp; -DB'A^{-T}-CX   &amp; DD' - DB' A^{-T} C'
\end{array}\right]
\]</span></p>
<p>The (1,1) block is not controllable and the (2,2) block is not
observable if</p>
<p><span class="math display">\[
\begin{array}{rclcrcl}
XA^{-T}-AX-BB'A^{-T} &amp;=&amp; 0 &amp; \Longleftrightarrow   &amp;
X -AXA' - BB' &amp;=&amp; 0 \\
-DB'A^{-T}-CX &amp;=&amp; 0        &amp;  \Longleftrightarrow  &amp;
[X', A^{-1}B] [C, D]' &amp;=&amp; 0\\
BD' - BB'A^{-T}C' + X A^{-T}C' &amp;=&amp; 0
                           &amp;  \Longleftrightarrow  &amp;
[XA^{-T}-BB'A^{-T}, B][C, D]'  &amp;=&amp; 0\\
&amp; &amp;                       &amp;  \Longleftrightarrow  &amp;
[AX', B][C, D]'  &amp;=&amp; 0\\
\end{array}
\]</span> Furthermore <span class="math display">\[
DD' - DB' A^{-T} C' = D[B'A^{-T}, -I][C,D]' = I
\]</span> must hold.</p>
<p>It follows that we end up with the system <span class="math display">\[
\left[\begin{array}{@{}cc|c@{}}
A   &amp; 0   &amp; 0\\
0   &amp; A^{-T}                 &amp; A^{-T}C' \\ \hline
C   &amp; 0   &amp; I
\end{array}\right]
\]</span> whose transfer function is equal to <span class="math display">\[
\begin{pmatrix} C &amp; 0 \end{pmatrix} \left( I z^{-1} -
\begin{pmatrix} A &amp; 0 \\ 0 &amp; A^{-T} \end{pmatrix} \right)^{-1}
\begin{pmatrix} 0 \\ A^{-T}C' \end{pmatrix} + I_m,
\]</span> i.e. the identity matrix as required.</p>
<p>In the following we need to construct an allpass matrix with given
<span class="math inline">\((A,B)\)</span> (or given <span class="math inline">\((A,C)\)</span>).</p>
<ol style="list-style-type: decimal">
<li>From the above Lyapunov equation <span class="math inline">\(X =
AXA' + BB'\)</span> determine <span class="math inline">\(X\)</span>.</li>
<li>Determine the row space of <span class="math inline">\([C,D]\)</span> from the left kernel of <span class="math inline">\([AX',B]'\)</span>.</li>
<li>Determine the scaling matrix from the requirement <span class="math inline">\(DD' - DB' A^{-T} C' = I\)</span>.</li>
</ol>
<p><em>Note:</em> Wann gibt es Probleme? ….</p>
</div>
<div class="section level4">
<h4 id="zero-cancellations">zero cancellations<a class="anchor" aria-label="anchor" href="#zero-cancellations"></a>
</h4>
<p>Let <span class="math inline">\(k(z)\)</span> be given. We want to
find an allpass transfer function <span class="math inline">\(\hat{k}(z)\)</span> such some of the poles of
<span class="math inline">\(k(z)\)</span> are cancelled in <span class="math inline">\(k(z)\hat{k}(z)\)</span>.</p>
<p>Consider the state transformation of the realization of <span class="math inline">\(k\hat{k}\)</span>:</p>
<p><span class="math display">\[
\left[
\begin{array}{@{}ccc|c@{}}
I &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; I &amp; 0  &amp; 0 \\
I &amp; 0 &amp; I  &amp; 0 \\ \hline
0 &amp; 0 &amp; 0  &amp; I
\end{array}
\right]
\left[
\begin{array}{@{}ccc|c@{}}
A_{11} &amp; A_{12} &amp; B_{1}\hat{C} &amp; B_{1}\hat{D} \\
A_{21} &amp; A_{22} &amp; B_{2}\hat{C} &amp; B_{2}\hat{D} \\
     0 &amp; 0      &amp; \hat{A}      &amp; \hat{B} \\ \hline
C_{1}  &amp; C_{2}  &amp; D\hat{C}     &amp; D\hat{D}
\end{array}
\right]
\left[
\begin{array}{@{}ccc|c@{}}
I &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; I &amp; 0 &amp; 0 \\
-I &amp; 0 &amp; I &amp; 0 \\ \hline
0 &amp; 0 &amp; 0 &amp; I
\end{array}
\right] =
\left[
\begin{array}{@{}ccc|c@{}}
A_{11}-B_{1}\hat{C}    &amp; A_{12} &amp; B_{1}\hat{C} &amp;
B_{1}\hat{D}\\
A_{21}-B_{2}\hat{C}    &amp; A_{22} &amp; B_{2}\hat{C}           &amp;
B_2 \hat{D} \\
A_{11}-B_{1}\hat{C} -\hat{A}         &amp; A_{12}      &amp; \hat{A} +
B_{1}\hat{C}  &amp; B_{1}\hat{D} + \hat{B} \\ \hline
C_{1}-D\hat{C}  &amp; C_{2}  &amp; D\hat{C}                  &amp;
D\hat{D}
\end{array}
\right]
\]</span> The <span class="math inline">\((1,1)\)</span> block is not
observable if <span class="math display">\[
\begin{array}{rclcrcl}
A_{21} - B_2 \hat{C} &amp;=&amp; 0 &amp;\Longleftrightarrow&amp; A_{21}
- B_2 D^{-1} C_1 &amp;=&amp; 0\\
A_{11}-B_{1}\hat{C} -\hat{A} &amp;=&amp; 0 &amp;\Longleftrightarrow&amp;
\hat{A} &amp;=&amp; A_{11} - B_1 D^{-1} C_1 \\
C_{1}-D\hat{C} &amp;=&amp; 0 &amp;\Longleftrightarrow&amp; \hat{C}
&amp;=&amp; D^{-1} C_1 \\
\end{array}
\]</span></p>
</div>
<div class="section level4">
<h4 id="pole-cancellations">pole cancellations<a class="anchor" aria-label="anchor" href="#pole-cancellations"></a>
</h4>
<p>Let <span class="math inline">\(k(z)\)</span> be given. We want to
find an allpass transfer function <span class="math inline">\(\hat{k}(z)\)</span> such some of the poles of
<span class="math inline">\(k(z)\)</span> are cancelled in <span class="math inline">\(k(z)\hat{k}(z)\)</span>.</p>
<p>Consider the state transformation of the realization of <span class="math inline">\(k\hat{k}\)</span>:</p>
<p><span class="math display">\[
\left[
\begin{array}{@{}ccc|c@{}}
I &amp; 0 &amp; -I &amp; 0 \\
0 &amp; I &amp; 0  &amp; 0 \\
0 &amp; 0 &amp; I  &amp; 0 \\ \hline
0 &amp; 0 &amp; 0  &amp; I
\end{array}
\right]
\left[
\begin{array}{@{}ccc|c@{}}
A_{11} &amp; A_{12} &amp; B_{1}\hat{C} &amp; B_{1}\hat{D} \\
A_{21} &amp; A_{22} &amp; B_{2}\hat{C} &amp; B_{2}\hat{D} \\
     0 &amp; 0      &amp; \hat{A}      &amp; \hat{B} \\ \hline
C_{1}  &amp; C_{2}  &amp; D\hat{C}     &amp; D\hat{D}
\end{array}
\right]
\left[
\begin{array}{@{}ccc|c@{}}
I &amp; 0 &amp; I &amp; 0 \\
0 &amp; I &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; I &amp; 0 \\ \hline
0 &amp; 0 &amp; 0 &amp; I
\end{array}
\right] =
\left[
\begin{array}{@{}ccc|c@{}}
A_{11}    &amp; A_{12} &amp; A_{11} + B_{1}\hat{C} - \hat{A} &amp;
B_{1}\hat{D} - \hat{B} \\
A_{21}    &amp; A_{22} &amp; A_{21} + B_{2}\hat{C}           &amp; B_2
\hat{D} \\
0         &amp; 0      &amp; \hat{A}                         &amp;
\hat{B} \\ \hline
C_{1}     &amp; C_{2}  &amp; C_1 + D\hat{C}                  &amp;
D\hat{D}
\end{array}
\right]
\]</span></p>
<p>The (1,1) block is not controllable if</p>
<p><span class="math display">\[
\begin{array}{rclcrcl}
A_{12} &amp;=&amp; 0                       &amp; \Longleftrightarrow
&amp; A_{12} &amp;=&amp; 0\\
\hat{A} &amp;=&amp; A_{11} + B_1 \hat{C}   &amp; \Longleftrightarrow
&amp; (\hat{A} - \hat{B} \hat{D}^{-1} \hat{C}) &amp;=&amp; A_{11}\\
\hat{B} &amp;=&amp; B_1 \hat{D}            &amp; \Longleftrightarrow
&amp; (\hat{B}\hat{D}^{-1}) &amp;=&amp; B_{1}
\end{array}
\]</span></p>
<p>Hence the “<span class="math inline">\(A,B\)</span>” matrices of the
inverse of <span class="math inline">\(\hat{k}^{-1}\)</span> are
determined.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="qr-decomposition-rank-and-null-space">QR decomposition, Rank and Null Space<a class="anchor" aria-label="anchor" href="#qr-decomposition-rank-and-null-space"></a>
</h2>
<p>Consider the following example</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tol</span> <span class="op">=</span> <span class="fl">1e-7</span></span>
<span><span class="va">tol2</span> <span class="op">=</span> <span class="va">tol</span><span class="op">/</span><span class="fl">10</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">tol2</span>, <span class="va">tol2</span><span class="op">^</span><span class="fl">2</span>, <span class="va">tol2</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">qr_x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/qr.html" class="external-link">qr</a></span><span class="op">(</span><span class="va">x</span>, tol <span class="op">=</span> <span class="va">tol</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x</span></span>
<span><span class="co">#&gt;      [,1]  [,2]  [,3]  [,4]</span></span>
<span><span class="co">#&gt; [1,]    1 0e+00 0e+00 0e+00</span></span>
<span><span class="co">#&gt; [2,]    0 1e-08 0e+00 0e+00</span></span>
<span><span class="co">#&gt; [3,]    0 0e+00 1e-16 0e+00</span></span>
<span><span class="co">#&gt; [4,]    0 0e+00 0e+00 1e-24</span></span>
<span><span class="va">qr_x</span><span class="op">$</span><span class="va">rank</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="va">qr_x</span><span class="op">$</span><span class="va">pivot</span></span>
<span><span class="co">#&gt; [1] 1 2 3 4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/qraux.html" class="external-link">qr.R</a></span><span class="op">(</span><span class="va">qr_x</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1]   [,2]   [,3]  [,4]</span></span>
<span><span class="co">#&gt; [1,]   -1  0e+00  0e+00 0e+00</span></span>
<span><span class="co">#&gt; [2,]    0 -1e-08  0e+00 0e+00</span></span>
<span><span class="co">#&gt; [3,]    0  0e+00 -1e-16 0e+00</span></span>
<span><span class="co">#&gt; [4,]    0  0e+00  0e+00 1e-24</span></span></code></pre></div>
<p>Is this the desired result for the rank (and the null space)? The
main reason for this somewhat strange results is that <code><a href="https://rdrr.io/r/base/qr.html" class="external-link">qr()</a></code>
considers a column as zero, if and only if the projection onto the space
spanned by the previous columns reduces the norm by a factor which is
larger than <code>tol</code>.</p>
<p>The following example works as desired</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="va">qr_x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/qr.html" class="external-link">qr</a></span><span class="op">(</span><span class="va">x</span>, tol <span class="op">=</span> <span class="va">tol</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x</span></span>
<span><span class="co">#&gt;      [,1]  [,2]  [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,]    1 1e+00 1e+00    1</span></span>
<span><span class="co">#&gt; [2,]    0 1e-08 0e+00    0</span></span>
<span><span class="co">#&gt; [3,]    0 0e+00 1e-16    0</span></span>
<span><span class="co">#&gt; [4,]    0 0e+00 0e+00    1</span></span>
<span><span class="va">qr_x</span><span class="op">$</span><span class="va">rank</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="va">qr_x</span><span class="op">$</span><span class="va">pivot</span></span>
<span><span class="co">#&gt; [1] 1 4 2 3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/qraux.html" class="external-link">qr.R</a></span><span class="op">(</span><span class="va">qr_x</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]   [,3]   [,4]</span></span>
<span><span class="co">#&gt; [1,]   -1   -1 -1e+00 -1e+00</span></span>
<span><span class="co">#&gt; [2,]    0   -1  0e+00  0e+00</span></span>
<span><span class="co">#&gt; [3,]    0    0 -1e-08  0e+00</span></span>
<span><span class="co">#&gt; [4,]    0    0  0e+00  1e-16</span></span></code></pre></div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Wolfgang Scherrer, Bernd Funovits.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
