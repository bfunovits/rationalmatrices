<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rationalmatrices">
<title>Rational Matrices • rationalmatrices</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Rational Matrices">
<meta property="og:description" content="rationalmatrices">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rationalmatrices</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a_rational_matrices.html">Rational Matrices</a>
    <a class="dropdown-item" href="../articles/b_technical_details_ratm.html">Rational Matrices: Technical Details</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="a_rational_matrices_files/htmlwidgets-1.6.3/htmlwidgets.js"></script><script src="a_rational_matrices_files/viz-1.8.2/viz.js"></script><link href="a_rational_matrices_files/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="a_rational_matrices_files/grViz-binding-1.0.10/grViz.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Rational Matrices</h1>
                        <h4 data-toc-skip class="author">Wolfgang
Scherrer and Bernd Funovits</h4>
            
            <h4 data-toc-skip class="date">2023-12-02</h4>
      
      
      <div class="d-none name"><code>a_rational_matrices.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>rationalmatrices</code> package is a collection of classes,
methods and functions for handling and manipulating rational matrices,
i.e matrices whose entries are rational functions entries. Such matrices
are in particular useful for linear dynamic time series models, like
VARMA and statespace models. This package is mainly designed and written
with regard to this application. See also the “companion” package
<code>RLDM</code>.</p>
<p>The main goal is to implement classes for rational matrices such that
they may be handled similarly to ordinary matrices. In particular,
arithmetic operations, like addition, should look and feel as the
manipulations of ordinary matrices.</p>
<p>We start with some basic examples. First we create a scalar
polynomial <span class="math inline">\(a(z)=1+0.9z+0.9z^2+0.9^3z^3\)</span>, check that
the object is “valid” and print it:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="../reference/polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0.9</span>,<span class="fl">0.9</span><span class="op">^</span><span class="fl">2</span>,<span class="fl">0.9</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/is.html">is.polm</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">a</span>, format <span class="op">=</span> <span class="st">'c'</span><span class="op">)</span></span>
<span><span class="co">#&gt; ( 1 x 1 ) matrix polynomial with degree &lt;= 3 </span></span>
<span><span class="co">#&gt;                                [,1]</span></span>
<span><span class="co">#&gt; [1,]  1 + 0.9z + 0.81z^2 + 0.729z^3</span></span></code></pre></div>
<p>Create a scalar rational matrix <span class="math inline">\(c(z) =
a^{-1}(z) b(z)\)</span> in LMFD form, check that the object is valid and
print it:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">c</span> <span class="op">=</span> <span class="fu"><a href="../reference/lmfd.html">lmfd</a></span><span class="op">(</span><span class="va">a</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0.8</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/is.html">is.lmfd</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span></span>
<span><span class="co">#&gt; ( 1 x 1 ) left matrix fraction description a^(-1)(z) b(z) with degrees (p = 3, q = 2)</span></span>
<span><span class="co">#&gt; left factor a(z):</span></span>
<span><span class="co">#&gt;      z^0 [,1] z^1 [,1] z^2 [,1] z^3 [,1]</span></span>
<span><span class="co">#&gt; [1,]        1      0.9     0.81    0.729</span></span>
<span><span class="co">#&gt; right factor b(z):</span></span>
<span><span class="co">#&gt;      z^0 [,1] z^1 [,1] z^2 [,1]</span></span>
<span><span class="co">#&gt; [1,]        1        0     0.64</span></span></code></pre></div>
<p>Compute poles and zeroes of <span class="math inline">\(c(\cdot)\)</span></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/poles_and_zeroes.html">poles</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  0.000000-1.111111i  0.000000+1.111111i -1.111111+0.000000i</span></span>
<span><span class="fu"><a href="../reference/poles_and_zeroes.html">zeroes</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0-1.25i 0+1.25i</span></span></code></pre></div>
<p>Evaluate <span class="math inline">\(a(z), b(z), c(z)\)</span> on the
unit circle and check that <span class="math inline">\(c=a^{-1}b\)</span>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## evaluate</span></span>
<span><span class="va">af</span> <span class="op">=</span> <span class="fu"><a href="../reference/zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">c</span><span class="op">$</span><span class="va">a</span>, n.f <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">bf</span> <span class="op">=</span> <span class="fu"><a href="../reference/zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">c</span><span class="op">$</span><span class="va">b</span>, n.f <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">cf</span> <span class="op">=</span> <span class="fu"><a href="../reference/zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">c</span>, n.f <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">cf</span>, <span class="va">af</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="va">bf</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">cf</span>, format <span class="op">=</span> <span class="st">'iz|j'</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; ( 1 x 1 ) frequency response</span></span>
<span><span class="co">#&gt;                            [,1]</span></span>
<span><span class="co">#&gt;          z=1+0i [1,] 0.48+0.00i</span></span>
<span><span class="co">#&gt;  z=0.809-0.588i [1,] 0.47+0.19i</span></span>
<span><span class="co">#&gt;  z=0.309-0.951i [1,] 0.44+0.52i</span></span>
<span><span class="co">#&gt; z=-0.309-0.951i [1,] 0.77+0.52i</span></span>
<span><span class="co">#&gt; z=-0.809-0.588i [1,] 0.81+1.31i</span></span>
<span><span class="co">#&gt;         z=-1+0i [1,] 9.06+0.00i</span></span>
<span><span class="co">#&gt; z=-0.809+0.588i [1,] 0.81-1.31i</span></span>
<span><span class="co">#&gt; z=-0.309+0.951i [1,] 0.77-0.52i</span></span>
<span><span class="co">#&gt;  z=0.309+0.951i [1,] 0.44-0.52i</span></span>
<span><span class="co">#&gt;  z=0.809+0.588i [1,] 0.47-0.19i</span></span></code></pre></div>
<p>Produce a “Nyquist” plot, where the imaginary part is plotted versus
the real part. In order to get a “nice, smooth” path, we evaluate the
rational function <span class="math inline">\(c(z)\)</span> on a grid of
1024 points on the unit circle:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">c</span>, n.f <span class="op">=</span> <span class="fl">1024</span><span class="op">)</span>, which <span class="op">=</span> <span class="st">'nyquist'</span><span class="op">)</span></span></code></pre></div>
<p><img src="a_rational_matrices_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="classes">Classes<a class="anchor" aria-label="anchor" href="#classes"></a>
</h2>
<div class="grViz html-widget html-fill-item" id="htmlwidget-c9e79ad77533cdc8e9fb" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-c9e79ad77533cdc8e9fb">{"x":{"diagram":"\n  digraph G {\n    compound=true;\n        splines = lines;\n\n    graph [layout = dot, rankdir = LR]\n      splines = lines\n\n        ra [label=\"Class polm(): \n\n Polynomial matrix object. \n Stored as 3-dim array (#Rows, #Cols, #Coeff) \"]\n      ra -> rb;\n      ra -> rc;\n\n\n      # Rational function representations\n    subgraph cluster_repr {\n      label = \"Different representation of matrices \n whose elements are rational functions\"\n      fontsize = 16\n      fontname = \"times-bold\"\n          # Polynomial\n\n\n      rb [shape=polygon,sides=4,label=\"Class lmfd(): \n\n Left matrix fraction description object (a(z), b(z)). \n Stored as matrix of dim \n (#Rows, #Cols x (#Coeffs_of_a(z) + #Coeffs_of_b(z)))\"]\n      rc [shape=polygon,sides=4,label=\"Class rmfd(): \n\n Right matrix fraction description object. \n Stored as matrix of dim \n (#Rows x (#Coeffs_of_c(z) + #Coeffs_of_d(z)), #Cols)\"]\n\n      rd [shape=polygon,sides=4,label = \"Class stsp(): \n\n State space object (A,B,C,D). \n Stored as a matrix.\"]\n      {rank=same; rb,rc,rd}\n    }\n\n    subgraph cluster_pseries {\n      label = \"Power series \n aka transfer function \n aka impulse response function\"\n      fontsize = 16\n      fontname = \"times-bold\"\n\n      pa [shape=polygon, sides=4, label = \"Class pseries(): \n\n Power series coefficients obtained from \n a rational matrix.\" ]\n    }\n\n    ha [label = \"Hankel matrix: \n Representation of transfer function.\" ]\n    pa -> ha[label = \"Shifting \n transfer function \n coefficients\"]\n\n    splines = lines\n\n    ha -> rb [label = \"(Left)- \n echelon \n form\", color = \"red\"]\n    ha -> rc [label = \"(right)- \n echelon \n form\", color = \"red\"]\n    ha -> rd [label = \"(left)- echelon form or \n balanced realization\", color = \"red\"]\n\n    rb -> pa [label = \"pseries.lmfd(): \n Obtain \n transfer function \n from LMFD\", color = \"blue\"]\n    rc -> pa [label = \"pseries.rmfd(): \n Obtain \n transfer function \n from RMFD\", color = \"blue\"]\n    rd -> pa [label = \"pseries.stsp(): \n Obtain \n transfer function \n from state space \n representation\", color = \"blue\"]\n    }\n  ","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>There are several useful representations (realizations) for rational
matrices. Here, we only consider polynomial matrices and rational
matrices represented by a <em>left matrix fraction description</em> or
by a <em>statespace realization</em>. Furthermore, the coefficients of
the power series expansion (here called <em>impulse response
function</em>) and a (sufficently rich) set of values of the rational
matrix (here called <em>frequency response function</em>) uniquely
determine the rational matrix and hence may be seen as another way to
represent such a rational matrix.</p>
<p>There are no separate classes for rational <em>scalars</em> or
rational <em>vectors</em>. A scalar is simply considered as an <span class="math inline">\((1\times 1)\)</span> matrix and a vector is a
<span class="math inline">\((m\times 1)\)</span> (or<span class="math inline">\((1 \times n)\)</span>) matrix.</p>
<div class="section level3">
<h3 id="polynomial-matrices">Polynomial Matrices<a class="anchor" aria-label="anchor" href="#polynomial-matrices"></a>
</h3>
<p>Polynomial matrices</p>
<p><span class="math display">\[
a(z) = a_0 + a_1 z + \cdots + a_p z^p,\; a_i\in \mathbb{R}^{m\times n}
\mbox{ or } a_i \in \mathbb{C}^{m\times n}
\]</span> are represented by objects of class <code>polm</code>. Such a
<code>polm</code> object is simply an <span class="math inline">\((m,n,p+1)\)</span>-dimensional array which stores
the coefficients <span class="math inline">\(a_i\)</span> together with
a class attribute <code>c('polm','ratm')</code>.</p>
<p><strong>Note:</strong> We allow for <em>complex</em> coefficients,
<em>empty</em> polynomials (<span class="math inline">\(m=0\)</span> or
<span class="math inline">\(n=0\)</span>) and <em>zero</em> polynomials
(<span class="math inline">\(a(z)=0\)</span> for all <span class="math inline">\(z\in \mathbb{C}\)</span>). Zero polynomials may be
represented by an <span class="math inline">\((m,n,0)\)</span>-dimensional array, i.e. the
degree <span class="math inline">\(p\)</span> is equal to <span class="math inline">\(p=-1\)</span>.</p>
<p>The constructor for polynomial matrices is <code><a href="../reference/polm.html">polm()</a></code>. For
testing purposes one may use <code><a href="../reference/test_polm.html">test_polm()</a></code> to create (random)
polynomial matrices.</p>
</div>
<div class="section level3">
<h3 id="left-matrix-fraction-description">Left Matrix Fraction Description<a class="anchor" aria-label="anchor" href="#left-matrix-fraction-description"></a>
</h3>
<p>Any rational <span class="math inline">\((m \times n)\)</span> matrix
<span class="math inline">\(c(z)\)</span> may be represented as <span class="math inline">\(c(z) = a^{-1}(z) b(z)\)</span>, where</p>
<p><span class="math display">\[
a(z)  = a_0 + a_1 z + \cdots + a_p z^p
\]</span> is an <span class="math inline">\((m \times m)\)</span> (non
singular) polynomial matrix of degree <span class="math inline">\(p\)</span>, and</p>
<p><span class="math display">\[
b(z) = b_0 + b_1 z + \cdots + b_q z^q
\]</span> is an <span class="math inline">\((m \times n)\)</span>
dimensional matrix polynomial of degree <span class="math inline">\(q\)</span>.<br>
The matrix <span class="math inline">\(c(z)\)</span> is thus described
by the pair <span class="math inline">\((a(z), b(z))\)</span>. Note that
the “factors” <span class="math inline">\(a(z), b(z)\)</span> are by no
means unique for given <span class="math inline">\(c(z)\)</span>.</p>
<p>Internally such LMFDs are stored as a matrix</p>
<p><span class="math display">\[
[a_0,a_1,\ldots,a_p,b_0,\ldots,b_q] \in \mathbb{R}^{m \times
(m(p+1)+n(q+1))}
\]</span> with an attribute <code>order = c(m,n,p,q)</code> and a class
attribute <code>c('lmfd','ratm')</code>.</p>
<p><strong>Note:</strong> We demand <span class="math inline">\(m&gt;0\)</span>, since it is not clear how to
interpret the inverse of an <span class="math inline">\((0 \times
0)\)</span>-dimensional matrix. Since <span class="math inline">\(a(z)\)</span> is non singular, <span class="math inline">\(p\geq 0\)</span> must hold.</p>
<p>The constructor for <code>lmfd</code> objects is <code><a href="../reference/lmfd.html">lmfd()</a></code>.
For testing purposes one may use <code><a href="../reference/test_lmfd.html">test_lmfd()</a></code> to create
(random) rational matrices in LMFD form.</p>
</div>
<div class="section level3">
<h3 id="statespace-representation">Statespace Representation<a class="anchor" aria-label="anchor" href="#statespace-representation"></a>
</h3>
<p>Any rational (<span class="math inline">\((m \times
n)\)</span>-dimensional) matrix <span class="math inline">\(c(z)\)</span> which has no pole at <span class="math inline">\(z=0\)</span> may be represented as</p>
<p><span class="math display">\[
c(z) = C(z^{-1}I_s - A)^{-1}B + D
\]</span> where <span class="math inline">\(A\in \mathbb{R}^{s\times
s}\)</span>, <span class="math inline">\(B\in \mathbb{R}^{s\times
n}\)</span>, <span class="math inline">\(C\in \mathbb{R}^{m\times
s}\)</span> and <span class="math inline">\(D\in \mathbb{R}^{m\times
n}\)</span>. The integer <span class="math inline">\(s\)</span> is
called the <em>state dimension</em> of the above realization. Statespace
representations are by no means unique, even the state dimension <span class="math inline">\(s\)</span> is not unique. If the state dimension
<span class="math inline">\(s\)</span> is minimal among all possible
realizations of <span class="math inline">\(c(z)\)</span> then the
representation is called <em>minimal</em>.</p>
<p>Internally, statespace realizations are stored as a matrix</p>
<p><span class="math display">\[
\begin{bmatrix}
A &amp; B \\
C &amp; D
\end{bmatrix} \in \mathbb{R}^{(s+m) \times (s+n)}
\]</span> with an attribute <code>order = c(m,n,s)</code> and a class
attribute <code>c('stsp','ratm')</code>.</p>
<p><strong>Notes</strong>:</p>
<ul>
<li>E.g. the elementary rational function <span class="math inline">\(c(z)=z^{-1}\)</span> does <em>not</em> have a
statespace realization of the above form.<br>
</li>
<li>Any of the integers <span class="math inline">\(m,n,s\)</span> may
be zero.</li>
<li>Many (algebraic) operations are very easy to implement in terms of
statespace representations. Therefore, the package is somewhat “biased”
towards statespace representations.</li>
</ul>
<p>The constructor for <code>stsp</code> objects is <code><a href="../reference/stsp.html">stsp()</a></code>.
For testing purposes one may use <code><a href="../reference/test_stsp.html">test_stsp()</a></code> to create
(random) rational matrices in statespace form.</p>
</div>
<div class="section level3">
<h3 id="power-series">Power Series<a class="anchor" aria-label="anchor" href="#power-series"></a>
</h3>
<p>Impulse response function or transfer function are also used for the
same object.</p>
<p>If the rational matrix <span class="math inline">\(c(z)\)</span> has
no pole at <span class="math inline">\(z=0\)</span>, then there exists a
power series expansion</p>
<p><span class="math display">\[
c(z) = k_0 + k_1 z^1 + k_2 z^2 + \cdots
\]</span> which converges in a (non-empty) circle around <span class="math inline">\(z=0\)</span>. The sequence of coefficients <span class="math inline">\((k_j \,|\, j \geq 0)\)</span> here is called
<em>impulse response function</em><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;This naming is chosen in regard to the connection
between rational matrices and VARMA processes and processes represented
by statespace models.&lt;/p&gt;"><sup>1</sup></a>.</p>
<p>An <code>pseries</code> object stores a finite sequence <span class="math inline">\((k_0,\ldots,k_l)\)</span> as <span class="math inline">\((m,n,(l+1))\)</span> dimensional array with a
class attribute <code>c('stsp','ratm')</code>.</p>
<p><strong>Note:</strong> Due to the rational structure, a
<em>finite</em> sequence of coefficients is sufficient to reconstruct
the rational matrix <span class="math inline">\(c(z)\)</span>, see
e.g. the Ho-Kalman realization algorithm implemented in
<code>pseries2stsp</code> and the function <code>pseries2lmfd</code>.
(Of course the number of coefficients has to be large enough.) Hence, we
can interpret (a finite) impulse response function as another way to
represent rational matrices.</p>
</div>
<div class="section level3">
<h3 id="frequency-response">Frequency Response<a class="anchor" aria-label="anchor" href="#frequency-response"></a>
</h3>
<p>A rational matrix is also uniquely determined by a (finite) set of
function values. An object of class <code>zvalues</code> is an <span class="math inline">\((m,n,k)\)</span> dimensional array (which stores
the values <span class="math inline">\(c(z_j)\)</span>, <span class="math inline">\(j=1,\ldots,k\)</span> together with an attribute
<code>z</code> (which is a vector with components <span class="math inline">\(z_j\)</span>, <span class="math inline">\(j=1,\ldots,k\)</span>) and a class attribute
<code>c('freqressp','ratm')</code>.</p>
<p>If the rational matrix represents the transfer function of a
(rational) filter, then often the matrix is evaluated at a grid of
points on the unit circle</p>
<p><span class="math display">\[
f_j = (j-1)/k,\qquad z_j = \exp(-i(2\pi  f_j)),\qquad j=1,\ldots,k
\]</span></p>
<p><strong>Notes</strong>:</p>
<ul>
<li>As stated above the rational function is uniquely determined from a
finite (but sufficiently rich) set of values. However, we have not
implemented an algorithm which computes an “LMFD” or “statespace”
representation for given frequency response.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="operations-and-methods">Operations and Methods<a class="anchor" aria-label="anchor" href="#operations-and-methods"></a>
</h2>
<div class="section level3">
<h3 id="general-methods">General Methods<a class="anchor" aria-label="anchor" href="#general-methods"></a>
</h3>
<ul>
<li>
<code>is.polm(x)</code>, <code>is.lmfd(x)</code>,
<code>is.stsp(x)</code>, <code>is.pseries(x)</code>,
<code>is.zvalues(x)</code> test whether the object <code>x</code> is a
valid (rational matrix) object.</li>
<li>
<code>dim(x)</code> returns a (named) vector with the dimensions of
the rational matrix object.</li>
<li>The <code>str</code> methods produces a one-line description of
rational matrix objects.</li>
<li>The <code>print</code> methods tries to produce a compact display of
the rational matrix object.</li>
<li>
<code>plot</code> methods are implemented for <code>pseries</code>
and <code>zvalues</code> objects.</li>
</ul>
</div>
<div class="section level3">
<h3 id="convert-from-class-x-to-class-y">Convert from Class <code>x</code> to Class <code>y</code><a class="anchor" aria-label="anchor" href="#convert-from-class-x-to-class-y"></a>
</h3>
<p>An essential goal of the package is to provide tools, which allow a
simple conversion of one representation (realization) to another.</p>
<p>The following table gives an overview of these “conversion”
procedures:</p>
<p><img src="a_rational_matrices_files/figure-html/unnamed-chunk-7-1.png" width="768"></p>
<p>The colors of the cells mean</p>
<ul>
<li>orange-red: does not make sense (in general)</li>
<li>light-steel-blue: use a two step procure, e.g
<code>as.lmfd(pseries(x, lag.max))</code>
</li>
<li>gold: not (yet) implemented</li>
</ul>
<p>The core procedures which compute an LMFD or statespace realization
for given impules reponse are described in the following subsection.
Some more information may be found in the vignette “technical
details”.</p>
<div class="section level4">
<h4 id="realization-algorithms">Realization Algorithms<a class="anchor" aria-label="anchor" href="#realization-algorithms"></a>
</h4>
<p>One of the characteristic features of rational functions is that the
Hankel matrix of the impulse response<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Note that the impulse response function is only well
defined if the rational matrix has no pole at &lt;span class="math inline"&gt;\(z=0\)&lt;/span&gt;.&lt;/p&gt;'><sup>2</sup></a> coefficients</p>
<p><span class="math display">\[
H = \begin{pmatrix}
k_1 &amp; k_2 &amp; \cdots \\
k_2 &amp; k_3 &amp; \cdots \\
\vdots &amp; \vdots &amp;
\end{pmatrix}
\]</span> has <em>finite</em> rank.</p>
<p>If the rational matrix <span class="math inline">\(k(z)\)</span> has
an LMFD representation <span class="math inline">\(k(z)=a^{-1}(z)b(z)\)</span>, <span class="math inline">\(a(z)=a_0 + a_1 z + \cdots + a_p z^p\)</span>,
<span class="math inline">\(b(z)=b_0 + b_1 z + \cdots + b_q z^q\)</span>
then</p>
<p><span class="math display">\[
a(z)(k(z)-k_0) = b(z) - a(z)k_0
\]</span> implies that</p>
<p><span class="math display">\[
a_0 k_l + a_1 k_{l-1} + \cdots + a_p k_{l-p} = 0 \mbox{ for }
l&gt;\max(p,q)
\]</span></p>
<p>This implies that the Hankel matrix indeed has finite rank and
furthermore that we can construct the matrix <span class="math inline">\(a(z)\)</span> from the left kernel of the Hankel
matrix. For given <span class="math inline">\(a()\)</span> and <span class="math inline">\(k()\)</span>, <span class="math inline">\(b(z)\)</span> follows from <span class="math inline">\(b(z)=a(z)k(z)\)</span>.</p>
<p>In order to describe the linear dependence structure of the rows of
<span class="math inline">\(H\)</span> it is convenient to use a
“double” index for the rows: Let <span class="math inline">\(h(i,j)\in
\mathbb{R}^{1\times \infty}\)</span> denote the <span class="math inline">\(j\)</span>-th row in the <span class="math inline">\(i\)</span>-th block row of <span class="math inline">\(H\)</span>, i.e. <span class="math inline">\(h(i,j)\)</span> is the <span class="math inline">\(((i-1)m+j)\)</span>-th row of <span class="math inline">\(H\)</span>.</p>
<p>A selection <span class="math inline">\(\mathcal{S}=\{h(i_k,j_k)
\,|\, k=1,\ldots ,s\}\)</span> of rows of the Hankel matrix is called a
<em>nice</em> selection, if there are no “holes” in the sense that <span class="math inline">\(h(i,j)\in \mathcal{S}\)</span>, <span class="math inline">\(i&gt;1\)</span> implies that <span class="math inline">\(h(i-1,j)\in \mathcal{S}\)</span>. Nice selections
may be described by a multi-index <span class="math inline">\(\nu =
(\nu_1, \ldots, \nu_m)\)</span>, where <span class="math inline">\(\nu_j=\max \{i\,|\,h(i,j)\in
\mathcal{S}\}\)</span>.</p>
<p>Suppose that <span class="math inline">\(H\)</span> has rank <span class="math inline">\(s\)</span>. In general there are many different
selections of rows of <span class="math inline">\(H\)</span> which form
a basis for the row space of <span class="math inline">\(H\)</span>. In
the following we choose the <em>first</em> <span class="math inline">\(s\)</span> rows of <span class="math inline">\(H\)</span> which form a basis of the row space and
denote the corresponding selection with <span class="math inline">\(\mathcal{S}=\{h(i_k,j_k) \,|\, k=1,\ldots
,s\}\)</span>. Due to the Hankel structure of <span class="math inline">\(H\)</span> this is a nice selection in the above
sense. The corresponding <span class="math inline">\(\nu_j\)</span>’s
are called <em>Kronecker indices</em> of the Hankel matrix (respectively
of the rational matrix <span class="math inline">\(k(\cdot)\)</span>).
Note that the sum of the Kronecker indices is equal to the rank of <span class="math inline">\(H\)</span>: <span class="math inline">\(\sum_{j=1}^m \nu _j = s\)</span>.</p>
<p>For a given (nice) selection of basis rows, one may construct a
unique LMFD representation of the rational matrix. In particular, if we
choose the above described “canonical” basis then one obtains the so
called <em>echelon form</em> left matrix fraction description of the
rational matrix. This procedure is implemented in the tool
<code><a href="../reference/pseries2lmfd.html">pseries2lmfd()</a></code>. The <code>S3</code> method
<code><a href="../reference/as.lmfd.html">as.lmfd.pseries()</a></code> is just a wrapper function, which calls
<code><a href="../reference/pseries2lmfd.html">pseries2lmfd()</a></code> with some default parameters.</p>
<p>Quite analogously one may also construct a statespace realization of
<span class="math inline">\(k(\cdot)\)</span> with the
<em>Ho-Kalman</em> algorithm. See the tools <code><a href="../reference/pseries2stsp.html">pseries2stsp()</a></code>
and <code><a href="../reference/as.stsp.html">as.stsp.pseries()</a></code>.</p>
<p>For a more detailed discussion on Kronecker indices and echelon
canonical forms, see <span class="citation">@Hannan.Deistler12</span>.</p>
</div>
<div class="section level4">
<h4 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h4>
<p>We first create a random <span class="math inline">\((2 \times
2)\)</span> rational matrix in statespace form with a state dimension
<span class="math inline">\(s=5\)</span>. Generically the first <span class="math inline">\(s\)</span> rows of the Hankel matrix form a basis
and hence the Kronecker indices are <span class="math inline">\(\nu_1 =
3\)</span> and <span class="math inline">\(\nu_2=2\)</span>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a random rational matrix in statespace form</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="../reference/test_stsp.html">test_stsp</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, s <span class="op">=</span> <span class="fl">5</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">X</span></span>
<span><span class="co">#&gt; statespace realization [2,2] with s = 5 states</span></span>
<span><span class="co">#&gt;       s[1]  s[2]  s[3]  s[4]  s[5]  u[1]  u[2]</span></span>
<span><span class="co">#&gt; s[1] -0.35  0.43 -1.05 -2.39  2.21  1.16  1.26</span></span>
<span><span class="co">#&gt; s[2]  1.02 -0.63 -0.77  0.48  0.07 -0.23  0.20</span></span>
<span><span class="co">#&gt; s[3]  0.19  0.94 -1.37  0.86 -0.18  1.31 -1.33</span></span>
<span><span class="co">#&gt; s[4] -0.82  1.04  1.90 -1.05 -0.40 -0.14  0.00</span></span>
<span><span class="co">#&gt; s[5]  0.39  0.23  0.78  0.86 -1.85  0.74  0.32</span></span>
<span><span class="co">#&gt; x[1]  0.56  1.66 -1.39 -0.09  0.92  1.00  0.00</span></span>
<span><span class="co">#&gt; x[2]  0.73 -2.23 -1.21  0.65  1.09  0.00  1.00</span></span>
<span></span>
<span><span class="co"># compute the impulse response function,</span></span>
<span><span class="co"># the Kornecker indices and the corresponding indices of the "basis" rows.</span></span>
<span><span class="va">K</span> <span class="op">=</span> <span class="fu"><a href="../reference/pseries.html">pseries</a></span><span class="op">(</span><span class="va">X</span>, lag.max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">nu</span> <span class="op">=</span> <span class="fu"><a href="../reference/Kronecker-Indices.html">pseries2nu</a></span><span class="op">(</span><span class="va">K</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'Kronecker indices: '</span>, <span class="va">nu</span>,<span class="st">'\n'</span>,</span>
<span>    <span class="st">'      basis rows: '</span>, <span class="fu"><a href="../reference/Kronecker-Indices.html">nu2basis</a></span><span class="op">(</span><span class="va">nu</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Kronecker indices:  3 2 </span></span>
<span><span class="co">#&gt;        basis rows:  1 2 3 4 5</span></span></code></pre></div>
<p>Next we take the impulse response function and compute a statespace
realization of this rational matrix in echelon form:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="../reference/pseries2stsp.html">pseries2stsp</a></span><span class="op">(</span><span class="va">K</span>, method <span class="op">=</span> <span class="st">'echelon'</span><span class="op">)</span><span class="op">$</span><span class="va">Xs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">X</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; statespace realization [2,2] with s = 5 states</span></span>
<span><span class="co">#&gt;       s[1]  s[2]  s[3]  s[4]  s[5]  u[1]  u[2]</span></span>
<span><span class="co">#&gt; s[1]  0.00  0.00  1.00  0.00  0.00 -0.86  3.18</span></span>
<span><span class="co">#&gt; s[2]  0.00  0.00  0.00  1.00  0.00  0.49  2.43</span></span>
<span><span class="co">#&gt; s[3]  0.00  0.00  0.00  0.00  1.00  3.23  0.90</span></span>
<span><span class="co">#&gt; s[4] -3.17 -3.52 -1.21 -4.29 -0.11  2.53 -9.75</span></span>
<span><span class="co">#&gt; s[5] -3.94 -3.03  1.04 -2.51 -0.96 -2.63  2.83</span></span>
<span><span class="co">#&gt; x[1]  1.00  0.00  0.00  0.00  0.00  1.00  0.00</span></span>
<span><span class="co">#&gt; x[2]  0.00  1.00  0.00  0.00  0.00  0.00  1.00</span></span>
<span></span>
<span><span class="co"># check the result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="../reference/pseries.html">pseries</a></span><span class="op">(</span><span class="va">X</span>, lag.max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, <span class="va">K</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>We may also create a rational matrix with prescribed Kronecker
indices. Here we generate a <span class="math inline">\((3\times
2)\)</span> matrix with Kronecker indices <span class="math inline">\(\nu =(2,3,1)\)</span> and in addition we demand
that the matrix is stable. i.e. the matrix no poles inside the unit
circle:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nu</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="../reference/test_stsp.html">test_stsp</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span>, nu <span class="op">=</span> <span class="va">nu</span>, D <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="cn">NA</span>,<span class="cn">NA</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="cn">NA</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>              digits <span class="op">=</span> <span class="fl">2</span>, bpoles <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">X</span></span>
<span><span class="co">#&gt; statespace realization [3,2] with s = 6 states</span></span>
<span><span class="co">#&gt;       s[1] s[2]  s[3] s[4]  s[5] s[6]  u[1]  u[2]</span></span>
<span><span class="co">#&gt; s[1]  0.00 0.00  0.00 1.00  0.00 0.00  1.47 -0.02</span></span>
<span><span class="co">#&gt; s[2]  0.00 0.00  0.00 0.00  1.00 0.00 -1.51 -0.21</span></span>
<span><span class="co">#&gt; s[3] -0.06 0.16  0.50 1.11 -0.67 0.00 -0.32 -0.70</span></span>
<span><span class="co">#&gt; s[4] -0.24 0.58  0.26 0.23 -0.42 0.00 -1.75 -0.45</span></span>
<span><span class="co">#&gt; s[5]  0.00 0.00  0.00 0.00  0.00 1.00 -0.52 -0.44</span></span>
<span><span class="co">#&gt; s[6]  0.59 0.23 -0.19 0.82 -0.13 0.53 -1.13  0.93</span></span>
<span><span class="co">#&gt; x[1]  1.00 0.00  0.00 0.00  0.00 0.00  1.00  0.00</span></span>
<span><span class="co">#&gt; x[2]  0.00 1.00  0.00 0.00  0.00 0.00  0.61  1.00</span></span>
<span><span class="co">#&gt; x[3]  0.00 0.00  1.00 0.00  0.00 0.00  0.80  0.55</span></span>
<span></span>
<span><span class="co"># compute impulse response</span></span>
<span><span class="va">K</span> <span class="op">=</span> <span class="fu"><a href="../reference/pseries.html">pseries</a></span><span class="op">(</span><span class="va">X</span>, lag.max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co"># and check the Kronecker indices</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="../reference/Kronecker-Indices.html">pseries2nu</a></span><span class="op">(</span><span class="va">K</span><span class="op">)</span>, <span class="va">nu</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>An LMFD realization of this matrix <span class="math inline">\(X\)</span> is obtained a s follows</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="../reference/pseries2lmfd.html">pseries2lmfd</a></span><span class="op">(</span><span class="va">K</span><span class="op">)</span><span class="op">$</span><span class="va">Xl</span></span>
<span><span class="va">X</span></span>
<span><span class="co">#&gt; ( 3 x 2 ) left matrix fraction description a^(-1)(z) b(z) with degrees (p = 3, q = 3)</span></span>
<span><span class="co">#&gt; left factor a(z):</span></span>
<span><span class="co">#&gt;      z^0 [,1]  [,2]  [,3] z^1 [,1]  [,2]  [,3] z^2 [,1]  [,2]  [,3] z^3 [,1]</span></span>
<span><span class="co">#&gt; [1,]     1.00  0.00     0    -0.23  0.42   0.0     0.24 -0.58 -0.26     0.00</span></span>
<span><span class="co">#&gt; [2,]     0.00  1.00     0     0.00 -0.53   0.0    -0.82  0.13  0.00    -0.59</span></span>
<span><span class="co">#&gt; [3,]    -1.11  0.67     1     0.06 -0.16  -0.5     0.00  0.00  0.00     0.00</span></span>
<span><span class="co">#&gt;       [,2]  [,3]</span></span>
<span><span class="co">#&gt; [1,]  0.00  0.00</span></span>
<span><span class="co">#&gt; [2,] -0.23  0.19</span></span>
<span><span class="co">#&gt; [3,]  0.00  0.00</span></span>
<span><span class="co">#&gt; right factor b(z):</span></span>
<span><span class="co">#&gt;      z^0 [,1]  [,2] z^1 [,1]    [,2] z^2 [,1]    [,2] z^3 [,1]   [,2]</span></span>
<span><span class="co">#&gt; [1,]   1.0000  0.00   1.4962  0.4000  -3.0441 -1.2566   0.0000 0.0000</span></span>
<span><span class="co">#&gt; [2,]   0.6100  1.00  -1.8333 -0.7400  -0.4604 -0.1987  -2.8344 1.0268</span></span>
<span><span class="co">#&gt; [3,]   0.0987  1.22  -3.4010 -1.2535   0.0000  0.0000   0.0000 0.0000</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="../reference/pseries.html">pseries</a></span><span class="op">(</span><span class="va">X</span>, lag.max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, <span class="va">K</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>The set <span class="math inline">\((1,2,3,5,6,7)\)</span> does
<em>not</em> correspond to a nice selection of rows of a Hankel matrix
(with <span class="math inline">\(m=3\)</span>). The corresponding set
of rows (using the above described “double indices”) is <span class="math inline">\(\mathcal{S}=\{h(1,1),h(1,2),h(1,3),h(2,2),h(2,3),h(3,1)\}\)</span>.
The set <span class="math inline">\(\mathcal{S}\)</span> contains the
row <span class="math inline">\(h(3,1)\)</span> but not the row <span class="math inline">\(h(2,1)\)</span> and hence it is not a nice
selection. Therefore the function <code>basis2nu</code> throws an error,
if we try to compute the correponding Kronecker indices:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">basis</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">nu</span> <span class="op">=</span> <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/Kronecker-Indices.html">basis2nu</a></span><span class="op">(</span><span class="va">basis</span>, m<span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in basis2nu(basis, m = 3) : </span></span>
<span><span class="co">#&gt;   This is not a nice basis, i.e. there are holes.</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="arithmetics">Arithmetics<a class="anchor" aria-label="anchor" href="#arithmetics"></a>
</h3>
<p>The group method function <code><a href="../reference/Ops.ratm.html">Ops.ratm()</a></code> allows to perform
arithmetic operations on rational matrices using ordinary arithmetic
operators.</p>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="the-unary-operators-a-and--a">The Unary Operators <code>+a</code> and
<code>-a</code><a class="anchor" aria-label="anchor" href="#the-unary-operators-a-and--a"></a>
</h4>
<p>These operators have the usual meaning and are implemented for all
rational matrix classes.</p>
</div>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="the-power-operator-ak">The Power Operator <code>a^k</code><a class="anchor" aria-label="anchor" href="#the-power-operator-ak"></a>
</h4>
<p>The power operator <code>a^k</code> is only implemented for square,
rational matrices <span class="math inline">\(a(z)\)</span> and integers
<span class="math inline">\(k \in \mathbb{Z}\)</span>.</p>
<ul>
<li>
<code>a^0</code> works for all classes and returns the identity
matrix, represented by an object of the same class as the input argument
<code>a</code>. <strong>Note:</strong> This means e.g. <span class="math inline">\(0^0 = 1\)</span>!</li>
<li>
<code>a^1</code> works for all classes and simply returns the input
argument <code>a</code>.</li>
<li>
<code>a^k</code> for <span class="math inline">\(k&gt;1\)</span> is
implemented for all classes. However <code>lmfd</code> objects are first
coerced to statespace realizations. Thus the result in this case is an
object of class <code>stsp</code>. In all other cases, the result is of
the same class as the input argument <code>a</code>.</li>
<li>
<code>a^k</code> for <span class="math inline">\(k&lt;0\)</span> is
implemented for all classes. However, <span class="math inline">\(a\)</span> must be non empty and objects of class
<code>polm</code> and <code>lmfd</code> are first coerced to
<code>stsp</code> objects. This means that the result has class
<code>stsp</code> if the input is a <code>polm</code>, <code>lmfd</code>
or <code>stsp</code> object and it has class <code>pseries</code> or
<code>zvalues</code> if the input is an <code>pseries</code>
respectively <code>zvalues</code> object.</li>
</ul>
</div>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="binary-operators">Binary Operators<a class="anchor" aria-label="anchor" href="#binary-operators"></a>
</h4>
<p>For the binary operators (like ‘a + b’) the two arguments are first
coerced to a common class. To this end we use the following pseudo
ordering of classes:</p>
<p><code>matrix</code> <span class="math inline">\(\;\prec\;\)</span>
<code>polm</code> <span class="math inline">\(\;\prec\;\)</span>
<code>lmfd</code> <span class="math inline">\(\;\prec\;\)</span>
<code>stsp</code> <span class="math inline">\(\;\prec\;\)</span>
<code>pseries</code> <span class="math inline">\(\;\prec\;\)</span>
<code>zvalues</code></p>
<p>The following table shows how the class of the result depends on the
classes of <code>a</code> and <code>b</code>:</p>
<p><img src="a_rational_matrices_files/figure-html/unnamed-chunk-13-1.png" width="480"></p>
<p><strong>Note:</strong></p>
<ul>
<li>Objects which are not “rational matrices” are first coerced to
<code>polm</code> objects. If this fails an error is thrown. In the
above table this case is represented by the label
<code>matrix</code>.</li>
<li>
<code>lmfd</code> objects are first coerced to <code>stsp</code>
objects.</li>
<li>If two <code>pseries</code> objects are combined then they are
truncated to the minimum of the respective number of “lags”.</li>
<li>Two <code>zvalues</code> objects are only combined if the “z” values
are identical. Otherwise an error is thrown.</li>
<li>The statespace realizations computed are in general <em>not
minimal</em>. This remark also applies to other operations, like the
power <code>a^k</code>.</li>
<li>Of course the two arguments must be compatible, e.g. for elementwise
operations they must have the same number of rows and columns. However
for elementwise operations one of the arguments may be a scalar, i.e. a
<span class="math inline">\((1 \times 1)\)</span> matrix. Such arguments
are “expanded” to matrices (of compatible dimension) with identical
elements.</li>
<li>There is no automatic coercion of <code>pseries</code> objects to
<code>zvalues</code> objects, since there is no guarantee that the
<code>pseries</code> object has sufficiently many lags. Of course the
user may perform this coercion manually.</li>
</ul>
<p>The above table applies for</p>
<ul>
<li>addition <code>a+b</code>
</li>
<li>substraction <code>a-b</code>
</li>
<li>elementwise multiplication <code>a * b</code>
</li>
<li>matrix multiplication <code>a %r% b</code>
</li>
<li>bind operations <code>rbind(a,b,...)</code> and
<code>cbind(a,b,...)</code>
</li>
</ul>
<p>The polynomial division and remainder operators <code>a %/% b</code>
and <code>a %% b</code> are only implemented for <code>polm</code>
objects or objects which may coerced to <code>polm</code> objects. These
operations are also elementwise operations and hence the above remark on
scalar arguments applies here.</p>
</div>
</div>
<div class="section level3">
<h3 id="transposition-of-rational-matrices">Transposition of Rational Matrices<a class="anchor" aria-label="anchor" href="#transposition-of-rational-matrices"></a>
</h3>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="ordinary-transpose-xz">“Ordinary” transpose <span class="math inline">\(x'(z)\)</span><a class="anchor" aria-label="anchor" href="#ordinary-transpose-xz"></a>
</h4>
<p>The transposition operator (function) <code>t(x)</code> is
implemented for all classes, except for <code>lmfd</code> objects,
i.e. rational matrices in LMFD form (and should work as expected).</p>
<p>As an example consider the construction of a <em>Right Matrix
Fraction Description</em> of a rational matrix <span class="math inline">\(x(z) = b(z)a^{-1}(z)\)</span>. The trick is simply
to construct an LMFD of the transpose <span class="math inline">\(x'(z) = \hat{a}^{-1}(z) \hat{b}(z)\)</span>,
then <span class="math inline">\(\hat{b}'(z)(\hat{a}')^{-1}(z) =
x(z)\)</span> is the desired RMFD of <span class="math inline">\(x(z)\)</span>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create random rational, stable, (3 x 2) matrix in statespace form</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="../reference/test_stsp.html">test_stsp</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span>, s <span class="op">=</span> <span class="fl">2</span>, bpoles <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># compute the impulse response</span></span>
<span><span class="va">k</span> <span class="op">=</span> <span class="fu"><a href="../reference/pseries.html">pseries</a></span><span class="op">(</span><span class="va">x</span>, lag.max <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute an LMFD realization of the transpose</span></span>
<span><span class="va">tx</span> <span class="op">=</span> <span class="fu"><a href="../reference/as.lmfd.html">as.lmfd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">tx</span><span class="op">$</span><span class="va">a</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">tx</span><span class="op">$</span><span class="va">b</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># check</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="../reference/zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="../reference/zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="op">(</span><span class="fu"><a href="../reference/zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">^</span><span class="op">{</span><span class="op">-</span><span class="fl">1</span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="hermitean-transpose-xz">Hermitean transpose <span class="math inline">\(x^*(z)\)</span><a class="anchor" aria-label="anchor" href="#hermitean-transpose-xz"></a>
</h4>
<ul>
<li>
<p>The Hermitean transpose <code>Ht(x)</code> is only implemented
for frequency response objects and statespace realizations with a
regular state transition matrix <span class="math inline">\(A\)</span>.<br>
The Hermitean transpose of a rational matrix <span class="math inline">\(a(z)\)</span> is defined as <span class="math display">\[
a^*(z) = \overline{a(\bar{z}^{-1})}'
\]</span> If <span class="math inline">\(a(z)\)</span> has real
coefficients and <span class="math inline">\(|z|=1\)</span> then <span class="math inline">\(a^*(z)=\overline{a(z)}'\)</span>.</p>
<p>As an example consider <span class="math display">\[
a(z) = \frac{1+0.5z}{1+0.1z+0.1z^2+0.1z^3-0.8z^4}
\]</span></p>
</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="../reference/as.stsp.html">as.stsp</a></span><span class="op">(</span><span class="fu"><a href="../reference/lmfd.html">lmfd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="op">-</span><span class="fl">0.8</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; statespace realization [1,1] with s = 4 states</span></span>
<span><span class="co">#&gt;      s[1] s[2] s[3] s[4]    u[1]</span></span>
<span><span class="co">#&gt; s[1] -0.1 -0.1 -0.1  0.8  0.7866</span></span>
<span><span class="co">#&gt; s[2]  1.0  0.0  0.0  0.0 -0.1260</span></span>
<span><span class="co">#&gt; s[3]  0.0  1.0  0.0  0.0 -0.1400</span></span>
<span><span class="co">#&gt; s[4]  0.0  0.0  1.0  0.0  0.4000</span></span>
<span><span class="co">#&gt; x[1]  0.0  0.0  0.0  1.0  1.0000</span></span>
<span></span>
<span><span class="va">fr</span> <span class="op">=</span> <span class="fu"><a href="../reference/zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">a</span>, n.f <span class="op">=</span> <span class="fl">101</span><span class="op">)</span></span>
<span><span class="va">sp</span> <span class="op">=</span> <span class="va">fr</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="fu"><a href="../reference/Ht.html">Ht</a></span><span class="op">(</span><span class="va">fr</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Im</a></span><span class="op">(</span><span class="va">sp</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">sp</span>, <span class="fu"><a href="../reference/zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">a</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="fu"><a href="../reference/Ht.html">Ht</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>, n.f <span class="op">=</span> <span class="fl">101</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sp</span><span class="op">)</span></span></code></pre></div>
<p><img src="a_rational_matrices_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>The Hermitean transpose plays an important role for the <em>spectral
density</em> of VARMA processes and processes which are defined via
statespace models.</p>
</div>
</div>
<div class="section level3">
<h3 id="bind-rational-matrices-by-rows-and-columns">Bind Rational Matrices by Rows and Columns<a class="anchor" aria-label="anchor" href="#bind-rational-matrices-by-rows-and-columns"></a>
</h3>
<p>The methods</p>
<ul>
<li>
<code>rbind(...)</code> and</li>
<li><code>cbind(...)</code></li>
</ul>
<p>have their usual meaning, i.e. they take a list of rational matrix
objects and combine them by rows or columns. Before the matrices are
combined they are coerced to objects of the same class, as described in
the section on arithmetic operations. In particular note that
<code>lmfd</code> objects are coerced to <code>stsp</code> objects!
Howver, if only one argument is given then no coercion is performed,
i.e. if <code>x</code> is an <code>lmfd</code> object then
<code>bind(x)</code> returns an <code>lmfd</code> object.</p>
<p>Note that the statespace realizations in general are
<strong>not</strong> minimal. The number of lags for
<code>pseries</code> objects is the minimum of the number of lags of
each of them. Objects of class <code>zvalues</code> are only combined if
their <code>z</code> attributes (the complex points where the rational
function(s) have been evaluated) are identical.</p>
</div>
<div class="section level3">
<h3 id="extract-parts-replace-parts">Extract Parts, Replace Parts<a class="anchor" aria-label="anchor" href="#extract-parts-replace-parts"></a>
</h3>
<p>The subsetting operation <code>x[,]</code> for rational matrices
works analogously to the subsetting of ordinary matrices. The result is
an object of the same class. However, this operator is not implemented
for <code>lmfd</code> objects. Hence <code>x[i,j]</code> throws an error
if <code>x</code> is an <code>lmfd</code> object!</p>
<ul>
<li>
<code>x[]</code> and <code>x[,]</code> simply return the object
<code>x</code>.</li>
<li>
<code>x[i]</code> returns an <span class="math inline">\((s,1)\)</span> dimensional matrix with elements
selected by the index <code>i</code>.</li>
<li>
<code>x[i,j]</code> returns a matrix with rows selected by
<code>i</code> and columns selected by <code>j</code>.</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="../reference/test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, degree <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">x</span></span>
<span><span class="co">#&gt; ( 2 x 3 ) matrix polynomial with degree &lt;= 2 </span></span>
<span><span class="co">#&gt;      z^0 [,1]  [,2]  [,3] z^1 [,1]  [,2]  [,3] z^2 [,1]  [,2]  [,3]</span></span>
<span><span class="co">#&gt; [1,]      110   120   130      111   121   131      112   122   132</span></span>
<span><span class="co">#&gt; [2,]      210   220   230      211   221   231      212   222   232</span></span>
<span><span class="va">x</span><span class="op">[</span>,<span class="op">]</span></span>
<span><span class="co">#&gt; ( 2 x 3 ) matrix polynomial with degree &lt;= 2 </span></span>
<span><span class="co">#&gt;      z^0 [,1]  [,2]  [,3] z^1 [,1]  [,2]  [,3] z^2 [,1]  [,2]  [,3]</span></span>
<span><span class="co">#&gt; [1,]      110   120   130      111   121   131      112   122   132</span></span>
<span><span class="co">#&gt; [2,]      210   220   230      211   221   231      212   222   232</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">6</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; ( 3 x 1 ) matrix polynomial with degree &lt;= 2 </span></span>
<span><span class="co">#&gt;      z^0 [,1] z^1 [,1] z^2 [,1]</span></span>
<span><span class="co">#&gt; [1,]      110      111      112</span></span>
<span><span class="co">#&gt; [2,]      210      211      212</span></span>
<span><span class="co">#&gt; [3,]      230      231      232</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; ( 2 x 3 ) matrix polynomial with degree &lt;= 2 </span></span>
<span><span class="co">#&gt;      z^0 [,1]  [,2]  [,3] z^1 [,1]  [,2]  [,3] z^2 [,1]  [,2]  [,3]</span></span>
<span><span class="co">#&gt; [1,]      220   220   220      221   221   221      222   222   222</span></span>
<span><span class="co">#&gt; [2,]      120   120   120      121   121   121      122   122   122</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="../reference/test_stsp.html">test_stsp</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>, s <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="co"># the statements pseries(x[c(2,4)]) and pseries(x)[c(2,4)] are equivalent</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="../reference/pseries.html">pseries</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="../reference/pseries.html">pseries</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="../reference/test_lmfd.html">test_lmfd</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, degrees <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="op">]</span><span class="op">)</span>  <span class="co"># throws an error</span></span>
<span><span class="co">#&gt; ( 2 x 3 ) left matrix fraction description a^(-1)(z) b(z) with degrees (p = 1, q = 1)</span></span>
<span><span class="co">#&gt; left factor a(z):</span></span>
<span><span class="co">#&gt;      z^0 [,1]  [,2] z^1 [,1]       [,2]</span></span>
<span><span class="co">#&gt; [1,]        1     0 1.103029 -1.3916966</span></span>
<span><span class="co">#&gt; [2,]        0     1 1.037564  0.1413492</span></span>
<span><span class="co">#&gt; right factor b(z):</span></span>
<span><span class="co">#&gt;      z^0 [,1]     [,2]      [,3]   z^1 [,1]       [,2]      [,3]</span></span>
<span><span class="co">#&gt; [1,] 1.396792 1.102716 0.6893530 -0.9366515 -1.7307931 1.2415333</span></span>
<span><span class="co">#&gt; [2,] 1.477923 2.094810 0.2146849  0.2121534  0.8942118 0.2735926</span></span></code></pre></div>
<p>The <code>$</code> operator may be used to extract the <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>
polynomial of a left matrix fraction description (<code>lmfd</code>
object) and the matrices <span class="math inline">\(A,B,C,D\)</span> of
a state space representation (<code>stsp</code> object).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># extract a(z) polynomial</span></span>
<span><span class="va">x</span><span class="op">$</span><span class="va">a</span></span>
<span><span class="co">#&gt; ( 2 x 2 ) matrix polynomial with degree &lt;= 1 </span></span>
<span><span class="co">#&gt;      z^0 [,1]  [,2] z^1 [,1]       [,2]</span></span>
<span><span class="co">#&gt; [1,]        1     0 1.103029 -1.3916966</span></span>
<span><span class="co">#&gt; [2,]        0     1 1.037564  0.1413492</span></span></code></pre></div>
<p>The assigment operation <code>x[,] &lt;- value</code> is only
implemented for polynomial matrices and works quite analogously to the
assigment operation of “ordinary” matrices.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="../reference/test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span>, degree <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">a</span>, format <span class="op">=</span> <span class="st">'c'</span><span class="op">)</span></span>
<span><span class="co">#&gt; ( 3 x 2 ) matrix polynomial with degree &lt;= 1 </span></span>
<span><span class="co">#&gt;             [,1]        [,2]</span></span>
<span><span class="co">#&gt; [1,]  110 + 111z  120 + 121z</span></span>
<span><span class="co">#&gt; [2,]  210 + 211z  220 + 221z</span></span>
<span><span class="co">#&gt; [3,]  310 + 311z  320 + 321z</span></span>
<span></span>
<span><span class="co"># no items to replace, a is not changed</span></span>
<span><span class="va">a</span><span class="op">[</span><span class="cn">FALSE</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span>   </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">a</span>, format <span class="op">=</span> <span class="st">'c'</span><span class="op">)</span></span>
<span><span class="co">#&gt; ( 3 x 2 ) matrix polynomial with degree &lt;= 1 </span></span>
<span><span class="co">#&gt;             [,1]        [,2]</span></span>
<span><span class="co">#&gt; [1,]  110 + 111z  120 + 121z</span></span>
<span><span class="co">#&gt; [2,]  210 + 211z  220 + 221z</span></span>
<span><span class="co">#&gt; [3,]  310 + 311z  320 + 321z</span></span>
<span></span>
<span><span class="co"># set elements below the diagonal equal to zero</span></span>
<span><span class="va">a</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">a</span>, format <span class="op">=</span> <span class="st">'c'</span><span class="op">)</span></span>
<span><span class="co">#&gt; ( 3 x 2 ) matrix polynomial with degree &lt;= 1 </span></span>
<span><span class="co">#&gt;             [,1]        [,2]</span></span>
<span><span class="co">#&gt; [1,]  110 + 111z  120 + 121z</span></span>
<span><span class="co">#&gt; [2,]           0  220 + 221z</span></span>
<span><span class="co">#&gt; [3,]           0           0</span></span>
<span></span>
<span><span class="co"># set (3,1) element</span></span>
<span><span class="va">a</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">a</span>, format <span class="op">=</span> <span class="st">'c'</span><span class="op">)</span></span>
<span><span class="co">#&gt; ( 3 x 2 ) matrix polynomial with degree &lt;= 1 </span></span>
<span><span class="co">#&gt;             [,1]        [,2]</span></span>
<span><span class="co">#&gt; [1,]  110 + 111z  120 + 121z</span></span>
<span><span class="co">#&gt; [2,]           0  220 + 221z</span></span>
<span><span class="co">#&gt; [3,]       1 - z           0</span></span>
<span></span>
<span><span class="co"># set the elements in the first two rows and columns</span></span>
<span><span class="va">a</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>                    dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">a</span>, format <span class="op">=</span> <span class="st">'c'</span><span class="op">)</span></span>
<span><span class="co">#&gt; ( 3 x 2 ) matrix polynomial with degree &lt;= 3 </span></span>
<span><span class="co">#&gt;        [,1]  [,2]</span></span>
<span><span class="co">#&gt; [1,]    z^2     1</span></span>
<span><span class="co">#&gt; [2,]    z^3     z</span></span>
<span><span class="co">#&gt; [3,]  1 - z     0</span></span>
<span></span>
<span><span class="co"># this produces a warning,  </span></span>
<span><span class="co"># left hand side refers to 3 elements but</span></span>
<span><span class="co"># the right hand side has 2 elements!</span></span>
<span><span class="va">a</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="../reference/test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, degree <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in `[&lt;-.polm`(`*tmp*`, , 1, value = structure(c(110, 210, 111, 211, :</span></span>
<span><span class="co">#&gt; number of items to replace is not a multiple of replacement length</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">a</span>, format <span class="op">=</span> <span class="st">'c'</span><span class="op">)</span></span>
<span><span class="co">#&gt; ( 3 x 2 ) matrix polynomial with degree &lt;= 4 </span></span>
<span><span class="co">#&gt;                                        [,1]  [,2]</span></span>
<span><span class="co">#&gt; [1,]  110 + 111z + 112z^2 + 113z^3 + 114z^4     1</span></span>
<span><span class="co">#&gt; [2,]  210 + 211z + 212z^2 + 213z^3 + 214z^4     z</span></span>
<span><span class="co">#&gt; [3,]  110 + 111z + 112z^2 + 113z^3 + 114z^4     0</span></span></code></pre></div>
<p><strong>Note:</strong> The subsetting and the assigment operators do
not allow “named” arguments. Therefore the following statements throw an
error</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="va">a</span><span class="op">[</span>i<span class="op">=</span><span class="fl">1</span>, j<span class="op">=</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in `[.polm`(a, i = 1, j = 2) : named dimensions are not supported</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="va">a</span><span class="op">[</span>i<span class="op">=</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in `[&lt;-.polm`(`*tmp*`, i = 1, value = 1) : </span></span>
<span><span class="co">#&gt;   named dimensions are not supported</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="poles-and-zeroes">Poles and Zeroes<a class="anchor" aria-label="anchor" href="#poles-and-zeroes"></a>
</h3>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="polynomials">Polynomials<a class="anchor" aria-label="anchor" href="#polynomials"></a>
</h4>
<p>The zeroes of a square (<span class="math inline">\(m\times
m\)</span>)-dimensional, non singular polynomial matrix <span class="math inline">\(a(z)=a_0+a_1z+\cdots a_p z^p\)</span>, with <span class="math inline">\(\det(a_0)\neq 0\)</span> are the reciprocals of
the non zero eigenvalues of the companion matrix</p>
<p><span class="math display">\[
A = \begin{pmatrix}
-a_0^{-1}a_1 &amp; \cdots &amp; -a_0^{-1} a_{p-1} &amp; -a_0^{-1} a_p \\
I_m          &amp; \cdots &amp; 0                 &amp;          0    \\
\vdots       &amp; \ddots &amp; \vdots            &amp;     \vdots    \\
0            &amp; \cdots &amp; I_m               &amp;           0
\end{pmatrix} \in \mathbb{R}^{mp\times mp}
\]</span></p>
<p>This fact is used by <code>zeroes.polm</code>. However, there are
some problems with this (simple) approach.</p>
<ul>
<li>It does not work for polynomials with a zero at <span class="math inline">\(z=0\)</span> (<span class="math inline">\(a_0\)</span> is singular). An alternative is to
use the function <code>is.coprime</code> which uses a (singular) pencil.
See the examples below.</li>
<li>Due to numerical errors the function <code>eigen</code> (which is
used to compute the eigenvalues of the companion matrix) may return some
(very small) eigenvalues instead of exact zeroes. The function
<code>zeroes.polm</code> therefore skips all eigenvalues which are
smaller than a certain threshold. If the option
<code>print_message</code> is set to <code>TRUE</code> then a
corresponding message is printed. Clearly, choosing a too small
tolerance bound may result in some very large “spurious”” zeroes. On the
other hand if the bound is too large, then some of the “true” zeroes may
be skipped.</li>
</ul>
<p>To summarize. There are numerical problems if the coefficient <span class="math inline">\(a_0\)</span> is ill conditioned or if the
companion matrix <span class="math inline">\(A\)</span> is (close to)
singular.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># polynomial with degree p = 0 ##############################</span></span>
<span><span class="fu"><a href="../reference/poles_and_zeroes.html">zeroes</a></span><span class="op">(</span><span class="fu"><a href="../reference/polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  <span class="co"># returns empty vector</span></span>
<span><span class="co">#&gt; numeric(0)</span></span>
<span></span>
<span><span class="co"># (2 x 2) polynomial with degree 2 ##########################</span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="../reference/test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, degree <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">z</span> <span class="op">=</span> <span class="fu"><a href="../reference/poles_and_zeroes.html">zeroes</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.5-0.8660254i -0.5+0.8660254i -0.5-0.8660254i -0.5+0.8660254i</span></span>
<span></span>
<span><span class="co"># check the rank of a(z) at the computed zeroes</span></span>
<span><span class="va">az</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span><span class="fu"><a href="../reference/zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">z</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">az</span>, MARGIN <span class="op">=</span> <span class="fl">3</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="va">d</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">d</span>; <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5.368273e-14 5.368273e-14 5.364620e-14 5.364620e-14</span></span>
<span></span>
<span><span class="co"># (2 x 2) polynomial with degree 2 ##########################</span></span>
<span><span class="co"># and singular coefficient matrix a[2]</span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="../reference/test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, degree <span class="op">=</span> <span class="fl">2</span>,</span>
<span>               col_end_matrix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="op">(</span><span class="va">z</span> <span class="op">=</span> <span class="fu"><a href="../reference/poles_and_zeroes.html">zeroes</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.5-0.8660254i -0.5+0.8660254i -0.5-0.8660254i -0.5+0.8660254i</span></span>
<span></span>
<span><span class="co"># alternatively, we may also use is.coprime()</span></span>
<span><span class="fu"><a href="../reference/is.coprime.html">is.coprime</a></span><span class="op">(</span><span class="va">a</span>, only.answer <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">zeroes</span></span>
<span><span class="co">#&gt; [1] -0.5+0.8660254i -0.5-0.8660254i -0.5+0.8660254i -0.5-0.8660254i</span></span>
<span></span>
<span><span class="co"># (2x2) polynomial matrix with degree 2 #####################</span></span>
<span><span class="co"># and singular coefficient matrix a[0]</span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="../reference/polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="../reference/dbind.html">dbind</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>                      <span class="fu"><a href="../reference/test_array.html">test_array</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># zeroes(a) throws an error!</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/poles_and_zeroes.html">zeroes</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in zeroes.polm(a) : </span></span>
<span><span class="co">#&gt;   Could not generate companion matrix. Coefficient pertaining to smallest degree might be singular.</span></span>
<span></span>
<span><span class="co"># However, we may use is.coprime() in this case</span></span>
<span><span class="fu"><a href="../reference/is.coprime.html">is.coprime</a></span><span class="op">(</span><span class="va">a</span>, only.answer <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">zeroes</span></span>
<span><span class="co">#&gt; [1] -1.000000e+00 -1.000000e+00 -7.917564e-10  7.917563e-10</span></span></code></pre></div>
</div>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="left-matrix-fraction-descriptions">Left Matrix Fraction Descriptions<a class="anchor" aria-label="anchor" href="#left-matrix-fraction-descriptions"></a>
</h4>
<p>Suppose <span class="math inline">\(c(z)= a^{-1}(z) b(z)\)</span> is
an <span class="math inline">\((m \times n)\)</span> dimensional
rational matrix (<span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are polynomials). If <span class="math inline">\((a,b)\)</span> are left coprime then the poles of
<span class="math inline">\(c\)</span> are the zeroes of <span class="math inline">\(a\)</span>. Furthermore if <span class="math inline">\(c\)</span> is square, then the zeroes of <span class="math inline">\(c\)</span> are the zeroes of <span class="math inline">\(b\)</span>.</p>
<p>Therefore the methods <code>poles.lmfd</code> and
<code>zeroes.lmfd</code> simply use <code>zeroes.polm</code> in order to
compute poles and zeroes of a rational matrix given in LMFD form. This
implies that all the above caveats also apply here. E.g. the methods
only work for the case that <span class="math inline">\(a_0\)</span>
(respectively <span class="math inline">\(b_0\)</span>) is non
singular.</p>
<p>In addition the routines do not provide the correct answers in the
case that the pair <span class="math inline">\((a,b)\)</span> is
<em>not</em> left coprime. Here a pole/zero cancellation may occur,
which is not taken into account by the methods <code>poles.lmfd</code>
and <code>zeroes.lmfd</code>. This means that the functions may return
some <em>spurious</em> poles and zeroes.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a random rational (2 x 2) matrix in LMFD form with p = 1, q = 2</span></span>
<span><span class="co"># note that two random polynomials are "generically" left coprime</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">8924</span><span class="op">)</span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="../reference/test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, degree <span class="op">=</span> <span class="fl">1</span>, random <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">=</span> <span class="fu"><a href="../reference/test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, degree <span class="op">=</span> <span class="fl">2</span>, random <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">c</span> <span class="op">=</span> <span class="fu"><a href="../reference/lmfd.html">lmfd</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># poles of c=a^{-1}b  are the zeroes of a</span></span>
<span><span class="fu"><a href="../reference/poles_and_zeroes.html">poles</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  0.4136219 -0.9481900</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="../reference/poles_and_zeroes.html">poles</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="../reference/poles_and_zeroes.html">zeroes</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="co"># zeroes of c=a^{-1}b  are the zeroes of b</span></span>
<span><span class="fu"><a href="../reference/poles_and_zeroes.html">zeroes</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  0.01188418+0.0000000i -0.44699481+0.0000000i -0.07539272-0.8587459i</span></span>
<span><span class="co">#&gt; [4] -0.07539272+0.8587459i</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="../reference/poles_and_zeroes.html">zeroes</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="../reference/poles_and_zeroes.html">zeroes</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Now we construct an LMFD where a,b are not coprime. We simply simply
multiply the above matrices <span class="math inline">\(a,b\)</span>
with a common factor <span class="math inline">\(r\)</span> and note
that <span class="math inline">\((r a)^{-1} (r b) = a^{-1} b =
c\)</span>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate random common factor</span></span>
<span><span class="va">r</span> <span class="op">=</span> <span class="fu"><a href="../reference/test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, degree <span class="op">=</span> <span class="fl">1</span>, random <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">ra</span> <span class="op">=</span> <span class="va">r</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="va">a</span></span>
<span><span class="va">rb</span> <span class="op">=</span> <span class="va">r</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="va">b</span></span>
<span><span class="va">cc</span> <span class="op">=</span> <span class="fu"><a href="../reference/lmfd.html">lmfd</a></span><span class="op">(</span><span class="va">ra</span>,<span class="va">rb</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># here we get two "spurious" poles/zeroes</span></span>
<span><span class="op">(</span><span class="va">pz</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/poles_and_zeroes.html">poles</a></span><span class="op">(</span><span class="va">cc</span><span class="op">)</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  0.413622 -0.817746 -0.948190  2.707221</span></span>
<span><span class="op">(</span><span class="va">zz</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/poles_and_zeroes.html">zeroes</a></span><span class="op">(</span><span class="va">cc</span><span class="op">)</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  0.011884+0.000000i -0.446995+0.000000i -0.817746+0.000000i</span></span>
<span><span class="co">#&gt; [4] -0.075393-0.858746i -0.075393+0.858746i  2.707221+0.000000i</span></span>
<span></span>
<span><span class="co"># the zeroes of r pop up as poles and zeroes of cc</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/poles_and_zeroes.html">zeroes</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.817746  2.707221</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">pz</span>, <span class="va">zz</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.817746+0i  2.707221+0i</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="statespace-representation-1">Statespace Representation<a class="anchor" aria-label="anchor" href="#statespace-representation-1"></a>
</h4>
<p>Let <span class="math inline">\(k(z) = C(z^{-1}I - A)^{-1}B +
D\)</span> be a rational matrix, given in state space form. If the
statespace representation is <em>minimal</em> then the poles of <span class="math inline">\(k\)</span> are the reciprocals of the non zero
eigenvalues of <span class="math inline">\(A\)</span>. Furthermore if
<span class="math inline">\(k\)</span> is square and if <span class="math inline">\(D\)</span> is regular (i.e. if <span class="math inline">\(k(0)=D\)</span> is regular) then the zeroes of
<span class="math inline">\(k\)</span> are the reciprocals of the
eigenvalues of the matrix <span class="math inline">\((A-BD^{-1}C)\)</span>.</p>
<p>The methods <code>poles.stsp</code> and <code>zeroes.stsp</code>
therefore compute the poles (and zeroes) of <span class="math inline">\(k\)</span> via the eigenvalues of <span class="math inline">\(A\)</span> (respectively of <span class="math inline">\((A-BD^{-1}C)\)</span>). However, they do not check
whether the statespace realization is minimal.</p>
<p>Here analogous warnings are in place as for the polynomial and the
LMFD case:</p>
<ul>
<li>The procedures may return “spurious” poles or zeroes if the
representation is not minimal.</li>
<li>The procedures use a threshold (<code>tol</code>) in order to decide
whether a small eigenvalue returned by <code>eigen</code> is due to a
“true zero” eigenvalue or not.</li>
<li>The computation of zeroes is only implemented for the case that
<span class="math inline">\(k\)</span> has no zero at <span class="math inline">\(z=0\)</span>. If <span class="math inline">\(D\)</span> is ill conditioned then the results may
be unreliable.</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="checks">Checks<a class="anchor" aria-label="anchor" href="#checks"></a>
</h3>
<ul>
<li>
<code><a href="../reference/check.html">is.stable()</a></code> checks whether the rational matrix has no
poles on or withing the unit circle.</li>
<li>
<code><a href="../reference/check.html">is.miniphase()</a></code> checks whether the rational matrix has
no zeroes on or within the unit circle.</li>
</ul>
<p>These test function just return <code>TRUE</code> or
<code>FALSE</code>. The poles and zeroes of the rational matrix are
computed via the functions <code>poles</code> and <code>zeroes</code>
respectively. Hence the above caveats also apply here.</p>
<p>For <code>pseries</code> and <code>zvalues</code> objects the
functions return <code>NA</code>.</p>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="is-coprime">is.coprime()<a class="anchor" aria-label="anchor" href="#is-coprime"></a>
</h4>
<p>A polynomial matrix <span class="math inline">\(c\)</span> is called
<em>left prime</em>, if <span class="math inline">\(c(z)\)</span> has
full row rank everywhere in the complex plane. Clearly this implies that
<span class="math inline">\(c\)</span> is square or “wide”, i.e. if
<span class="math inline">\(c\)</span> is <span class="math inline">\((m
\times n)\)</span>-dimensional then <span class="math inline">\(m \leq
n\)</span> must hold.</p>
<p>A pair <span class="math inline">\((a,b)\)</span> of (compatible)
polynomial matrices is called <em>left coprime</em> if the matrix <span class="math inline">\(c=[a,b]\)</span> is left prime. This case is
important for the structure of left matrix fraction descriptions.
Suppose <span class="math inline">\(c(z)=a^{-1} b(z)\)</span>, where
<span class="math inline">\(a\)</span> is a square, non singular
polynomial matrix. If the pair is <span class="math inline">\((a,b)\)</span> is <em>not</em> left coprime, then
we may cancel a common, non unimodular, factor and thus obtain a
“simpler” representation for <span class="math inline">\(c(z)\)</span>.</p>
<p>The function <code>is.coprime</code> may be called with the following
syntax:</p>
<ul>
<li>
<code>test_coprime(c)</code> where <code>c</code> is an
<code>lmfd</code> object, which represents a rational matrix <span class="math inline">\(c(z)=a^{-1}(z)b(z)\)</span>, checks whether the
pair <span class="math inline">\((a,b)\)</span> is left coprime.<br>
</li>
<li>
<code>test_coprime(a)</code> where <code>a</code> is an
<code>polm</code> object, which represents a polynomial matrix <span class="math inline">\(a(z)\)</span>, checks whether <span class="math inline">\(a\)</span> is left prime.<br>
</li>
<li>
<code>test_coprime(a,b)</code> where <code>a</code>, <code>b</code>
are <code>polm</code> objects, which represent the polynomial matrices
<span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>, checks whether the pair <span class="math inline">\((a,b)\)</span> is left coprime.</li>
</ul>
<p>For implementation details see the vignette .</p>
</div>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="is-minimal">is.minimal()<a class="anchor" aria-label="anchor" href="#is-minimal"></a>
</h4>
<p>A statespace realization <span class="math inline">\((A,B,C,D)\)</span> is minimal if and only if the
Hankel matrix of the impulse response coefficients <span class="math inline">\(k_i = CA^{i-1}B\)</span>, <span class="math inline">\(i\geq 1\)</span></p>
<p><span class="math display">\[
\begin{pmatrix}
k_1 &amp; k_2     &amp; \cdots &amp; k_s \\
k_2 &amp; k_3     &amp; \cdots &amp; k_{s+1} \\
\vdots &amp; \vdots &amp;      &amp; \vdots  \\
k_s &amp; k_{s+1} &amp; \cdots &amp; k_{2s-1}                   
\end{pmatrix} \in \mathbb{R}^{ms\times ns}
\]</span> has rank <span class="math inline">\(s\)</span>. Therefore the
procedure <code><a href="../reference/is.minimal.html">is.minimal()</a></code> computes the SVD of this matrix and
returns <code>TRUE</code> if the <span class="math inline">\(s\)</span>-th singular value is larger than a
given threshold <code>tol</code>.</p>
<p>In order to check whether the statespace realization is observable
and/or controllable one may consider the observability and
controllability matrices (which may be computed with
<code>obs_matrix</code> and <code>ctr_matrix</code>) or the
corresponding Grammians (see <code>grammians</code>).</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="../reference/test_stsp.html">test_stsp</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, s <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/is.minimal.html">is.minimal</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Note that operations on <code>stsp</code> objects may return non
minimal realizations. E.g.:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/is.minimal.html">is.minimal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">x</span><span class="op">)</span>, only.answer <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'answer'</span>,<span class="st">'sv'</span>,<span class="st">'s0'</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; $answer</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sv</span></span>
<span><span class="co">#&gt; [1] 4.162446e+01 3.633925e+01 8.488171e-15 3.808400e-15 2.729067e-15</span></span>
<span><span class="co">#&gt; [6] 1.720477e-15 3.473458e-16 1.601466e-16</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $s0</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="fu"><a href="../reference/is.minimal.html">is.minimal</a></span><span class="op">(</span><span class="va">x</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>, only.answer <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'answer'</span>,<span class="st">'sv'</span>,<span class="st">'s0'</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; $answer</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sv</span></span>
<span><span class="co">#&gt; [1] 1.299743e-13 2.951303e-14 1.377293e-14 6.906353e-15 1.172737e-15</span></span>
<span><span class="co">#&gt; [6] 5.418091e-16 1.614441e-16 8.025565e-17</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $s0</span></span>
<span><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p>Here <code>s0</code> is an estimate of the minimal statespace
dimension.</p>
<p>In order to construct a minimal realization one may use the procedure
<a href="#balance"><code>balance</code></a>.</p>
</div>
</div>
<div class="section level3">
<h3 id="derivatives">Derivatives<a class="anchor" aria-label="anchor" href="#derivatives"></a>
</h3>
<p>The derivative of a rational function (with respect to the argument
<span class="math inline">\(z\)</span>) may be computed with the
<code>S3</code> method <code>derivative</code>. However,
<code>lmfd</code> and <code>zvalues</code> objects are not
supported.</p>
<p>As a simply example consider a polynomial of degree <span class="math inline">\(4\)</span> and its derivatives:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="../reference/polm.html">polm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">x</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">a</span> <span class="op">=</span> <span class="va">a</span> <span class="op">*</span> <span class="fu"><a href="../reference/polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">/</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">a</span>, format <span class="op">=</span> <span class="st">'c'</span><span class="op">)</span></span>
<span><span class="co">#&gt; ( 1 x 1 ) matrix polynomial with degree &lt;= 4 </span></span>
<span><span class="co">#&gt;                        [,1]</span></span>
<span><span class="co">#&gt; [1,]  1 - 1.25z^2 + 0.25z^4</span></span>
<span></span>
<span><span class="va">z</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="op">-</span><span class="fl">2.25</span>, to <span class="op">=</span> <span class="fl">2.25</span>, length.out <span class="op">=</span> <span class="fl">201</span><span class="op">)</span></span>
<span><span class="va">out</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">a</span>, z <span class="op">=</span> <span class="va">z</span><span class="op">)</span>, x_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/zvalues.html">zvalues</a></span><span class="op">(</span><span class="fu"><a href="../reference/derivative.html">derivative</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span>, z <span class="op">=</span> <span class="va">z</span><span class="op">)</span>,</span>
<span>                                      <span class="fu"><a href="../reference/zvalues.html">zvalues</a></span><span class="op">(</span><span class="fu"><a href="../reference/derivative.html">derivative</a></span><span class="op">(</span><span class="fu"><a href="../reference/derivative.html">derivative</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">12</span><span class="op">)</span>, z <span class="op">=</span> <span class="va">z</span><span class="op">)</span>,</span>
<span>                                      <span class="fu"><a href="../reference/zvalues.html">zvalues</a></span><span class="op">(</span><span class="fu"><a href="../reference/derivative.html">derivative</a></span><span class="op">(</span><span class="fu"><a href="../reference/derivative.html">derivative</a></span><span class="op">(</span><span class="fu"><a href="../reference/derivative.html">derivative</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">24</span><span class="op">)</span>, z <span class="op">=</span> <span class="va">z</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     which <span class="op">=</span> <span class="st">'real'</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">a</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">frac</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">~</span><span class="fu">frac</span><span class="op">(</span><span class="va">d</span><span class="op">*</span><span class="va">a</span>,<span class="va">d</span><span class="op">*</span><span class="va">x</span><span class="op">)</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">frac</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">12</span><span class="op">)</span><span class="op">~</span><span class="fu">frac</span><span class="op">(</span><span class="va">d</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="va">a</span>,<span class="va">d</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="va">x</span><span class="op">)</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">frac</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">24</span><span class="op">)</span><span class="op">~</span><span class="fu">frac</span><span class="op">(</span><span class="va">d</span><span class="op">^</span><span class="fl">3</span><span class="op">*</span><span class="va">a</span>,<span class="va">d</span><span class="op">^</span><span class="fl">3</span><span class="op">*</span><span class="va">x</span><span class="op">)</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">opar</span> <span class="op">=</span> <span class="fu">out</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span>, col <span class="op">=</span> <span class="st">'darkgray'</span><span class="op">)</span></span></code></pre></div>
<p><img src="a_rational_matrices_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span></span></code></pre></div>
<p>Note that computing the derivative for an impulse response object
decreases the number of lags by one!</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="../reference/test_stsp.html">test_stsp</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, s <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="../reference/pseries.html">pseries</a></span><span class="op">(</span><span class="fu"><a href="../reference/derivative.html">derivative</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, lag.max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="../reference/derivative.html">derivative</a></span><span class="op">(</span><span class="fu"><a href="../reference/pseries.html">pseries</a></span><span class="op">(</span><span class="va">x</span>, lag.max <span class="op">=</span> <span class="fl">11</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="methods-for-polynomials">Methods for Polynomials<a class="anchor" aria-label="anchor" href="#methods-for-polynomials"></a>
</h2>
<div class="section level3">
<h3 id="normal-forms">Normal Forms<a class="anchor" aria-label="anchor" href="#normal-forms"></a>
</h3>
<p>The package contains functions which compute some of the most
important “normal forms” of polynomial matrices, e.g. the Smith normal
form. However, we should note that the computation of such normal form
is numerically quite tricky and that the implementation here is rather
simple minded. Therefore these functions may fail for large, complex
polynomial matrices.</p>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="hermite-normal-form">Hermite Normal Form<a class="anchor" aria-label="anchor" href="#hermite-normal-form"></a>
</h4>
<p>Any polynomial matrix can be transformed to a
“quasi-upper-triangular” matrix by elementary row operations, i.e. by
multiplication with a unimodular matrix from the left. Suppose that
<span class="math inline">\(a(z)\)</span> is an <span class="math inline">\(m \times n\)</span> dimensional matrix with rank
<span class="math inline">\(r \leq \min(m,n)\)</span>. Then <span class="math inline">\(h(z) = u^{-1}(z) a(z)\)</span> is the <em>column
Hermite form</em> of <span class="math inline">\(a(z)\)</span>, if <span class="math inline">\(u(z)\)</span> is unimodular and if there exist
integers <span class="math inline">\(1\leq j(i) &lt;j(2) &lt; \cdots
&lt; j(r)\leq n\)</span> such that</p>
<ul>
<li>
<span class="math inline">\(h_{i,j(i)}(z)\)</span> is monic (the
coefficient pertaining to the highest degree is equal to one),</li>
<li>the elements above <span class="math inline">\(h_{i,j(i)}(z)\)</span> have lower polynomial
degree than <span class="math inline">\(h_{i,j(i)}(z)\)</span> and</li>
<li>
<span class="math inline">\(h_{i,j}(z) = 0\)</span> for <span class="math inline">\(i&gt;r\)</span> or <span class="math inline">\(j
&lt; j(i)\)</span>.</li>
</ul>
<p>See also <span class="citation">@Kailath80</span>.</p>
<p>Quite analogously one may transform the matrix <span class="math inline">\(a(z)\)</span> by elementary column operations into
“quasi-lower-triangular” form <span class="math inline">\(h(z) =
a(z)u^{-1}(z)\)</span>. The corresponding normal form is called <em>row
Hermite form</em>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="../reference/polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.4</span>, <span class="op">-</span><span class="fl">1.3</span>, <span class="op">-</span><span class="fl">0.3</span>,  <span class="fl">0.6</span>, <span class="fl">1.1</span>,  <span class="fl">1</span>,</span>
<span>                 <span class="op">-</span><span class="fl">1.7</span>,  <span class="fl">0</span>,   <span class="op">-</span><span class="fl">0.8</span>, <span class="op">-</span><span class="fl">0.3</span>, <span class="fl">3.2</span>, <span class="op">-</span><span class="fl">0.4</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">a</span>, format <span class="op">=</span> <span class="st">'c'</span><span class="op">)</span></span>
<span><span class="co">#&gt; ( 2 x 3 ) matrix polynomial with degree &lt;= 1 </span></span>
<span><span class="co">#&gt;              [,1]         [,2]        [,3]</span></span>
<span><span class="co">#&gt; [1,]  -0.4 - 1.7z  -0.3 - 0.8z  1.1 + 3.2z</span></span>
<span><span class="co">#&gt; [2,]         -1.3   0.6 - 0.3z    1 - 0.4z</span></span>
<span></span>
<span><span class="va">out</span> <span class="op">=</span> <span class="fu"><a href="../reference/hnf.html">hnf</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">h</span>, format <span class="op">=</span> <span class="st">'c'</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; ( 2 x 3 ) matrix polynomial with degree &lt;= 2 </span></span>
<span><span class="co">#&gt;       [,1]               [,2]               [,3]</span></span>
<span><span class="co">#&gt; [1,]     1        -0.5 + 0.2z        -0.8 + 0.3z</span></span>
<span><span class="co">#&gt; [2,]     0  -1.2 - 3.8z + z^2  2 + 5.1z + 1.3z^2</span></span>
<span><span class="co"># check the result(s)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">a</span>, <span class="fu"><a href="../reference/prune.html">prune</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">u</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="va">out</span><span class="op">$</span><span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="../reference/polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="../reference/prune.html">prune</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">u</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="va">out</span><span class="op">$</span><span class="va">u_inv</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>The <em>row Hermite form</em> may be obtained by calling the function
<code><a href="../reference/hnf.html">hnf()</a></code> with the options <code>from_left=FALSE</code>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">=</span> <span class="fu"><a href="../reference/hnf.html">hnf</a></span><span class="op">(</span><span class="va">a</span>, from_left <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">h</span>, format <span class="op">=</span> <span class="st">'c'</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; ( 2 x 3 ) matrix polynomial with degree &lt;= 0 </span></span>
<span><span class="co">#&gt;       [,1]  [,2]  [,3]</span></span>
<span><span class="co">#&gt; [1,]     1     0     0</span></span>
<span><span class="co">#&gt; [2,]     0     1     0</span></span>
<span><span class="co"># check the result(s)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">a</span>, <span class="fu"><a href="../reference/prune.html">prune</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">h</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="va">out</span><span class="op">$</span><span class="va">u</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="../reference/polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="../reference/prune.html">prune</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">u</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="va">out</span><span class="op">$</span><span class="va">u_inv</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Note that for the polynomial <span class="math inline">\(a(z)\)</span> considered in the above
<code>R</code> demonstration(s), the row Hermite form is particularly
simple, since <span class="math inline">\(a(z)\)</span> is left prime.
See also the discussion about <em>left (co)prime</em> matrices in the
vignette “Technical Details”.</p>
<p>The following example is a <span class="math inline">\((3,5)\)</span>
dimensional polynomial matrix with rank <span class="math inline">\(2\)</span>. The function <code><a href="../reference/hnf.html">hnf()</a></code>
returns an “estimate” of the rank and the “pivots” <span class="math inline">\(j(1),j(2),\ldots, j(r)\)</span>.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="../reference/polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">6</span>,<span class="op">-</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="op">-</span><span class="fl">1</span>,</span>
<span>                 <span class="fl">1</span>,<span class="op">-</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="op">-</span><span class="fl">8</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">5</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">a</span>, format <span class="op">=</span> <span class="st">'c'</span><span class="op">)</span></span>
<span><span class="co">#&gt; ( 3 x 5 ) matrix polynomial with degree &lt;= 2 </span></span>
<span><span class="co">#&gt;       [,1]    [,2]    [,3]          [,4]          [,5]</span></span>
<span><span class="co">#&gt; [1,]     0  2 + 2z  2 - 2z  6 + 3z + z^2  3 - 8z + z^2</span></span>
<span><span class="co">#&gt; [2,]     0  -1 - z  -1 + z      -3 + z^2       z + z^2</span></span>
<span><span class="co">#&gt; [3,]     0   1 + z   1 - z  3 + 2z + z^2  2 - 5z + z^2</span></span>
<span></span>
<span><span class="va">out</span> <span class="op">=</span> <span class="fu"><a href="../reference/hnf.html">hnf</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">h</span>, format <span class="op">=</span> <span class="st">'c'</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; ( 3 x 5 ) matrix polynomial with degree &lt;= 2 </span></span>
<span><span class="co">#&gt;       [,1]   [,2]   [,3]     [,4]          [,5]</span></span>
<span><span class="co">#&gt; [1,]     0  1 + z  1 - z    3 + z        1 - 3z</span></span>
<span><span class="co">#&gt; [2,]     0      0      0  z + z^2  1 - 2z + z^2</span></span>
<span><span class="co">#&gt; [3,]     0      0      0        0             0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">rank</span><span class="op">)</span>    <span class="co"># the rank of a(z) is 2</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">pivots</span><span class="op">)</span>  <span class="co"># the columns 2 and 4 are linearly independent.</span></span>
<span><span class="co">#&gt; [1] 2 4</span></span>
<span></span>
<span><span class="co"># check the result(s)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">a</span>, <span class="fu"><a href="../reference/prune.html">prune</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">u</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="va">out</span><span class="op">$</span><span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="../reference/polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="../reference/prune.html">prune</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">u</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="va">out</span><span class="op">$</span><span class="va">u_inv</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="smith-normal-form">Smith Normal Form<a class="anchor" aria-label="anchor" href="#smith-normal-form"></a>
</h4>
<p>For any <span class="math inline">\((m \times n)\)</span> dimensional
polynomial matrix <span class="math inline">\(a(z)\)</span> with rank
<span class="math inline">\(r\leq \min(m,n)\)</span> there exists a
factorization</p>
<p><span class="math display">\[
a(z) = u(z) s(z) v(z)
\]</span> where <span class="math inline">\(u(z)\)</span> and <span class="math inline">\(v(z)\)</span> are two unimodular matrices and
<span class="math inline">\(s(z)\)</span> is an <span class="math inline">\(m \times n\)</span> dimensional quasi-diagonal
matrix with diagonal entries <span class="math inline">\(d_i(z)\)</span>
which satisfy</p>
<ul>
<li>
<span class="math inline">\(d_i\)</span> is monic for <span class="math inline">\(i \leq r\)</span> and zero for <span class="math inline">\(i&gt;r\)</span>, and</li>
<li>
<span class="math inline">\(d_i\)</span> divides <span class="math inline">\(d_{i+1}\)</span> for <span class="math inline">\(i&lt;r\)</span>.</li>
</ul>
<p>The above factorization may be constructed by using elementary
column- and row- operations.</p>
<p>For more details, see e.g. <span class="citation">@Kailath80</span>.</p>
<p>As a simple example consider the following <span class="math inline">\(4 \times 5\)</span> dimensional polynomial
matrix</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span> <span class="co"># set seed for random number generation</span></span>
<span></span>
<span><span class="va">z</span> <span class="op">=</span> <span class="fu"><a href="../reference/polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span>,<span class="op">-</span><span class="fl">3</span>,<span class="op">-</span><span class="fl">2</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">-</span> <span class="va">z</span><span class="op">*</span><span class="fu"><a href="../reference/polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># inflate this 3x3 matrix to a 4x5 matrix</span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">4</span><span class="op">*</span><span class="fl">3</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">4</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="va">a</span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="va">a</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">3</span><span class="op">*</span><span class="fl">5</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">a</span>, format<span class="op">=</span><span class="st">'c'</span><span class="op">)</span></span>
<span><span class="co">#&gt; ( 4 x 5 ) matrix polynomial with degree &lt;= 1 </span></span>
<span><span class="co">#&gt;         [,1]  [,2]  [,3]    [,4]  [,5]</span></span>
<span><span class="co">#&gt; [1,]      -1     z     0   1 + z    -z</span></span>
<span><span class="co">#&gt; [2,]      -2     0     z       2     0</span></span>
<span><span class="co">#&gt; [3,]  -3 + z     0     z   3 - z     0</span></span>
<span><span class="co">#&gt; [4,]   3 - z     0    -z  -3 + z     0</span></span>
<span></span>
<span><span class="va">out</span> <span class="op">=</span> <span class="fu"><a href="../reference/snf.html">snf</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">s</span>, digits <span class="op">=</span> <span class="fl">2</span>, format <span class="op">=</span> <span class="st">'c'</span><span class="op">)</span></span>
<span><span class="co">#&gt; ( 4 x 5 ) matrix polynomial with degree &lt;= 2 </span></span>
<span><span class="co">#&gt;       [,1]  [,2]      [,3]  [,4]  [,5]</span></span>
<span><span class="co">#&gt; [1,]     1     0         0     0     0</span></span>
<span><span class="co">#&gt; [2,]     0     z         0     0     0</span></span>
<span><span class="co">#&gt; [3,]     0     0  -z + z^2     0     0</span></span>
<span><span class="co">#&gt; [4,]     0     0         0     0     0</span></span>
<span></span>
<span><span class="co"># check result(s)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">a</span>, <span class="fu"><a href="../reference/prune.html">prune</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">u</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="va">out</span><span class="op">$</span><span class="va">s</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="va">out</span><span class="op">$</span><span class="va">v</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="co"># reset seed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="column-reduced-form">Column Reduced Form<a class="anchor" aria-label="anchor" href="#column-reduced-form"></a>
</h4>
<p>Let <span class="math inline">\(a(z)=a_0 + a_1 z + \cdots + a_p
z^p\)</span> be <span class="math inline">\((m \times n)\)</span>,
polynomial matrix with column degrees <span class="math inline">\(p_i\)</span>, <span class="math inline">\(i=1,\ldots ,n\)</span>. The column end matrix of
<span class="math inline">\(a(z)\)</span> is the <span class="math inline">\((m \times n)\)</span> matrix with <span class="math inline">\(i\)</span>-th column equal to the <span class="math inline">\(i\)</span>-th column of the coefficient matrix
<span class="math inline">\(a_{p_i}\)</span>.</p>
<p>If <span class="math inline">\(a(z)\)</span> is square and if the
column end matrix is regular, then <span class="math inline">\(a\)</span> is called <em>column reduced</em>.</p>
<p>Any non singular, square polynomial matrix may be transformed to a
column reduced matrix by a sequence of elementary column operations.
This means there exists a unimodular matrix <span class="math inline">\(v(z)\)</span> such that <span class="math inline">\(a(z) v^{-1}(z)\)</span> is column reduced.</p>
<p>This task is accomplished by the helper function
<code>col_reduce(a, ...)</code>.</p>
<p>As an example consider a random <span class="math inline">\((3 \times
3)\)</span>, polynomial matrix whose column end matrix has rank 1:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a random (3 x 3) polynmial matrix with a column end matrix of rank 1</span></span>
<span><span class="va">col_end_matrix</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span></span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="../reference/test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>, degree <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, random <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               digits <span class="op">=</span> <span class="fl">2</span>, col_end_matrix <span class="op">=</span> <span class="va">col_end_matrix</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">a</span>, format <span class="op">=</span> <span class="st">'c'</span><span class="op">)</span></span>
<span><span class="co">#&gt; ( 3 x 3 ) matrix polynomial with degree &lt;= 2 </span></span>
<span><span class="co">#&gt;                          [,1]           [,2]          [,3]</span></span>
<span><span class="co">#&gt; [1,]    0.19 + 0.22z + 0.3z^2    1.07 - 0.3z  -1.27 - 0.5z</span></span>
<span><span class="co">#&gt; [2,]   -0.4 + 0.21z + 0.06z^2   0.79 - 0.06z    0.5 - 0.1z</span></span>
<span><span class="co">#&gt; [3,]  -0.49 - 1.07z + 0.12z^2  -0.56 - 0.12z   0.87 - 0.2z</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="fu"><a href="../reference/col_end_matrix.html">col_end_matrix</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">d</span><span class="op">)</span>       <span class="co"># column end matrix has rank 1</span></span>
<span><span class="co">#&gt; [1] 7.183314e-01 1.379687e-17 4.078440e-34</span></span>
<span></span>
<span><span class="va">out</span> <span class="op">=</span> <span class="fu"><a href="../reference/col_reduce.html">col_reduce</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">a</span>, format <span class="op">=</span> <span class="st">'c'</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>   <span class="co"># column reduced matrix</span></span>
<span><span class="co">#&gt; ( 3 x 3 ) matrix polynomial with degree &lt;= 1 </span></span>
<span><span class="co">#&gt;                [,1]           [,2]   [,3]</span></span>
<span><span class="co">#&gt; [1,]    1.07 - 0.3z   0.19 + 1.29z  -3.05</span></span>
<span><span class="co">#&gt; [2,]   0.79 - 0.06z       -0.4 + z  -0.82</span></span>
<span><span class="co">#&gt; [3,]  -0.56 - 0.12z  -0.49 - 1.63z    1.8</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">col_degrees</span><span class="op">)</span>                   <span class="co"># column degrees</span></span>
<span><span class="co">#&gt; [1] 1 1 0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">col_end_matrix</span><span class="op">)</span>                <span class="co"># column end matrix</span></span>
<span><span class="co">#&gt;       [,1]  [,2]       [,3]</span></span>
<span><span class="co">#&gt; [1,] -0.30  1.29 -3.0533333</span></span>
<span><span class="co">#&gt; [2,] -0.06  1.00 -0.8166667</span></span>
<span><span class="co">#&gt; [3,] -0.12 -1.63  1.8033333</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">col_end_matrix</span><span class="op">)</span><span class="op">$</span><span class="va">d</span><span class="op">)</span>         <span class="co"># column end matrix is non singular!</span></span>
<span><span class="co">#&gt; [1] 4.2389693 0.8233726 0.1549081</span></span>
<span></span>
<span><span class="co"># check reult(s)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="../reference/polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="../reference/prune.html">prune</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">v</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="va">out</span><span class="op">$</span><span class="va">v_inv</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="../reference/prune.html">prune</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>, <span class="fu"><a href="../reference/prune.html">prune</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">a</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="va">out</span><span class="op">$</span><span class="va">v</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="../reference/col_end_matrix.html">col_end_matrix</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">a</span><span class="op">)</span>, <span class="va">out</span><span class="op">$</span><span class="va">col_end_matrix</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="wiener-hopf-factorisation">Wiener-Hopf Factorisation<a class="anchor" aria-label="anchor" href="#wiener-hopf-factorisation"></a>
</h4>
<p>A Wiener-Hopf factorization of a (square <span class="math inline">\((m,m)\)</span>-dimensional, non singular)
polynomial matrix <span class="math inline">\(A(z)\)</span> is a
factorization of the form</p>
<p><span class="math display">\[
A(z) = A_f(z^{-1}) A_0(z) A_b(z) = A_r(z) A_b(z),
\]</span> where</p>
<ul>
<li>
<span class="math inline">\(A_b(z)\)</span> is a polynomial matrix
which has zeroes outside the unit circle,</li>
<li>
<span class="math inline">\(A_r(z)\)</span> is a column reduced
polynomial matrix with column degrees <span class="math inline">\(\kappa_i\)</span> <span class="math inline">\(i=1,\ldots,m\)</span> and zeroes inside the unit
circle,</li>
<li>
<span class="math inline">\(A_0(z)\)</span> is a diagonal matrix
with diagonal entries <span class="math inline">\(z^{\kappa_i}\)</span>
and<br>
</li>
<li>
<span class="math inline">\(A_f(z^{-1}) = A_r(z)A_0^{-1}(z)\)</span>
is a polynomial in <span class="math inline">\(z^{-1}\)</span>!</li>
</ul>
<p>The factors <span class="math inline">\(A_f(z^{-1})\)</span>, <span class="math inline">\(A_0(z)\)</span>, <span class="math inline">\(A_b(z)\)</span> are called <em>forward</em>,
<em>null</em> and <em>backward</em> components of <span class="math inline">\(A(z)\)</span>, and the integers <span class="math inline">\((\kappa_1,\ldots,\kappa_n)\)</span> are the
<em>partial indices</em> of <span class="math inline">\(A(z)\)</span>.</p>
<p>Note that zeroes on the unit circle are not allowed.</p>
<p>The Wiener-Hopf factorization plays an important role for the
analysis of linear, rational expectation models. See e.g. <span class="citation">@Al-Sadoon2017</span>.</p>
<p>The WHF is constructed in three steps</p>
<ul>
<li>first compute the Smith form <span class="math inline">\(A(z)= u(z)
s(z) v(z)\)</span>
</li>
<li>each diagonal entry <span class="math inline">\(d_i\)</span> is
factored into a polynomial with zeroes inside, respectivly outside the
unit circle. Let <span class="math inline">\(s(z) = s_r(z) s_b
(z)\)</span> denote the corresponding factorization of <span class="math inline">\(s(z)\)</span>. This gives <span class="math inline">\(A(z) = (u(z) s_r(z)) (s_b(z) v(z))\)</span>.</li>
<li>compute the column reduced form of <span class="math inline">\((u(z)
s_r(z)) = A_r(z) w(z)\)</span> and set <span class="math inline">\(A_b =
w^{-1}(z) s_b(z) v(z)\)</span>.</li>
<li>Let <span class="math inline">\(\kappa_i\)</span> denote the columnn
degrees of <span class="math inline">\(A_r(z)\)</span> and set <span class="math inline">\(A_f(z^{-1}) = A_r(z)
\mbox{diag}(z^{-\kappa_i})\)</span>. Note that by construction <span class="math inline">\(A_f(z^{-1})\)</span> is a polynomial in <span class="math inline">\(z^{-1}\)</span>.</li>
</ul>
<p>Simulation example:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">54321</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create test polynomial</span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="../reference/test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, deg <span class="op">=</span> <span class="fl">2</span>, digits <span class="op">=</span> <span class="fl">2</span>, random <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># compute WHF and print the result</span></span>
<span><span class="va">out</span> <span class="op">=</span> <span class="fu"><a href="../reference/whf.html">whf</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">af</span>, digits <span class="op">=</span> <span class="fl">2</span>, format <span class="op">=</span> <span class="st">'c'</span><span class="op">)</span></span>
<span><span class="co">#&gt; ( 4 x 4 ) Laurent polynomial matrix with degree &lt;= 0, and minimal degree &gt;= -1</span></span>
<span><span class="co">#&gt;                 [,1]             [,2]              [,3]   [,4]</span></span>
<span><span class="co">#&gt; [1,]               0         0.76z^-1             -1.59   1.57</span></span>
<span><span class="co">#&gt; [2,]               0                0                 0  -0.62</span></span>
<span><span class="co">#&gt; [3,]  2.6z^-1 - 4.83  -3.6z^-1 + 3.51   0.04z^-1 + 3.58  -3.35</span></span>
<span><span class="co">#&gt; [4,]   -2.61z^-1 + 6  4.19z^-1 - 6.26  -2.29z^-1 - 0.31    2.5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">a0</span>, digits <span class="op">=</span> <span class="fl">2</span>, format <span class="op">=</span> <span class="st">'c'</span><span class="op">)</span></span>
<span><span class="co">#&gt; ( 4 x 4 ) matrix polynomial with degree &lt;= 1 </span></span>
<span><span class="co">#&gt;       [,1]  [,2]  [,3]  [,4]</span></span>
<span><span class="co">#&gt; [1,]     z     0     0     0</span></span>
<span><span class="co">#&gt; [2,]     0     z     0     0</span></span>
<span><span class="co">#&gt; [3,]     0     0     z     0</span></span>
<span><span class="co">#&gt; [4,]     0     0     0     1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">ab</span>, digits <span class="op">=</span> <span class="fl">2</span>, format <span class="op">=</span> <span class="st">'c'</span><span class="op">)</span></span>
<span><span class="co">#&gt; ( 4 x 4 ) matrix polynomial with degree &lt;= 2 </span></span>
<span><span class="co">#&gt;                         [,1]                    [,2]                     [,3]           [,4]</span></span>
<span><span class="co">#&gt; [1,]           -2.99 + 5.26z           -4.16 - 1.04z             2.63 + 0.28z       3.13 - z</span></span>
<span><span class="co">#&gt; [2,]           -3.35 + 5.61z           -4.22 - 1.11z             2.45 - 0.27z   3.69 - 1.06z</span></span>
<span><span class="co">#&gt; [3,]           -0.35 + 3.09z           -2.13 - 0.92z             0.61 - 0.79z   2.06 - 0.57z</span></span>
<span><span class="co">#&gt; [4,]  1.51 - 1.88z + 1.81z^2  1.78 - 0.79z - 0.86z^2  -0.29 - 0.08z - 1.26z^2  -0.84 + 2.07z</span></span>
<span></span>
<span><span class="co"># check the result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">a</span>, <span class="fu"><a href="../reference/prune.html">prune</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">ar</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="va">out</span><span class="op">$</span><span class="va">ab</span><span class="op">)</span><span class="op">)</span>           <span class="co"># A = Ar * Ab</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="co"># check A(z) = Ab(z^{-1}) A0(z) Ab(z)</span></span>
<span><span class="co"># generate random complex z's</span></span>
<span><span class="va">z</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">complex</a></span><span class="op">(</span>real <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, imaginary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">a_z</span>  <span class="op">=</span> <span class="fu"><a href="../reference/zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">z</span><span class="op">)</span>         <span class="co"># A(z)</span></span>
<span><span class="va">ab_z</span> <span class="op">=</span> <span class="fu"><a href="../reference/zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">ab</span>, <span class="va">z</span><span class="op">)</span>    <span class="co"># Ab(z)</span></span>
<span><span class="va">a0_z</span> <span class="op">=</span> <span class="fu"><a href="../reference/zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">a0</span>, <span class="va">z</span><span class="op">)</span>    <span class="co"># A0(z)</span></span>
<span><span class="va">af_z</span> <span class="op">=</span> <span class="fu"><a href="../reference/zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">af</span>, <span class="fl">1</span><span class="op">/</span><span class="va">z</span><span class="op">)</span>  <span class="co"># Af(z^{-1})  </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">af_z</span>, <span class="st">'z'</span><span class="op">)</span> <span class="op">=</span> <span class="va">z</span>           <span class="co"># in order to combine the 'zvalues' objects,</span></span>
<span>                              <span class="co"># the attribute 'z' must be identical</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">a_z</span>, <span class="va">af_z</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="va">a0_z</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="va">ab_z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Mean relative Mod difference: 3.086469"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">idx</span>, <span class="fu"><a href="../reference/degree.html">degree</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">ar</span>, <span class="st">'columns'</span><span class="op">)</span><span class="op">)</span>    <span class="co"># idx = column degrees of Ar</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="fu"><a href="../reference/col_end_matrix.html">col_end_matrix</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">ar</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">d</span> <span class="op">&gt;</span> <span class="fl">1e-7</span><span class="op">)</span>     <span class="co"># Ar is column reduced</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="../reference/poles_and_zeroes.html">zeroes</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">ar</span>, print_message <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">)</span>  <span class="co"># Ar has zeroes inside the unit circle</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="../reference/poles_and_zeroes.html">zeroes</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">ab</span>, print_message <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span>  <span class="co"># Ab zeroes outside the unit circle</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="blaschke">Reflect Zeroes by Multiplication with All Pass Matrices<a class="anchor" aria-label="anchor" href="#blaschke"></a>
</h3>
<p>A <em>Blaschke factor</em> is a rational function of the form</p>
<p><span class="math display">\[
a(z) = \frac{1-\bar{\alpha}z}{-\alpha + z}\frac{\alpha}{\bar{\alpha}}
\]</span> This function is <em>all pass</em>, i.e. <span class="math display">\[
a(z) a^*(z) = \left(\frac{1-\bar{\alpha}z}{-\alpha +
z}\frac{\alpha}{\bar{\alpha}}\right)
              \left(\frac{1-\alpha z^{-1}}{-\bar{\alpha} +
z^{-1}}\frac{\bar{\alpha}}{\alpha}\right)
            =  \left(\frac{1-\bar{\alpha}z}{-\alpha + z}\right)
              \left(\frac{z-\alpha}{-\bar{\alpha}z + 1}\right) = 1
\]</span> If we multiply a (scalar) polynomial <span class="math inline">\(p(z)\)</span>, which is zero at <span class="math inline">\(z=\alpha\)</span>, with such a Blascke factor then
we obtain a new polynomial, <span class="math inline">\(\tilde{p}(z) =
p(z)a(z)\)</span> say, where the zero at <span class="math inline">\(z=\alpha\)</span> is replaced by a zeroe at <span class="math inline">\(z=1/\bar{\alpha}\)</span>. Furthermore both
polynomial generate the same spectral density, i.e.</p>
<p><span class="math display">\[
\tilde{p}(z) \tilde{p}^*(z) = p(z) a(z) a^*(z) p^*(z) = p(z) p^*(z)
\]</span></p>
<p>If <span class="math inline">\(p(z)\)</span> is a real polynomial and
the root <span class="math inline">\(z=\alpha\)</span> is complex then
the polynomial <span class="math inline">\(\tilde{p}\)</span> has
complex coefficients. However, if we also flip the conjugated root <span class="math inline">\(z=\bar{\alpha}\)</span> then we obtain a
polynomial with real coefficients. This means the polynomial</p>
<p><span class="math display">\[
p(z)\left(\frac{1-\bar{\alpha}z}{-\alpha +
z}\frac{\alpha}{\bar{\alpha}}\right)
    \left(\frac{1-\alpha z}{-\bar{\alpha} +
z}\frac{\bar{\alpha}}{\alpha}\right)
\]</span> has real coefficients (and the “flipped roots” <span class="math inline">\(1/\bar{\alpha}\)</span> and <span class="math inline">\(1/\alpha\)</span>).</p>
<p>The multiplication with a (univariate) Blaschke factor is implemented
in the routine <code>blaschke_univariate()</code>.</p>
<p>This procedure may be generalized to polynomial matrices, see
<code>blaschke_multivariate</code>. Suppose that <span class="math inline">\(p(z)\)</span> is an <span class="math inline">\((m
\times n)\)</span> dimensional polynomial matrix and that <span class="math inline">\(\alpha\)</span> is a root, i.e <span class="math inline">\(p(\alpha)\)</span> is singular. Let <span class="math inline">\(p(\alpha)=U\Sigma V^*\)</span> denote the SVD of
<span class="math inline">\(p(\alpha)\)</span> then the last row of
<span class="math inline">\(U^* p(\alpha)\)</span> is zero, i.e. <span class="math inline">\((z-\alpha)\)</span> divides all entries of the
last row. If we multiply the last row with the corresponding Blaschke
factor, we obtain a matrix polynomial, where the root <span class="math inline">\(\alpha\)</span> is replaced by the root <span class="math inline">\(1/\bar{\alpha}\)</span>. (At least the
“multiplicity” of the root <span class="math inline">\(\alpha\)</span>
has been reduced by one.) If <span class="math inline">\(\alpha\)</span>
is complex we have to “blaschkerize” also the conjugate root <span class="math inline">\(\bar{\alpha}\)</span> and to multiply the result
with a suitable unitary matrix (see the helper function
<code>transform_polar4real</code>) in order to obtain a polynomial
matrix with real coeffcients. This task is accomplished by
<code>blaschke_multivariate</code>.</p>
<p>If we want to flip a set of roots, the utility
<code>transform_allpass</code> may be used.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1719</span><span class="op">)</span></span>
<span><span class="va">m0</span> <span class="op">=</span> <span class="fu"><a href="../reference/test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, degree <span class="op">=</span> <span class="fl">2</span>, digits <span class="op">=</span> <span class="fl">2</span>, random <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m</span> <span class="op">=</span> <span class="va">m0</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="../reference/polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mz</span> <span class="op">=</span> <span class="fu"><a href="../reference/poles_and_zeroes.html">zeroes</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="va">mz</span></span>
<span><span class="co">#&gt; [1]  0.1255159+0.000000i  1.0000000+0.000000i  1.0000000+0.000000i</span></span>
<span><span class="co">#&gt; [4]  0.1371003-1.270166i  0.1371003+1.270166i -2.4509944+0.000000i</span></span>
<span></span>
<span><span class="va">bm</span> <span class="op">=</span> <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">blaschke_multivariate</span><span class="op">(</span><span class="va">m</span>, <span class="va">mz</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in blaschke_multivariate(m, mz[4]) : </span></span>
<span><span class="co">#&gt;   could not find function "blaschke_multivariate"</span></span>
<span></span>
<span><span class="va">bm</span> <span class="op">=</span> <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">blaschke_multivariate</span><span class="op">(</span><span class="va">m</span>, <span class="va">mz</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in blaschke_multivariate(m, mz[2]) : </span></span>
<span><span class="co">#&gt;   could not find function "blaschke_multivariate"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="misc-tools">Misc Tools<a class="anchor" aria-label="anchor" href="#misc-tools"></a>
</h3>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="companion-matrix">Companion Matrix<a class="anchor" aria-label="anchor" href="#companion-matrix"></a>
</h4>
<p>Let <span class="math inline">\(a(z) = a_0+a_1z+\cdots a_p
z^p\)</span> be a square (<span class="math inline">\(m\times
m\)</span>)-dimensional, non singular polynomial matrix with <span class="math inline">\(a_0\neq 0\)</span>. The companion matrix</p>
<p><span class="math display">\[
\begin{pmatrix}
-a_0^{-1}a_1 &amp; \cdots &amp; -a_0^{-1} a_{p-1} &amp; -a_0^{-1} a_p \\
I_m          &amp; \cdots &amp; 0                 &amp;          0    \\
\vdots       &amp; \ddots &amp; \vdots            &amp;     \vdots    \\
0            &amp; \cdots &amp; I_m               &amp;           0
\end{pmatrix} \in \mathbb{R}^{mp\times mp}
\]</span> may be computed with the helper function
<code><a href="../reference/companion_matrix.html">companion_matrix()</a></code>. This function throws an error if the
argument is not square, has degree <span class="math inline">\(-1\)</span> or if the constant term <span class="math inline">\(a_0\)</span> is not invertible.</p>
</div>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="polynomial-degree">Polynomial Degree<a class="anchor" aria-label="anchor" href="#polynomial-degree"></a>
</h4>
<p>The helper function <code><a href="../reference/degree.html">degree()</a></code> returns the polynomial
degrees of the elements of a polynomial matrix, the maximum degrees of
the elements of the columns or rows of the matrix and the maximum degree
of all elements of <span class="math inline">\(a(z)\)</span>. Note that
the degree of a zero polynomial is set to <span class="math inline">\(-1\)</span>.</p>
</div>
<div class="section level4 unnumbered">
<h4 class="unnumbered" id="some-workhorse-functions">Some Workhorse Functions<a class="anchor" aria-label="anchor" href="#some-workhorse-functions"></a>
</h4>
<p>The following helper functions are in particular used to construct
normal forms, like the Hermite normal form, of polynomial matrices.</p>
<ul>
<li>
<code><a href="../reference/col_end_matrix.html">col_end_matrix()</a></code> computes the <em>column end
matrix</em> of a polynomial matrix.</li>
<li>
<code><a href="../reference/prune.html">prune()</a></code> “simplifies” a polynomial object. In
particular, small leading coefficients are set to zero and then zero
leading coefficent matrices are dropped.</li>
<li>
<code>purge()</code> “purges” all elements below, above, to the
right or to the left of a pivot element by elementary row- or column-
operations. Here “purge” means that the elements are either reduced to
zero or that the degree of the elements is made smaller than the degree
of the pivot element.</li>
</ul>
</div>
</div>
</div>
<div class="section level2">
<h2 id="methods-for-statespace-forms">Methods for Statespace Forms<a class="anchor" aria-label="anchor" href="#methods-for-statespace-forms"></a>
</h2>
<div class="section level3">
<h3 id="balance">Grammians and Balanced Realizations<a class="anchor" aria-label="anchor" href="#balance"></a>
</h3>
<p>We consider a rational matrix <span class="math inline">\(K(z) =
C(z^{-1}I_s - A)^{-1} B +D\)</span> in state space form and we assume
that <span class="math inline">\(K\)</span> is stable, i.e. the
eigenvalues of the matrix <span class="math inline">\(A\)</span> have
moduli less than one.</p>
<p>The <em>controllability</em> Grammian of this statespace realization
is defined as <span class="math display">\[
P = \sum_{j\geq 0} A^j BB' (A')^j = APA' + BB'
\]</span> and the <em>observability</em> Grammian is <span class="math display">\[
Q = \sum_{j\geq 0} (A')^j C'C A^j = A'QA + C'C
\]</span> These Grammians may be computed with the routine
<code>grammians(obj)</code>.</p>
<p>The statespace realization is <em>minimal</em> if and only if <span class="math inline">\(P\)</span> and <span class="math inline">\(Q\)</span> are both positive definite. Furthermore
it can by shown that the product <span class="math inline">\(PQ\)</span>
is diagonalizable (with non negative (real) eigenvalues) and that the
rank of <span class="math inline">\(PQ\)</span> is equal to the minimal
statespace dimension of <span class="math inline">\(K(z)\)</span>,
i.e. there exists a statespace realization of <span class="math inline">\(K(z)\)</span> which has a statespace dimension
equal to the rank of <span class="math inline">\(PQ\)</span> and for any
statespace realization of <span class="math inline">\(K(z)\)</span> the
statespace dimension is larger than or equal to <span class="math inline">\(\mathrm{rk}(PQ)\)</span>.</p>
<p>If we apply a state space transformation <span class="math inline">\(T\)</span> then the Grammians transform as
follows</p>
<p><span class="math display">\[
P \longrightarrow TPT',\; Q \longrightarrow (T^{-1})' Q T^{-1}
\text{ and } PQ \longrightarrow TPQT^{-1}
\]</span></p>
<p>Let <span class="math inline">\(\sigma_1^2 \geq \sigma_2^2 \geq
\cdots \geq \sigma_{s}^2 \geq 0\)</span> denote the ordered eigenvalues
of <span class="math inline">\(PQ\)</span> and suppose that <span class="math inline">\(PQ\)</span> has rank <span class="math inline">\(s_0 \leq s\)</span>, i.e. <span class="math inline">\(\sigma_k&gt;0\)</span> for <span class="math inline">\(1\leq k \leq s_0\)</span> and <span class="math inline">\(\sigma_k=0\)</span> for <span class="math inline">\(k&gt;s_0\)</span>. Then there exists a state
transformation <span class="math inline">\(T\)</span> such that the two
transformed Grammians are both diagonal and the first <span class="math inline">\(s_0\)</span> diagonal entries of <span class="math inline">\(P\)</span> and of <span class="math inline">\(Q\)</span> are given by <span class="math inline">\(\sigma_k\)</span>, <span class="math inline">\(k=1,\ldots,s_0\)</span>. Therefore</p>
<p><span class="math display">\[
P = \begin{pmatrix}
    P_{11} &amp; 0 \\
    0      &amp; P_{22}
    \end{pmatrix},\;
Q = \begin{pmatrix}
    Q_{11} &amp; 0 \\
    0      &amp; Q_{22}
    \end{pmatrix}
\mbox{ with }
P_{11} = Q_{11} = \mbox{diag}(\sigma_1,\ldots,\sigma_{s_0})
\mbox{ and }
P_{22} Q_{22} = 0.
\]</span></p>
<p>The <span class="math inline">\(\sigma_k\)</span>’s are called the
<em>Hankel singular values</em> of the statespace realization since they
are the singular values of the Hankel matrix of the impulse response
coefficients.</p>
<p>A <em>minimal</em> statespace realization for <span class="math inline">\(K\)</span> then may simply computed by truncating
the transformed matrices <span class="math inline">\(A,B,C\)</span>. If
we partition the (transformed) state space matrices (conformingly to
<span class="math inline">\(P\)</span>, <span class="math inline">\(Q\)</span>) as <span class="math display">\[
A = \begin{pmatrix}
A_{11} &amp; A_{12} \\
A_{21} &amp; A_{22}
\end{pmatrix}, \;
B = \begin{pmatrix}
B_{1} \\
B_{2}
\end{pmatrix} \mbox{ and }
C = \begin{pmatrix}
C_{1} &amp; C_2
\end{pmatrix}
\]</span> then <span class="math inline">\(K(z) = C_1(z^{-1}I_{s_0}
-A_{11})^{-1} B_1 + D)\)</span> is a minimal statespace realization of
<span class="math inline">\(K\)</span>.</p>
<p><code>balance(obj, P,Q, s0, truncate = FALSE)</code> computes a
somewhat simplified balanced form, where the two blocks <span class="math inline">\(P_{22}\)</span> and <span class="math inline">\(Q_{22}\)</span> are <em>not</em> diagonal.</p>
<p>There are three possible scenarios</p>
<ul>
<li>the paramater <code>s0</code> is equal to the rank of <span class="math inline">\(PQ\)</span>. In this case <span class="math inline">\(P_{22}Q_{22} = 0\)</span> (up to numerical
errors).</li>
<li>the paramater <code>s0</code> is less than the rank of <span class="math inline">\(PQ\)</span>. In this case <span class="math inline">\(P_{22}Q_{22}\)</span> is not equal to zero.</li>
<li>the paramater <code>s0</code> is larger than the rank of <span class="math inline">\(PQ\)</span>. In this case the procedure may throw
an error.</li>
</ul>
<p>If the optional parameter <code>truncate=TRUE</code> then a
correspondingly truncated statespace realization is returned. In the
case that the paramater <code>s0</code> is less than the rank of <span class="math inline">\(PQ\)</span> this truncated realization is only an
approximate realization of the rational matrix <span class="math inline">\(K\)</span>. The approximation error depends on the
size of the “neglected” singular values. Note also that in this case the
statespace realization returned is not in balanced form, i.e. the
Grammians of this realization are not equal to <span class="math inline">\(P_{11}\)</span> and <span class="math inline">\(Q_{11}\)</span>.</p>
<p>If <span class="math inline">\(T=(T_1',T_2')'\)</span>,
<span class="math inline">\(S=T^{-1}=(S_1,S_2)\)</span> denotes the
statespace transformation, which gives the balanced form, then the
trancated system is <span class="math inline">\(A_{11}=T_1 A
S_1\)</span>, <span class="math inline">\(B_1=T_1 B\)</span>, <span class="math inline">\(C_1=CS_1\)</span> and <span class="math inline">\(D=D\)</span>. Note also that in this case
(<code>truncate=TRUE</code>) the procedure just returns <span class="math inline">\(T_1\)</span>, <span class="math inline">\(S_1\)</span> and not the “whole” transformation
matrices.</p>
<p>If we call <code>balance(obj, P, Q, s0=NULL, tol, truncate)</code>
then the procedure tries to determine the rank <span class="math inline">\(PQ\)</span> by inspecting the computed singular
values <span class="math inline">\(\sigma_k\)</span>. To be precise
<span class="math inline">\(s_0\)</span> is set to the number of
singular values <span class="math inline">\(\sigma_k\)</span> which are
larger than <code>tol</code> times the largest singular value <span class="math inline">\(\sigma_1\)</span>. This strategy fails if
<em>all</em> singular values are equal to zero (up to numerical
errors).</p>
<p>Above we have discussed balancing and balanced truncation for the
case of the controllabaility and the observability Grammian. This scheme
is sometimes called <em>Lyapunov balancing</em>. There are other
possible choices for a pair of Grammians, e.g. one may use the
controllabaility matrix and the observability matrix of the statespace
realization of the inverse <span class="math inline">\(K^{-1}\)</span>,
i.e.</p>
<p><span class="math display">\[
Q = (A-BD^{-1}C)' Q (A-BD^{-1}C) + C'C
\]</span></p>
<p>Of course for this choice the rational marix <span class="math inline">\(K\)</span> must be <em>minimum phase</em>,
i.e. the moduli of the eigenvalues of <span class="math inline">\(A-BD^{-1}C\)</span> must be smaller than one. This
balancing scheme is therefore called <em>minimum phase
balancing</em>.</p>
<p>Some details on how the balanced form is actually computed is given
in the vignette “Technical Details”.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># example A ############################################################</span></span>
<span></span>
<span><span class="co"># "obj" is a (1 by 1) rational matrix in statespace form,</span></span>
<span><span class="co"># with stespace dimension s = 2.</span></span>
<span></span>
<span><span class="va">obj</span> <span class="op">=</span> <span class="fu"><a href="../reference/stsp.html">stsp</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.2</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">0.5</span><span class="op">)</span>,</span>
<span>           B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gr</span> <span class="op">=</span> <span class="fu"><a href="../reference/grammians.html">grammians</a></span><span class="op">(</span><span class="va">obj</span>, <span class="st">'lyapunov'</span><span class="op">)</span></span>
<span><span class="va">bal</span> <span class="op">=</span> <span class="fu"><a href="../reference/balance.html">balance</a></span><span class="op">(</span><span class="va">obj</span>, <span class="va">gr</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">bal</span><span class="op">$</span><span class="va">P</span>, <span class="va">bal</span><span class="op">$</span><span class="va">Q</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">bal</span><span class="op">$</span><span class="va">sigma</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;          [,1]     [,2]     [,3]     [,4]     [,5]     [,6]</span></span>
<span><span class="co">#&gt; [1,] 1.586904 0.000000 1.586904 0.000000 1.586904 0.000000</span></span>
<span><span class="co">#&gt; [2,] 0.000000 1.458699 0.000000 1.458699 0.000000 1.458699</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="../reference/grammians.html">grammians</a></span><span class="op">(</span><span class="va">bal</span><span class="op">$</span><span class="va">obj</span><span class="op">)</span>, <span class="va">bal</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'P'</span>,<span class="st">'Q'</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="co"># example B (non minimal statespace realization #########################</span></span>
<span></span>
<span><span class="co"># The "rbind" operation below returns a statespace realization with</span></span>
<span><span class="co"># statespace dimension s = 4. However the minimal statespace dimensions</span></span>
<span><span class="co"># is s0 = 2.</span></span>
<span><span class="va">obj</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">obj</span>, <span class="va">obj</span><span class="op">)</span></span>
<span><span class="va">gr</span> <span class="op">=</span> <span class="fu"><a href="../reference/grammians.html">grammians</a></span><span class="op">(</span><span class="va">obj</span>, <span class="st">'lyapunov'</span><span class="op">)</span></span>
<span><span class="va">bal</span> <span class="op">=</span> <span class="fu"><a href="../reference/balance.html">balance</a></span><span class="op">(</span><span class="va">obj</span>, <span class="va">gr</span>, s0 <span class="op">=</span> <span class="fl">2</span>, truncate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the upper (2 by 2) block of the (transformed) controllability</span></span>
<span><span class="co"># Grammian is diagonal, the lower (2 by 2) block is "zero".</span></span>
<span><span class="co"># This shows that the (balanced) realization is not controllable.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bal</span><span class="op">$</span><span class="va">P</span><span class="op">)</span>  </span>
<span><span class="co">#&gt;          [,1]     [,2]          [,3]          [,4]</span></span>
<span><span class="co">#&gt; [1,] 2.244221 0.000000  0.000000e+00  0.000000e+00</span></span>
<span><span class="co">#&gt; [2,] 0.000000 2.062912  0.000000e+00  0.000000e+00</span></span>
<span><span class="co">#&gt; [3,] 0.000000 0.000000  2.272963e-32 -2.403037e-32</span></span>
<span><span class="co">#&gt; [4,] 0.000000 0.000000 -1.786739e-32  1.198986e-31</span></span>
<span></span>
<span><span class="co"># the upper (2 by 2) block of the (transformed) observability</span></span>
<span><span class="co"># Grammian is diagonal and equal to the upper block of bal$P.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bal</span><span class="op">$</span><span class="va">Q</span><span class="op">)</span></span>
<span><span class="co">#&gt;          [,1]     [,2]       [,3]       [,4]</span></span>
<span><span class="co">#&gt; [1,] 2.244221 0.000000 0.00000000 0.00000000</span></span>
<span><span class="co">#&gt; [2,] 0.000000 2.062912 0.00000000 0.00000000</span></span>
<span><span class="co">#&gt; [3,] 0.000000 0.000000 1.77315334 0.02695174</span></span>
<span><span class="co">#&gt; [4,] 0.000000 0.000000 0.02695174 1.00462444</span></span>
<span></span>
<span><span class="co"># the product of the (transformed) controllability and observability</span></span>
<span><span class="co"># Grammians is (approximately) diagonal and the diagonal entries are  </span></span>
<span><span class="co"># the squares of the Hankel singular values.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bal</span><span class="op">$</span><span class="va">P</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">bal</span><span class="op">$</span><span class="va">Q</span><span class="op">)</span></span>
<span><span class="co">#&gt;          [,1]     [,2]          [,3]          [,4]</span></span>
<span><span class="co">#&gt; [1,] 5.036528 0.000000  0.000000e+00  0.000000e+00</span></span>
<span><span class="co">#&gt; [2,] 0.000000 4.255604  0.000000e+00  0.000000e+00</span></span>
<span><span class="co">#&gt; [3,] 0.000000 0.000000  3.965545e-32 -2.352889e-32</span></span>
<span><span class="co">#&gt; [4,] 0.000000 0.000000 -2.845015e-32  1.199715e-31</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bal</span><span class="op">$</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>    </span>
<span><span class="co">#&gt; [1] 5.036528e+00 4.255604e+00 2.792357e-17 6.353796e-32</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="../reference/grammians.html">grammians</a></span><span class="op">(</span><span class="va">bal</span><span class="op">$</span><span class="va">obj</span><span class="op">)</span>, <span class="va">bal</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'P'</span>,<span class="st">'Q'</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="co"># we may construct a minimal realization by 'balanced truncation'.</span></span>
<span><span class="co"># note that we let the procedure determine the minimal statespace dimension</span></span>
<span><span class="va">trunc</span> <span class="op">=</span> <span class="fu"><a href="../reference/balance.html">balance</a></span><span class="op">(</span><span class="va">obj</span>, <span class="va">gr</span><span class="op">)</span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">trunc</span><span class="op">$</span><span class="va">obj</span><span class="op">)</span></span>
<span><span class="co">#&gt; statespace realization [2,1] with s = 2 states</span></span>
<span><span class="co">#&gt;            s[1]       s[2]       u[1]</span></span>
<span><span class="co">#&gt; s[1]  0.3498560  0.3119731 -1.3299446</span></span>
<span><span class="co">#&gt; s[2] -0.3119731 -0.8498560 -0.5954318</span></span>
<span><span class="co">#&gt; x[1] -0.9404128  0.4210339  1.0000000</span></span>
<span><span class="co">#&gt; x[2] -0.9404128  0.4210339  1.0000000</span></span>
<span><span class="co"># compare with the above balanced realization</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bal</span><span class="op">$</span><span class="va">obj</span><span class="op">)</span></span>
<span><span class="co">#&gt; statespace realization [2,1] with s = 4 states</span></span>
<span><span class="co">#&gt;               s[1]          s[2]          s[3]          s[4]          u[1]</span></span>
<span><span class="co">#&gt; s[1]  3.498560e-01  3.119731e-01 -1.747240e-16  1.694153e-17 -1.329945e+00</span></span>
<span><span class="co">#&gt; s[2] -3.119731e-01 -8.498560e-01 -9.478857e-17 -1.914317e-16 -5.954318e-01</span></span>
<span><span class="co">#&gt; s[3]  3.687444e-17  1.314776e-17 -8.147341e-01 -7.816872e-02  5.551115e-17</span></span>
<span><span class="co">#&gt; s[4] -6.500433e-17 -1.117170e-16  7.218313e-01  3.147341e-01  2.220446e-16</span></span>
<span><span class="co">#&gt; x[1] -9.404128e-01  4.210339e-01  2.284728e-01 -6.691787e-01  1.000000e+00</span></span>
<span><span class="co">#&gt; x[2] -9.404128e-01  4.210339e-01 -2.284728e-01  6.691787e-01  1.000000e+00</span></span>
<span><span class="co"># check</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="../reference/pseries.html">pseries</a></span><span class="op">(</span><span class="va">obj</span><span class="op">)</span>, <span class="fu"><a href="../reference/pseries.html">pseries</a></span><span class="op">(</span><span class="va">trunc</span><span class="op">$</span><span class="va">obj</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="co"># example C (balanced truncation) ##########################</span></span>
<span></span>
<span><span class="co"># construct a random rational matrix with statespace dimension s=10</span></span>
<span><span class="va">obj</span> <span class="op">=</span> <span class="fu"><a href="../reference/test_stsp.html">test_stsp</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, s <span class="op">=</span> <span class="fl">10</span>, bpoles <span class="op">=</span> <span class="fl">1</span>, bzeroes <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># compute an approximate realization with s0 = 8</span></span>
<span><span class="va">gr</span> <span class="op">=</span> <span class="fu"><a href="../reference/grammians.html">grammians</a></span><span class="op">(</span><span class="va">obj</span>, <span class="st">'minimum phase'</span><span class="op">)</span></span>
<span><span class="va">trunc</span> <span class="op">=</span> <span class="fu"><a href="../reference/balance.html">balance</a></span><span class="op">(</span><span class="va">obj</span>, <span class="va">gr</span>, s0 <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">trunc</span><span class="op">$</span><span class="va">sigma</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 1.48858057 1.27641368 0.98417775 0.60004923 0.36379776 0.26893054</span></span>
<span><span class="co">#&gt;  [7] 0.14144190 0.11147519 0.05039678 0.01249503</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span><span class="fu"><a href="../reference/pseries.html">pseries</a></span><span class="op">(</span><span class="va">obj</span>, lag.max <span class="op">=</span> <span class="fl">25</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span><span class="fu"><a href="../reference/pseries.html">pseries</a></span><span class="op">(</span><span class="va">trunc</span><span class="op">$</span><span class="va">ob</span>, lag.max <span class="op">=</span> <span class="fl">25</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.09516145</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/pseries.html">pseries</a></span><span class="op">(</span><span class="va">obj</span>, lag.max <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>, x_list<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/pseries.html">pseries</a></span><span class="op">(</span><span class="va">trunc</span><span class="op">$</span><span class="va">obj</span>, lag.max <span class="op">=</span> <span class="fl">25</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'l'</span>,<span class="st">'p'</span><span class="op">)</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'s=10'</span>, <span class="st">'s=5'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="a_rational_matrices_files/figure-html/unnamed-chunk-34-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="reflect-poles-or-zeroes-by-multiplication-with-all-pass-matrices">Reflect Poles or Zeroes by Multiplication with All Pass
Matrices<a class="anchor" aria-label="anchor" href="#reflect-poles-or-zeroes-by-multiplication-with-all-pass-matrices"></a>
</h3>
<p>The algorithm outlined in “<a href="#blaschke">Reflect Zeroes by
Multiplication with All Pass Matrices</a>” to flip the zeroes of a
multivariate polynomial matrix has a statespace analogon. Let <span class="math inline">\(K(z)=C(z^{-1}I-A)^{-1}B+D\)</span> be a square,
rational matrix in statespace form and suppose that <span class="math inline">\(\alpha_1,\ldots,\alpha_k\)</span> are zeroes of
<span class="math inline">\(K(z)\)</span>. There exists an allpass
(rational) function <span class="math inline">\(U(z)\)</span>, <span class="math inline">\(UU^*=U^*U=I\)</span> such that<br><span class="math inline">\(K(z)U(z)\)</span> is a rational matrix,
where the roots <span class="math inline">\(\alpha_i\)</span> have been
replaced by the “flipped” roots <span class="math inline">\(1/\bar{\alpha}_i\)</span>. Both <span class="math inline">\(KU\)</span> and <span class="math inline">\(U\)</span> have a statespace realization, which is
computed by the routine <code><a href="../reference/reflect_zeroes.html">reflect_zeroes()</a></code>.</p>
<p>Quite analogously one may also mirror the poles of <span class="math inline">\(K\)</span>.</p>
<p>The construction of the allpass function <span class="math inline">\(U\)</span> is outlined in the vignette “technical
details”.</p>
</div>
<div class="section level3">
<h3 id="h2-norm-and-orthogonalization">H2 norm and orthogonalization<a class="anchor" aria-label="anchor" href="#h2-norm-and-orthogonalization"></a>
</h3>
<p>Create a vector of rational functions of the form <span class="math inline">\(1/(1-0.9z)^k\)</span>, <span class="math inline">\(k=1,2,3,4\)</span>:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">K0</span> <span class="op">=</span> <span class="fu"><a href="../reference/polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">0.9</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">K</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">K0</span>,</span>
<span>          <span class="va">K0</span><span class="op">^</span><span class="fl">2</span>,</span>
<span>          <span class="va">K0</span><span class="op">^</span><span class="fl">3</span>,</span>
<span>          <span class="va">K0</span><span class="op">^</span><span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p>The statespac realization (<code>K</code>) is not minimal. (Minimal
state dimension is <span class="math inline">\(s=4\)</span>.) Use
balance to construct a minimal realization:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># K is not minimal! minimal state dimension = 4</span></span>
<span><span class="va">gr</span> <span class="op">=</span> <span class="fu"><a href="../reference/grammians.html">grammians</a></span><span class="op">(</span><span class="va">K</span>, <span class="st">'lyapunov'</span><span class="op">)</span></span>
<span><span class="va">out</span> <span class="op">=</span> <span class="fu"><a href="../reference/balance.html">balance</a></span><span class="op">(</span><span class="va">K</span>, <span class="va">gr</span>, s <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">sigma</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 6.876057e+03 2.133678e+03 2.994808e+02 1.691065e+01 2.725611e-06</span></span>
<span><span class="co">#&gt;  [6] 9.858548e-07 2.501330e-07 1.723756e-07 1.170216e-13 5.639412e-15</span></span>
<span><span class="co"># check</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="../reference/zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">K</span>, n.f <span class="op">=</span> <span class="fl">2</span><span class="op">^</span><span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="../reference/zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">obj</span>, n.f <span class="op">=</span> <span class="fl">2</span><span class="op">^</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="va">K</span> <span class="op">=</span> <span class="va">out</span><span class="op">$</span><span class="va">obj</span></span></code></pre></div>
<p>Orthormalize the components of <span class="math inline">\(K\)</span>
with respect to the <span class="math inline">\(H_2\)</span> inner
product.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">P</span> <span class="op">=</span> <span class="fu"><a href="../reference/lyapunov.html">lyapunov</a></span><span class="op">(</span><span class="va">K</span><span class="op">$</span><span class="va">A</span>, <span class="va">K</span><span class="op">$</span><span class="va">B</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">K</span><span class="op">$</span><span class="va">B</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Q</span> <span class="op">=</span> <span class="va">K</span><span class="op">$</span><span class="va">C</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">P</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">K</span><span class="op">$</span><span class="va">C</span><span class="op">)</span> <span class="op">+</span> <span class="va">K</span><span class="op">$</span><span class="va">D</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">K</span><span class="op">$</span><span class="va">D</span><span class="op">)</span></span>
<span></span>
<span><span class="va">K0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chol.html" class="external-link">chol</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/ratm_mult.html">%r%</a></span> <span class="va">K</span></span>
<span><span class="va">K0</span></span>
<span><span class="co">#&gt; statespace realization [4,1] with s = 4 states</span></span>
<span><span class="co">#&gt;              s[1]         s[2]        s[3]         s[4]        u[1]</span></span>
<span><span class="co">#&gt; s[1]  0.987214209  0.040644523 -0.01291412  0.002910154 -13.0817697</span></span>
<span><span class="co">#&gt; s[2] -0.040708578  0.943474772  0.06640124 -0.011901623 -14.8888604</span></span>
<span><span class="co">#&gt; s[3] -0.013472533 -0.067431696  0.87486975  0.066882649  -7.6963271</span></span>
<span><span class="co">#&gt; s[4] -0.003765234 -0.014720809 -0.07238612  0.794441274  -2.0269817</span></span>
<span><span class="co">#&gt; x[1] -0.007922199 -0.012583407 -0.01155208 -0.006119112   0.4358899</span></span>
<span><span class="co">#&gt; x[2] -0.008403204  0.006876849  0.02867369  0.028174871  -0.3923009</span></span>
<span><span class="co">#&gt; x[3] -0.002982258  0.015426702 -0.02592047 -0.078870839   0.3530708</span></span>
<span><span class="co">#&gt; x[4] -0.001299696  0.001345163 -0.03521625  0.174025836  -0.3177637</span></span>
<span></span>
<span><span class="co"># check</span></span>
<span><span class="va">P</span> <span class="op">=</span> <span class="fu"><a href="../reference/lyapunov.html">lyapunov</a></span><span class="op">(</span><span class="va">K0</span><span class="op">$</span><span class="va">A</span>, <span class="va">K0</span><span class="op">$</span><span class="va">B</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">K0</span><span class="op">$</span><span class="va">B</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Q</span> <span class="op">=</span> <span class="va">K0</span><span class="op">$</span><span class="va">C</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">P</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">K0</span><span class="op">$</span><span class="va">C</span><span class="op">)</span> <span class="op">+</span> <span class="va">K0</span><span class="op">$</span><span class="va">D</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">K0</span><span class="op">$</span><span class="va">D</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">Q</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Plot frequency response</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fr</span> <span class="op">=</span> <span class="fu"><a href="../reference/zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">K0</span>, n.f <span class="op">=</span> <span class="fl">2</span><span class="op">^</span><span class="fl">12</span><span class="op">)</span></span>
<span><span class="va">fr0</span> <span class="op">=</span> <span class="fu"><a href="../reference/zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">K0</span>, n.f <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">legend</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">K</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">K</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">K</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">K</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fr</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span>, x_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fr</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">fr</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">fr</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, which <span class="op">=</span> <span class="st">'modulus'</span>,</span>
<span>     legend <span class="op">=</span> <span class="va">legend</span><span class="op">)</span></span></code></pre></div>
<p><img src="a_rational_matrices_files/figure-html/unnamed-chunk-38-1.png" width="576"></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fr</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span>, x_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fr</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">fr</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">fr</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, which <span class="op">=</span> <span class="st">'phase'</span>,</span>
<span>     legend <span class="op">=</span> <span class="va">legend</span><span class="op">)</span></span></code></pre></div>
<p><img src="a_rational_matrices_files/figure-html/unnamed-chunk-38-2.png" width="576"></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fr</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span>, x_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fr</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">fr</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">fr</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, which <span class="op">=</span> <span class="st">'nyquist'</span>,</span>
<span>     legend <span class="op">=</span> <span class="va">legend</span><span class="op">)</span></span></code></pre></div>
<p><img src="a_rational_matrices_files/figure-html/unnamed-chunk-38-3.png" width="576"></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">subfigures.main</span> <span class="op">=</span> <span class="va">legend</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">subfigures.main</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">fr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">fr</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     x_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">fr0</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">fr0</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'l'</span>,<span class="st">'p'</span><span class="op">)</span>, cex.points <span class="op">=</span> <span class="fl">0.1</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'red'</span>,<span class="st">'black'</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">20</span>,</span>
<span>     which <span class="op">=</span> <span class="st">'nyquist'</span>, subfigures.main <span class="op">=</span> <span class="va">subfigures.main</span><span class="op">)</span></span></code></pre></div>
<p><img src="a_rational_matrices_files/figure-html/unnamed-chunk-38-4.png" width="576"></p>
<p>Compute reduced order model (s = 3)</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gr</span> <span class="op">=</span> <span class="fu"><a href="../reference/grammians.html">grammians</a></span><span class="op">(</span><span class="va">K0</span>, <span class="st">'lyapunov'</span><span class="op">)</span></span>
<span><span class="va">out</span> <span class="op">=</span> <span class="fu"><a href="../reference/balance.html">balance</a></span><span class="op">(</span><span class="va">K0</span>, <span class="va">gr</span>, s <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">sigma</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 6.645557 4.594142 2.803345 1.040294</span></span>
<span><span class="va">Kh</span> <span class="op">=</span> <span class="va">out</span><span class="op">$</span><span class="va">obj</span></span>
<span><span class="va">frh</span> <span class="op">=</span> <span class="fu"><a href="../reference/zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">Kh</span>, n.f <span class="op">=</span> <span class="fl">2</span><span class="op">^</span><span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">fr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">fr</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     x_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">frh</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">frh</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     which <span class="op">=</span> <span class="st">'nyquist'</span>, subfigures.main <span class="op">=</span> <span class="va">subfigures.main</span>,</span>
<span>     legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">K</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">hat</a></span><span class="op">(</span><span class="va">K</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="a_rational_matrices_files/figure-html/unnamed-chunk-39-1.png" width="576"></p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Wolfgang Scherrer, Bernd Funovits.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
