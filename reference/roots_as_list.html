<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This helper function coerces a vector of (complex or real) roots into a list. 
For a complex conjugate pair of roots, only the one with a positive 
imaginary part is retained."><title>Polynomial Roots as List — roots_as_list • rationalmatrices</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Polynomial Roots as List — roots_as_list"><meta property="og:description" content="This helper function coerces a vector of (complex or real) roots into a list. 
For a complex conjugate pair of roots, only the one with a positive 
imaginary part is retained."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rationalmatrices</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a_rational_matrices.html">Rational Matrices</a>
    <a class="dropdown-item" href="../articles/b_technical_details_ratm.html">Rational Matrices: Technical Details</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bfunovits/rationalmatrices/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Polynomial Roots as List</h1>
      
      <div class="d-none name"><code>roots_as_list.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This helper function coerces a vector of (complex or real) roots into a list. 
For a complex conjugate pair of roots, only the one with a positive 
imaginary part is retained.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">roots_as_list</span><span class="op">(</span><span class="va">roots</span>, tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>roots</dt>
<dd><p>Vector of cplx or doubles. Obtained e.g. from a call 
to <code><a href="poles_and_zeroes.html">zeroes</a></code>.</p></dd>


<dt>tol</dt>
<dd><p>Double. Tolerance parameter used to decide whether roots 
and conjugate roots "match".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>List of roots. For complex conjugated pairs of roots, only the ones 
        with positive part are returned. The procedure orders the roots 
        according to their imaginary part, and thus real roots come first.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The routine assumes that complex roots appear, up to some small numerical
errors, in complex conjugate pairs. Therefore the procedure tries to match
the roots with their complex conjugates. If this is not possible, then an
error is thrown.</p>
<p>Roots, which are classified as real, are replaced by their real part.
Roots, which are classified as complex, are replaced by the mean of the 
root and the best matching conjugate root.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>The matching of conjugate roots is done by the internal 
         helper function <code><a href="match_vectors.html">match_vectors</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">=</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>   <span class="co"># coefficients of a random polynomial a(z) of degree p = 5</span></span></span>
<span class="r-in"><span><span class="va">z</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/polyroot.html" class="external-link">polyroot</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>  <span class="co"># compute the roots of a(z)</span></span></span>
<span class="r-in"><span><span class="va">z</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  0.2353419+0.9290992i -0.5313699+0.3107316i -0.5313699-0.3107316i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4]  0.9253355-0.0000000i  0.2353419-0.9290992i</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># try to match roots and conjugate roots</span></span></span>
<span class="r-in"><span><span class="va">j</span> <span class="op">=</span> <span class="fu"><a href="match_vectors.html">match_vectors</a></span><span class="op">(</span><span class="va">z</span>, <span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Conj</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># z is approximately equal to Conj( z[j] )</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>z <span class="op">=</span> <span class="va">z</span>, j <span class="op">=</span> <span class="va">j</span>, `Conj(z[j])` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Conj</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>, d <span class="op">=</span> <span class="va">z</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Conj</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       z j            Conj.z.j..                           d</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.2353419+0.9290992i 5  0.2353419+0.9290992i  1.221245e-15-9.992007e-16i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -0.5313699+0.3107316i 3 -0.5313699+0.3107316i  3.108624e-15+1.887379e-15i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -0.5313699-0.3107316i 2 -0.5313699-0.3107316i -3.108624e-15+1.887379e-15i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.9253355-0.0000000i 4  0.9253355+0.0000000i  0.000000e+00-1.750357e-15i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  0.2353419-0.9290992i 1  0.2353419-0.9290992i -1.221245e-15-9.992007e-16i</span>
<span class="r-in"><span><span class="co"># z[1] and z[5] are complex conjugates (up to numerical errors)</span></span></span>
<span class="r-in"><span><span class="co"># z[2] and z[3] are complex conjugates (up to numerical errors)</span></span></span>
<span class="r-in"><span><span class="co"># z[4] is real (up to numerical errors)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># coerce the vector "z" to a list</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">z_list</span> <span class="op">=</span> <span class="fu">roots_as_list</span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9253355</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.5313699+0.3107316i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2353419+0.9290992i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># the first slot contains the real root (and thus is of class "numeric")</span></span></span>
<span class="r-in"><span><span class="co"># z_list[[1]] = Re(z[4])</span></span></span>
<span class="r-in"><span><span class="co"># the slots 2 and 3 contain the complex roots and thus are of class "complex"</span></span></span>
<span class="r-in"><span><span class="co"># z_list[[2]] = (z[2] + Conj(z[3])/2</span></span></span>
<span class="r-in"><span><span class="co"># z_list[[3]] = (z[1] + Conj(z[5])/2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The routine zeroes() uses the function eigen() </span></span></span>
<span class="r-in"><span><span class="co"># (to compute the eigenvalues of the companion matrix) </span></span></span>
<span class="r-in"><span><span class="co"># and thus returns exact conjugate pairs:</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">z</span> <span class="op">=</span> <span class="fu"><a href="poles_and_zeroes.html">zeroes</a></span><span class="op">(</span><span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.5313699-0.3107316i -0.5313699+0.3107316i  0.9253355+0.0000000i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4]  0.2353419-0.9290992i  0.2353419+0.9290992i</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># match roots and conjugate roots</span></span></span>
<span class="r-in"><span><span class="va">j</span> <span class="op">=</span> <span class="fu"><a href="match_vectors.html">match_vectors</a></span><span class="op">(</span><span class="va">z</span>, <span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Conj</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># z is equal to Conj(z[j])</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">j</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 1 3 5 4</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">z</span>, <span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Conj</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># coerce the vector "z" to a list</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">z_list</span> <span class="op">=</span> <span class="fu">roots_as_list</span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9253355</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.5313699+0.3107316i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2353419+0.9290992i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://scholar.google.com/citations?user=-Ytb9BYAAAAJ" class="external-link">Wolfgang Scherrer</a>, <a href="https://ch.linkedin.com/in/bernd-funovits-phd-cfa-a8215016" class="external-link">Bernd Funovits</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

