<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Polynomial Roots as List — roots_as_list • rationalmatrices</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Polynomial Roots as List — roots_as_list"><meta name="description" content="This helper function coerces a vector of (complex or real) roots into a list.
For a complex conjugate pair of roots, only the one with a positive
imaginary part is retained."><meta property="og:description" content="This helper function coerces a vector of (complex or real) roots into a list.
For a complex conjugate pair of roots, only the one with a positive
imaginary part is retained."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rationalmatrices</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/a_rational_matrices.html">Rational Matrices</a></li>
    <li><a class="dropdown-item" href="../articles/b_technical_details_ratm.html">Rational Matrices: Technical Details</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bfunovits/rationalmatrices/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Polynomial Roots as List</h1>

      <div class="d-none name"><code>roots_as_list.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This helper function coerces a vector of (complex or real) roots into a list.
For a complex conjugate pair of roots, only the one with a positive
imaginary part is retained.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">roots_as_list</span><span class="op">(</span><span class="va">roots</span>, tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-roots">roots<a class="anchor" aria-label="anchor" href="#arg-roots"></a></dt>
<dd><p>Vector of cplx or doubles. Obtained e.g. from a call
to <code><a href="poles_and_zeroes.html">zeroes</a></code>.</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>Double. Tolerance parameter used to decide whether roots
and conjugate roots "match".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List of roots. For complex conjugated pairs of roots, only the ones
        with positive part are returned. The procedure orders the roots
        according to their imaginary part, and thus real roots come first.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The routine assumes that complex roots appear, up to some small numerical
errors, in complex conjugate pairs. Therefore the procedure tries to match
the roots with their complex conjugates. If this is not possible, then an
error is thrown.</p>
<p>Roots, which are classified as real, are replaced by their real part.
Roots, which are classified as complex, are replaced by the mean of the
root and the best matching conjugate root.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>The matching of conjugate roots is done by the internal
         helper function <code><a href="match_vectors.html">match_vectors</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">=</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>   <span class="co"># coefficients of a random polynomial a(z) of degree p = 5</span></span></span>
<span class="r-in"><span><span class="va">z</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/polyroot.html" class="external-link">polyroot</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>  <span class="co"># compute the roots of a(z)</span></span></span>
<span class="r-in"><span><span class="va">z</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  0.2353419+9.290992e-01i -0.5313699+3.107316e-01i -0.5313699-3.107316e-01i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4]  0.9253355-8.751787e-16i  0.2353419-9.290992e-01i</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># try to match roots and conjugate roots</span></span></span>
<span class="r-in"><span><span class="va">j</span> <span class="op">=</span> <span class="fu"><a href="match_vectors.html">match_vectors</a></span><span class="op">(</span><span class="va">z</span>, <span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Conj</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># z is approximately equal to Conj( z[j] )</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>z <span class="op">=</span> <span class="va">z</span>, j <span class="op">=</span> <span class="va">j</span>, `Conj(z[j])` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Conj</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>, d <span class="op">=</span> <span class="va">z</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Conj</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          z j               Conj.z.j..</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.2353419+9.290992e-01i 5  0.2353419+9.290992e-01i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -0.5313699+3.107316e-01i 3 -0.5313699+3.107316e-01i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -0.5313699-3.107316e-01i 2 -0.5313699-3.107316e-01i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.9253355-8.751787e-16i 4  0.9253355+8.751787e-16i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  0.2353419-9.290992e-01i 1  0.2353419-9.290992e-01i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                             d</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1.221245e-15-9.992007e-16i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  3.108624e-15+1.887379e-15i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -3.108624e-15+1.887379e-15i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.000000e+00-1.750357e-15i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 -1.221245e-15-9.992007e-16i</span>
<span class="r-in"><span><span class="co"># z[1] and z[5] are complex conjugates (up to numerical errors)</span></span></span>
<span class="r-in"><span><span class="co"># z[2] and z[3] are complex conjugates (up to numerical errors)</span></span></span>
<span class="r-in"><span><span class="co"># z[4] is real (up to numerical errors)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># coerce the vector "z" to a list</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">z_list</span> <span class="op">=</span> <span class="fu">roots_as_list</span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9253355</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.5313699+0.3107316i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2353419+0.9290992i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># the first slot contains the real root (and thus is of class "numeric")</span></span></span>
<span class="r-in"><span><span class="co"># z_list[[1]] = Re(z[4])</span></span></span>
<span class="r-in"><span><span class="co"># the slots 2 and 3 contain the complex roots and thus are of class "complex"</span></span></span>
<span class="r-in"><span><span class="co"># z_list[[2]] = (z[2] + Conj(z[3])/2</span></span></span>
<span class="r-in"><span><span class="co"># z_list[[3]] = (z[1] + Conj(z[5])/2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The routine zeroes() uses the function eigen() </span></span></span>
<span class="r-in"><span><span class="co"># (to compute the eigenvalues of the companion matrix) </span></span></span>
<span class="r-in"><span><span class="co"># and thus returns exact conjugate pairs:</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">z</span> <span class="op">=</span> <span class="fu"><a href="poles_and_zeroes.html">zeroes</a></span><span class="op">(</span><span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.5313699-0.3107316i -0.5313699+0.3107316i  0.9253355+0.0000000i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4]  0.2353419-0.9290992i  0.2353419+0.9290992i</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># match roots and conjugate roots</span></span></span>
<span class="r-in"><span><span class="va">j</span> <span class="op">=</span> <span class="fu"><a href="match_vectors.html">match_vectors</a></span><span class="op">(</span><span class="va">z</span>, <span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Conj</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># z is equal to Conj(z[j])</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">j</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 1 3 5 4</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">z</span>, <span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Conj</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># coerce the vector "z" to a list</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">z_list</span> <span class="op">=</span> <span class="fu">roots_as_list</span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9253355</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.5313699+0.3107316i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2353419+0.9290992i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://scholar.google.com/citations?user=-Ytb9BYAAAAJ" class="external-link">Wolfgang Scherrer</a>, <a href="https://ch.linkedin.com/in/bernd-funovits-phd-cfa-a8215016" class="external-link">Bernd Funovits</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

