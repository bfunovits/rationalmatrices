<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Prune (Laurent) Matrix Polynomial — prune • rationalmatrices</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Prune (Laurent) Matrix Polynomial — prune"><meta name="description" content="Performs three steps to simplify a matrix polynomial.
All leading coefficients where the absolute values of the real and the imaginary parts are
  less than or equal to tol are set to zero.
  For Laurent polynomials, the same is happening from the other direction.
The zero leading coefficient matrices are dropped.
  For Laurent polynomials, the same is happening for the coefficient matrices pertaining to low powers.
If all the absolute values of the imaginary parts of the coefficients are less than or
      equal to tol then the coefficients are set to real values.
Empty polynomial matrices (i.e. matrices with zero rows or columns) are set to polynomial of zero degree."><meta property="og:description" content="Performs three steps to simplify a matrix polynomial.
All leading coefficients where the absolute values of the real and the imaginary parts are
  less than or equal to tol are set to zero.
  For Laurent polynomials, the same is happening from the other direction.
The zero leading coefficient matrices are dropped.
  For Laurent polynomials, the same is happening for the coefficient matrices pertaining to low powers.
If all the absolute values of the imaginary parts of the coefficients are less than or
      equal to tol then the coefficients are set to real values.
Empty polynomial matrices (i.e. matrices with zero rows or columns) are set to polynomial of zero degree."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rationalmatrices</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/a_rational_matrices.html">Rational Matrices</a></li>
    <li><a class="dropdown-item" href="../articles/b_technical_details_ratm.html">Rational Matrices: Technical Details</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bfunovits/rationalmatrices/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Prune (Laurent) Matrix Polynomial</h1>

      <div class="d-none name"><code>prune.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs three steps to simplify a matrix polynomial.</p><ol><li><p>All leading coefficients where the absolute values of the real and the imaginary parts are
  less than or equal to <code>tol</code> are set to zero.
  For Laurent polynomials, the same is happening from the other direction.</p></li>
<li><p>The zero leading coefficient matrices are dropped.
  For Laurent polynomials, the same is happening for the coefficient matrices pertaining to low powers.</p></li>
<li><p>If all the absolute values of the imaginary parts of the coefficients are less than or
      equal to <code>tol</code> then the coefficients are set to real values.</p></li>
</ol><p>Empty polynomial matrices (i.e. matrices with zero rows or columns) are set to polynomial of zero degree.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">prune</span><span class="op">(</span><span class="va">x</span>, tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">)</span>, brutal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p><code><a href="polm.html">polm</a></code> or <code><a href="lpolm.html">lpolm</a></code> object.</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>Double. Tolerance parameter. Default set to <code>sqrt(.Machine$double.eps)</code>.</p></dd>


<dt id="arg-brutal">brutal<a class="anchor" aria-label="anchor" href="#arg-brutal"></a></dt>
<dd><p>Boolean. Default set to FALSE.
If TRUE, all small elements are set to zero (irrespective of whether they are leading
coefficients or not).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A Laurent matrix polynomial, i.e. a <code><a href="polm.html">polm</a></code> or <code><a href="lpolm.html">lpolm</a></code> object.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1e-4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 2 x 2 ) matrix polynomial with degree &lt;= 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2] z^1 [,1]  [,2] z^2 [,1]   [,2] z^3 [,1]   [,2] z^4 [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   1.0001 1e-04   0.0001 1e-04    1e-04 1.0001    1e-04 0.0001    1e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   0.0001 1e-04   1.0001 1e-04    1e-04 0.0001    1e-04 1.0001    1e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 1e-04</span>
<span class="r-in"><span><span class="fu">prune</span><span class="op">(</span><span class="va">x</span>, tol <span class="op">=</span> <span class="fl">1e-3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 2 x 2 ) matrix polynomial with degree &lt;= 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2] z^1 [,1]  [,2] z^2 [,1]   [,2] z^3 [,1]   [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   1.0001 1e-04   0.0000 1e-04        0 1.0001        0 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   0.0001 1e-04   1.0001 1e-04        0 0.0001        0 1.0001</span>
<span class="r-in"><span><span class="fu">prune</span><span class="op">(</span><span class="va">x</span>, tol <span class="op">=</span> <span class="fl">1e-3</span>, brutal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 2 x 2 ) matrix polynomial with degree &lt;= 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2] z^1 [,1]  [,2] z^2 [,1]   [,2] z^3 [,1]   [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   1.0001     0   0.0000     0        0 1.0001        0 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   0.0000     0   1.0001     0        0 0.0000        0 1.0001</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Case of complex variables:</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">=</span> <span class="va">x</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">complex</a></span><span class="op">(</span>imaginary <span class="op">=</span> <span class="fl">1e-5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 2 x 2 ) matrix polynomial with degree &lt;= 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           z^0 [,1]         [,2]  z^1 [,1]     [,2] z^2 [,1]      [,2] z^3 [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.0001+1e-05i 1e-04+1e-05i 0.0001+0i 1e-04+0i 1e-04+0i 1.0001+0i 1e-04+0i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.0001+1e-05i 1e-04+1e-05i 1.0001+0i 1e-04+0i 1e-04+0i 0.0001+0i 1e-04+0i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,2] z^4 [,1]     [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.0001+0i 1e-04+0i 1e-04+0i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 1.0001+0i 1e-04+0i 1e-04+0i</span>
<span class="r-in"><span><span class="fu">prune</span><span class="op">(</span><span class="va">x</span>, tol <span class="op">=</span> <span class="fl">1e-3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 2 x 2 ) matrix polynomial with degree &lt;= 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2] z^1 [,1]  [,2] z^2 [,1]   [,2] z^3 [,1]   [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   1.0001 1e-04   0.0000 1e-04        0 1.0001        0 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   0.0001 1e-04   1.0001 1e-04        0 0.0001        0 1.0001</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># also works for constant matrix polynomials (i.e. matrices)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">3</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fl">1e-4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 2 x 2 ) matrix polynomial with degree &lt;= 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]   [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   0.0001 2.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   1.0001 3.0001</span>
<span class="r-in"><span><span class="fu">prune</span><span class="op">(</span><span class="va">x</span>, tol <span class="op">=</span> <span class="fl">1e-3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 2 x 2 ) matrix polynomial with degree &lt;= 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]   [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   0.0000 2.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   1.0001 3.0001</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># empty polynomials are coerced to polynomials of degree zero </span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">0</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 0 x 2 ) matrix polynomial with degree &lt;= 4 </span>
<span class="r-in"><span><span class="fu">prune</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 0 x 2 ) matrix polynomial with degree &lt;= -1 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Laurent polynomials:</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">lp</span> <span class="op">=</span> <span class="fu"><a href="lpolm.html">lpolm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">0</span><span class="op">)</span>, min_deg <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 1 x 1 ) Laurent polynomial matrix with degree &lt;= 6, and minimal degree &gt;= 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^2 [,1] z^3 [,1] z^4 [,1] z^5 [,1] z^6 [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        0        1        2        3        0</span>
<span class="r-in"><span><span class="fu">prune</span><span class="op">(</span><span class="va">lp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 1 x 1 ) Laurent polynomial matrix with degree &lt;= 5, and minimal degree &gt;= 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^3 [,1] z^4 [,1] z^5 [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1        2        3</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://scholar.google.com/citations?user=-Ytb9BYAAAAJ" class="external-link">Wolfgang Scherrer</a>, <a href="https://ch.linkedin.com/in/bernd-funovits-phd-cfa-a8215016" class="external-link">Bernd Funovits</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

