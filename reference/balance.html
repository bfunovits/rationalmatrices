<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Balanced Realization and Balanced Truncation — balance • rationalmatrices</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Balanced Realization and Balanced Truncation — balance"><meta name="description" content="Compute a balanced realization or a balanced truncated statespace realization
of a rational matrix in statespace form."><meta property="og:description" content="Compute a balanced realization or a balanced truncated statespace realization
of a rational matrix in statespace form."><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rationalmatrices</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/a_rational_matrices.html">Rational Matrices</a></li>
    <li><a class="dropdown-item" href="../articles/b_technical_details_ratm.html">Rational Matrices: Technical Details</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../claude.html">Claude Guide</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bfunovits/rationalmatrices/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Balanced Realization and Balanced Truncation</h1>

      <div class="d-none name"><code>balance.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute a balanced realization or a balanced truncated statespace realization
of a rational matrix in statespace form.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">balance</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  <span class="va">gr</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">10</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">)</span>,</span>
<span>  s0 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  truncate <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-obj">obj<a class="anchor" aria-label="anchor" href="#arg-obj"></a></dt>
<dd><p>(<code><a href="stsp.html">stsp</a></code> object) rational matrix in statespace form.</p></dd>


<dt id="arg-gr">gr<a class="anchor" aria-label="anchor" href="#arg-gr"></a></dt>
<dd><p>a list with two components <code>P</code> and <code>Q</code> which contain two Grammians.
These Grammians may e.g. be computed with <code><a href="grammians.html">grammians</a></code>.</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>a tolerance parameter used for the determination of the rank \(PQ\).
If <code>s0 = NULL</code> then the procedure estimates the rank of \(PQ\)
and sets <code>s0</code> equal to this estimate. If <code>s0</code> is given,
then <code>tol</code> is ignored.</p></dd>


<dt id="arg-s-">s0<a class="anchor" aria-label="anchor" href="#arg-s-"></a></dt>
<dd><p>determines the  size of the two diagonal blocks of transformed
Grammians \(P\), \(Q\), respectively (for <code>truncate = TRUE</code>
the statespace dimension of the balanced truncated statespace realization.</p></dd>


<dt id="arg-truncate">truncate<a class="anchor" aria-label="anchor" href="#arg-truncate"></a></dt>
<dd><p>(boolean) If true then the balanced truncated model is returned.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with components</p>
<dl><dt>obj</dt>
<dd><p>(<code><a href="stsp.html">stsp</a></code> object) represents the balanced (truncated) statespace
           realization.</p></dd>

<dt>T,Tinv</dt>
<dd><p>the state transformation and the inverse state transformation matrix.
              Note that for the case <code>truncate=TRUE</code> the matrix <code>T</code> is
              an <code>s0 x s</code> matrix and <code>Tinv</code> is of dimension <code>s x s0</code>.</p></dd>

<dt>P,Q</dt>
<dd><p>the transformed (and truncated) Grammians.</p></dd>

<dt>sigma</dt>
<dd><p>the vector of singular values of the matrix \((P^{1/2}Q^{1/2})\).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Let \(P,Q\) denote the controllability and the observability Grammian of a statespace
realization
$$K(z) = C(Iz^{-1} - A)^{-1}B +D$$
of a rational matrix \(K(z)\) with statespace dimension \(s\).
The matrix \(PQ\) is diagonalizable and the eigenvalues are real and non negative.
Let \(\sigma_1^2 \geq \cdots \geq \sigma_s^2 \geq 0\)
denote the eigenvalues of \(PQ\) and suppose that \(PQ\) has rank \(k\leq s\),
i.e. \(\sigma_i=0\) for \(i&gt;k\).
Then there exists a statespace transformation \(T\) which renders both Grammians into diagonal form
and furthermore we have \(p_{ii}=q_{ii}=\sigma_i\) for
the first \(k\) diagonal entries of the (transformed) Grammians.</p>
<p>The (non zero) \(\sigma_i\)'s are equal to the (non zero) singular values of the
Hankel matrix of the impulse response coefficients of \(K\) and hence are called
<em>Hankel singular values</em>. These singular values are also the singular values of the
product \(P^{1/2}Q^{1/2}\) where \(P^{1/2}\) and \(Q^{1/2}\) denote "square roots"
of the Grammians \(P\) and \(Q\) respectively.</p>
<p>The procedure <code>balance(obj,...)</code> computes a somewhat simplified "balanced" form where
the transformed Grammians \(P,Q\) are block diagonal with two diagonal blocks of dimension
\(s_0\) and \(s_1 = s - s_0\) respectively. The two
upper, left blocks of \(P\) and \(Q\) are diagonal and the diagonal entries are
\(p_{ii}=q_{ii}=\sigma_i\) for  \(i=1,\ldots,s_0\).
If \(s_0=k\) is equal to the rank of \(PQ\)
then the product of the two lower, right blocks of \(P\) and \(Q\) is zero
(up to numerical errors).</p>
<p>Note that \(k=\mathrm{rk}(PQ)\) is equal to the minimal statespace dimension, i.e.
there exists a statespace realization with statespace dimension \(k\) and
any statespace realization of \(K\) has a statespace dimension \(geq k\).
Such a <em>minimal</em> statespace realization now be constructed by "truncating" the balanced
realization:
$$K(z) = C_{1}(Iz^{-1} - A_{11})^{-1} B_{1} + D$$
where \(A_{11}\) is the left, upper, \((k,k)\) dimensional block of \(A\),
\(B_1\) is the upper, \((k,n)\) dimensional block of \(B\) and
\(C_1\) is the left, \((m,k)\) dimensional block of \(C\).</p>
<p>This balanced truncated statespace realization is returned if the
optional parameter <code>truncate</code> is <code>TRUE</code>. Note that in the case where
<code>s0</code> is less than the rank of \(PQ\) the truncated realization
is just an approximate realization of \(K(z)\). The approximation error
depends on the size of "neglected" Hankel singular values. Note also that the
truncated realization is not balanced (if \(s_0&lt;k\)).</p>
<p>If the "target" statespace dimension \(s_0\) is not given then the
procedure sets \(s_0\) equal to an estimate of the rank of
\(PQ\). This estimate is computed by inspecting the singular values
\(\sigma_i\) of the product of the square roots
\(P^{1/2}\) and \(Q^{1/2}\).</p>
<p>The above discussion deals with the controllability and the observability
Grammian of the statespace realization. However, one may also use
other pairs of Grammians, e.g. for invertible matrices \(K\)
one may use the controllabaility Grammian of the statespace realizatton
and the observability Grammian of the statespace realization of the
inverse <code>K^{-1}(z)</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># example A ############################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># "obj" is a (1 by 1) rational matrix in statespace form, </span></span></span>
<span class="r-in"><span><span class="co"># with stespace dimension s = 2. </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">obj</span> <span class="op">=</span> <span class="fu"><a href="stsp.html">stsp</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.2</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">0.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gr</span> <span class="op">=</span> <span class="fu"><a href="grammians.html">grammians</a></span><span class="op">(</span><span class="va">obj</span>, <span class="st">'lyapunov'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bal</span> <span class="op">=</span> <span class="fu">balance</span><span class="op">(</span><span class="va">obj</span>, <span class="va">gr</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">bal</span><span class="op">$</span><span class="va">P</span>, <span class="va">bal</span><span class="op">$</span><span class="va">Q</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">bal</span><span class="op">$</span><span class="va">sigma</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]     [,2]     [,3]     [,4]     [,5]     [,6]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.586904 0.000000 1.586904 0.000000 1.586904 0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.000000 1.458699 0.000000 1.458699 0.000000 1.458699</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="grammians.html">grammians</a></span><span class="op">(</span><span class="va">bal</span><span class="op">$</span><span class="va">obj</span><span class="op">)</span>, <span class="va">bal</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'P'</span>,<span class="st">'Q'</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example B (non minimal statespace realization #########################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The "rbind" operation below returns a statespace realization with </span></span></span>
<span class="r-in"><span><span class="co"># statespace dimension s = 4. However the minimal statespace dimensions </span></span></span>
<span class="r-in"><span><span class="co"># is s0 = 2. </span></span></span>
<span class="r-in"><span><span class="va">obj</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">obj</span>, <span class="va">obj</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gr</span> <span class="op">=</span> <span class="fu"><a href="grammians.html">grammians</a></span><span class="op">(</span><span class="va">obj</span>, <span class="st">'lyapunov'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bal</span> <span class="op">=</span> <span class="fu">balance</span><span class="op">(</span><span class="va">obj</span>, <span class="va">gr</span>, s0 <span class="op">=</span> <span class="fl">2</span>, truncate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># the upper (2 by 2) block of the (transformed) controllability </span></span></span>
<span class="r-in"><span><span class="co"># Grammian is diagonal, the lower (2 by 2) block is "zero". </span></span></span>
<span class="r-in"><span><span class="co"># This shows that the (balanced) realization is not controllable. </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bal</span><span class="op">$</span><span class="va">P</span><span class="op">)</span>  </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]     [,2]         [,3]         [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 2.244221 0.000000 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.000000 2.062912 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.000000 0.000000 2.535741e-33 6.600794e-33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.000000 0.000000 6.600794e-33 2.939217e-32</span>
<span class="r-in"><span>              </span></span>
<span class="r-in"><span><span class="co"># the upper (2 by 2) block of the (transformed) observability </span></span></span>
<span class="r-in"><span><span class="co"># Grammian is diagonal and equal to the upper block of bal$P.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bal</span><span class="op">$</span><span class="va">Q</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]     [,2]       [,3]       [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 2.244221 0.000000  0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.000000 2.062912  0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.000000 0.000000  1.4464176 -0.3808884</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.000000 0.000000 -0.3808884  1.3313601</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># the product of the (transformed) controllability and observability </span></span></span>
<span class="r-in"><span><span class="co"># Grammians is (approximately) diagonal and the diagonal entries are  </span></span></span>
<span class="r-in"><span><span class="co"># the squares of the Hankel singular values.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bal</span><span class="op">$</span><span class="va">P</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">bal</span><span class="op">$</span><span class="va">Q</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]     [,2]          [,3]         [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 5.036528 0.000000  0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.000000 4.255604  0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.000000 0.000000  1.153575e-33 7.822199e-33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.000000 0.000000 -1.647632e-33 3.661739e-32</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bal</span><span class="op">$</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>    </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5.036528e+00 4.255604e+00 2.792358e-17 5.975078e-33</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="grammians.html">grammians</a></span><span class="op">(</span><span class="va">bal</span><span class="op">$</span><span class="va">obj</span><span class="op">)</span>, <span class="va">bal</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'P'</span>,<span class="st">'Q'</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># we may construct a minimal realization by 'balanced truncation'.</span></span></span>
<span class="r-in"><span><span class="co"># note that we let the procedure determine the minimal statespace dimension </span></span></span>
<span class="r-in"><span><span class="va">trunc</span> <span class="op">=</span> <span class="fu">balance</span><span class="op">(</span><span class="va">obj</span>, <span class="va">gr</span><span class="op">)</span>  </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">trunc</span><span class="op">$</span><span class="va">obj</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> statespace realization [2,1] with s = 2 states</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            s[1]       s[2]       u[1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[1]  0.3498560  0.3119731 -1.3299446</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[2] -0.3119731 -0.8498560 -0.5954318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[1] -0.9404128  0.4210339  1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[2] -0.9404128  0.4210339  1.0000000</span>
<span class="r-in"><span><span class="co"># compare with the above balanced realization </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bal</span><span class="op">$</span><span class="va">obj</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> statespace realization [2,1] with s = 4 states</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               s[1]          s[2]          s[3]          s[4]          u[1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[1]  3.498560e-01  3.119731e-01  2.966202e-17 -2.542543e-17 -1.329945e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[2] -3.119731e-01 -8.498560e-01 -6.729309e-17  1.299258e-17 -5.954318e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[3] -9.041099e-19 -3.500935e-17 -6.872820e-01  8.809205e-01 -5.551115e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[4]  8.747771e-17 -2.948488e-17  8.092046e-02  1.872820e-01 -1.665335e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[1] -9.404128e-01  4.210339e-01 -5.967029e-01 -3.794017e-01  1.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[2] -9.404128e-01  4.210339e-01  5.967029e-01  3.794017e-01  1.000000e+00</span>
<span class="r-in"><span><span class="co"># check </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="pseries.html">pseries</a></span><span class="op">(</span><span class="va">obj</span><span class="op">)</span>, <span class="fu"><a href="pseries.html">pseries</a></span><span class="op">(</span><span class="va">trunc</span><span class="op">$</span><span class="va">obj</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example C (balanced truncation) ##########################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># construct a random rational matrix with statespace dimension s=10</span></span></span>
<span class="r-in"><span><span class="va">obj</span> <span class="op">=</span> <span class="fu"><a href="test_stsp.html">test_stsp</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, s <span class="op">=</span> <span class="fl">10</span>, bpoles <span class="op">=</span> <span class="fl">1</span>, bzeroes <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># compute an approximate realization with s0 = 8</span></span></span>
<span class="r-in"><span><span class="va">gr</span> <span class="op">=</span> <span class="fu"><a href="grammians.html">grammians</a></span><span class="op">(</span><span class="va">obj</span>, <span class="st">'minimum phase'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trunc</span> <span class="op">=</span> <span class="fu">balance</span><span class="op">(</span><span class="va">obj</span>, <span class="va">gr</span>, s0 <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">trunc</span><span class="op">$</span><span class="va">sigma</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1.050338828 0.912130569 0.801352887 0.307619618 0.201641532 0.093077495</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] 0.026798379 0.015051710 0.004094821 0.002717688</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span><span class="fu"><a href="pseries.html">pseries</a></span><span class="op">(</span><span class="va">obj</span>, lag.max <span class="op">=</span> <span class="fl">25</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> </span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span><span class="fu"><a href="pseries.html">pseries</a></span><span class="op">(</span><span class="va">trunc</span><span class="op">$</span><span class="va">ob</span>, lag.max <span class="op">=</span> <span class="fl">25</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0305373</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="pseries.html">pseries</a></span><span class="op">(</span><span class="va">obj</span>, lag.max <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>, x_list<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="pseries.html">pseries</a></span><span class="op">(</span><span class="va">trunc</span><span class="op">$</span><span class="va">obj</span>, lag.max <span class="op">=</span> <span class="fl">25</span><span class="op">)</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>     type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'l'</span>,<span class="st">'p'</span><span class="op">)</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'s=10'</span>, <span class="st">'s=5'</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="balance-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://scholar.google.com/citations?user=-Ytb9BYAAAAJ" class="external-link">Wolfgang Scherrer</a>, <a href="https://ch.linkedin.com/in/bernd-funovits-phd-cfa-a8215016" class="external-link">Bernd Funovits</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

