<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Compute a balanced realization or a balanced truncated statespace realization
of a rational matrix in statespace form."><title>Balanced Realization and Balanced Truncation — balance • rationalmatrices</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Balanced Realization and Balanced Truncation — balance"><meta property="og:description" content="Compute a balanced realization or a balanced truncated statespace realization
of a rational matrix in statespace form."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rationalmatrices</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a_rational_matrices.html">Rational Matrices</a>
    <a class="dropdown-item" href="../articles/b_technical_details_ratm.html">Rational Matrices: Technical Details</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Balanced Realization and Balanced Truncation</h1>
      
      <div class="d-none name"><code>balance.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute a balanced realization or a balanced truncated statespace realization
of a rational matrix in statespace form.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">balance</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  <span class="va">gr</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">10</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">)</span>,</span>
<span>  s0 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  truncate <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>obj</dt>
<dd><p>(<code><a href="stsp.html">stsp</a></code> object) rational matrix in statespace form.</p></dd>


<dt>gr</dt>
<dd><p>a list with two components <code>P</code> and <code>Q</code> which contain two Grammians. 
These Grammians may e.g. be computed with <code><a href="grammians.html">grammians</a></code>.</p></dd>


<dt>tol</dt>
<dd><p>a tolerance parameter used for the determination of the rank \(PQ\). 
If <code>s0 = NULL</code> then the procedure estimates the rank of \(PQ\) 
and sets <code>s0</code> equal to this estimate. If <code>s0</code> is given, 
then <code>tol</code> is ignored.</p></dd>


<dt>s0</dt>
<dd><p>determines the  size of the two diagonal blocks of transformed 
Grammians \(P\), \(Q\), respectively (for <code>truncate = TRUE</code> 
the statespace dimension of the balanced truncated statespace realization.</p></dd>


<dt>truncate</dt>
<dd><p>(boolean) If true then the balanced truncated model is returned.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list with components</p>
<dl><dt>obj</dt>
<dd><p>(<code><a href="stsp.html">stsp</a></code> object) represents the balanced (truncated) statespace 
           realization.</p></dd>

<dt>T,Tinv</dt>
<dd><p>the state transformation and the inverse state transformation matrix. 
              Note that for the case <code>truncate=TRUE</code> the matrix <code>T</code> is 
              an <code>s0 x s</code> matrix and <code>Tinv</code> is of dimension <code>s x s0</code>.</p></dd>

<dt>P,Q</dt>
<dd><p>the transformed (and truncated) Grammians.</p></dd>

<dt>sigma</dt>
<dd><p>the vector of singular values of the matrix \((P^{1/2}Q^{1/2})\).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Let \(P,Q\) denote the controllability and the observability Grammian of a statespace 
realization 
$$K(z) = C(Iz^{-1} - A)^{-1}B +D$$ 
of a rational matrix \(K(z)\) with statespace dimension \(s\). 
The matrix \(PQ\) is diagonalizable and the eigenvalues are real and non negative. 
Let \(\sigma_1^2 \geq \cdots \geq \sigma_s^2 \geq 0\)
denote the eigenvalues of \(PQ\) and suppose that \(PQ\) has rank \(k\leq s\), 
i.e. \(\sigma_i=0\) for \(i&gt;k\). 
Then there exists a statespace transformation \(T\) which renders both Grammians into diagonal form 
and furthermore we have \(p_{ii}=q_{ii}=\sigma_i\) for 
the first \(k\) diagonal entries of the (transformed) Grammians.</p>
<p>The (non zero) \(\sigma_i\)'s are equal to the (non zero) singular values of the 
Hankel matrix of the impulse response coefficients of \(K\) and hence are called 
<em>Hankel singular values</em>. These singular values are also the singular values of the 
product \(P^{1/2}Q^{1/2}\) where \(P^{1/2}\) and \(Q^{1/2}\) denote "square roots" 
of the Grammians \(P\) and \(Q\) respectively.</p> 
<p>The procedure <code>balance(obj,...)</code> computes a somewhat simplified "balanced" form where 
the transformed Grammians \(P,Q\) are block diagonal with two diagonal blocks of dimension 
\(s_0\) and \(s_1 = s - s_0\) respectively. The two 
upper, left blocks of \(P\) and \(Q\) are diagonal and the diagonal entries are  
\(p_{ii}=q_{ii}=\sigma_i\) for  \(i=1,\ldots,s_0\).
If \(s_0=k\) is equal to the rank of \(PQ\) 
then the product of the two lower, right blocks of \(P\) and \(Q\) is zero 
(up to numerical errors).</p>
<p>Note that \(k=\mathrm{rk}(PQ)\) is equal to the minimal statespace dimension, i.e. 
there exists a statespace realization with statespace dimension \(k\) and 
any statespace realization of \(K\) has a statespace dimension \(geq k\). 
Such a <em>minimal</em> statespace realization now be constructed by "truncating" the balanced 
realization:  
$$K(z) = C_{1}(Iz^{-1} - A_{11})^{-1} B_{1} + D$$
where \(A_{11}\) is the left, upper, \((k,k)\) dimensional block of \(A\), 
\(B_1\) is the upper, \((k,n)\) dimensional block of \(B\) and 
\(C_1\) is the left, \((m,k)\) dimensional block of \(C\).</p>
<p>This balanced truncated statespace realization is returned if the 
optional parameter <code>truncate</code> is <code>TRUE</code>. Note that in the case where 
<code>s0</code> is less than the rank of \(PQ\) the truncated realization 
is just an approximate realization of \(K(z)\). The approximation error 
depends on the size of "neglected" Hankel singular values. Note also that the 
truncated realization is not balanced (if \(s_0&lt;k\)).</p>
<p>If the "target" statespace dimension \(s_0\) is not given then the 
procedure sets \(s_0\) equal to an estimate of the rank of 
\(PQ\). This estimate is computed by inspecting the singular values 
\(\sigma_i\) of the product of the square roots 
\(P^{1/2}\) and \(Q^{1/2}\).</p>
<p>The above discussion deals with the controllability and the observability 
Grammian of the statespace realization. However, one may also use 
other pairs of Grammians, e.g. for invertible matrices \(K\) 
one may use the controllabaility Grammian of the statespace realizatton 
and the observability Grammian of the statespace realization of the 
inverse <code>K^{-1}(z)</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># example A ############################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># "obj" is a (1 by 1) rational matrix in statespace form, </span></span></span>
<span class="r-in"><span><span class="co"># with stespace dimension s = 2. </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">obj</span> <span class="op">=</span> <span class="fu"><a href="stsp.html">stsp</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.2</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">0.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gr</span> <span class="op">=</span> <span class="fu"><a href="grammians.html">grammians</a></span><span class="op">(</span><span class="va">obj</span>, <span class="st">'lyapunov'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bal</span> <span class="op">=</span> <span class="fu">balance</span><span class="op">(</span><span class="va">obj</span>, <span class="va">gr</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">bal</span><span class="op">$</span><span class="va">P</span>, <span class="va">bal</span><span class="op">$</span><span class="va">Q</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">bal</span><span class="op">$</span><span class="va">sigma</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]     [,2]     [,3]     [,4]     [,5]     [,6]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.586904 0.000000 1.586904 0.000000 1.586904 0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.000000 1.458699 0.000000 1.458699 0.000000 1.458699</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="grammians.html">grammians</a></span><span class="op">(</span><span class="va">bal</span><span class="op">$</span><span class="va">obj</span><span class="op">)</span>, <span class="va">bal</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'P'</span>,<span class="st">'Q'</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example B (non minimal statespace realization #########################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The "rbind" operation below returns a statespace realization with </span></span></span>
<span class="r-in"><span><span class="co"># statespace dimension s = 4. However the minimal statespace dimensions </span></span></span>
<span class="r-in"><span><span class="co"># is s0 = 2. </span></span></span>
<span class="r-in"><span><span class="va">obj</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">obj</span>, <span class="va">obj</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gr</span> <span class="op">=</span> <span class="fu"><a href="grammians.html">grammians</a></span><span class="op">(</span><span class="va">obj</span>, <span class="st">'lyapunov'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bal</span> <span class="op">=</span> <span class="fu">balance</span><span class="op">(</span><span class="va">obj</span>, <span class="va">gr</span>, s0 <span class="op">=</span> <span class="fl">2</span>, truncate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># the upper (2 by 2) block of the (transformed) controllability </span></span></span>
<span class="r-in"><span><span class="co"># Grammian is diagonal, the lower (2 by 2) block is "zero". </span></span></span>
<span class="r-in"><span><span class="co"># This shows that the (balanced) realization is not controllable. </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bal</span><span class="op">$</span><span class="va">P</span><span class="op">)</span>  </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]     [,2]          [,3]          [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 2.244221 0.000000  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.000000 2.062912  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.000000 0.000000  2.272963e-32 -2.403037e-32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.000000 0.000000 -1.786739e-32  1.198986e-31</span>
<span class="r-in"><span>              </span></span>
<span class="r-in"><span><span class="co"># the upper (2 by 2) block of the (transformed) observability </span></span></span>
<span class="r-in"><span><span class="co"># Grammian is diagonal and equal to the upper block of bal$P.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bal</span><span class="op">$</span><span class="va">Q</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]     [,2]       [,3]       [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 2.244221 0.000000 0.00000000 0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.000000 2.062912 0.00000000 0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.000000 0.000000 1.77315334 0.02695174</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.000000 0.000000 0.02695174 1.00462444</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># the product of the (transformed) controllability and observability </span></span></span>
<span class="r-in"><span><span class="co"># Grammians is (approximately) diagonal and the diagonal entries are  </span></span></span>
<span class="r-in"><span><span class="co"># the squares of the Hankel singular values.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bal</span><span class="op">$</span><span class="va">P</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">bal</span><span class="op">$</span><span class="va">Q</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]     [,2]          [,3]          [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 5.036528 0.000000  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.000000 4.255604  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.000000 0.000000  3.965545e-32 -2.352889e-32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.000000 0.000000 -2.845015e-32  1.199715e-31</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bal</span><span class="op">$</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>    </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5.036528e+00 4.255604e+00 2.792357e-17 6.353796e-32</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="grammians.html">grammians</a></span><span class="op">(</span><span class="va">bal</span><span class="op">$</span><span class="va">obj</span><span class="op">)</span>, <span class="va">bal</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'P'</span>,<span class="st">'Q'</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># we may construct a minimal realization by 'balanced truncation'.</span></span></span>
<span class="r-in"><span><span class="co"># note that we let the procedure determine the minimal statespace dimension </span></span></span>
<span class="r-in"><span><span class="va">trunc</span> <span class="op">=</span> <span class="fu">balance</span><span class="op">(</span><span class="va">obj</span>, <span class="va">gr</span><span class="op">)</span>  </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">trunc</span><span class="op">$</span><span class="va">obj</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> statespace realization [2,1] with s = 2 states</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            s[1]       s[2]       u[1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[1]  0.3498560  0.3119731 -1.3299446</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[2] -0.3119731 -0.8498560 -0.5954318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[1] -0.9404128  0.4210339  1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[2] -0.9404128  0.4210339  1.0000000</span>
<span class="r-in"><span><span class="co"># compare with the above balanced realization </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bal</span><span class="op">$</span><span class="va">obj</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> statespace realization [2,1] with s = 4 states</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               s[1]          s[2]          s[3]          s[4]          u[1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[1]  3.498560e-01  3.119731e-01 -1.747240e-16  1.694153e-17 -1.329945e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[2] -3.119731e-01 -8.498560e-01 -9.478857e-17 -1.914317e-16 -5.954318e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[3]  3.687444e-17  1.314776e-17 -8.147341e-01 -7.816872e-02  5.551115e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[4] -6.500433e-17 -1.117170e-16  7.218313e-01  3.147341e-01  2.220446e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[1] -9.404128e-01  4.210339e-01  2.284728e-01 -6.691787e-01  1.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[2] -9.404128e-01  4.210339e-01 -2.284728e-01  6.691787e-01  1.000000e+00</span>
<span class="r-in"><span><span class="co"># check </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="pseries.html">pseries</a></span><span class="op">(</span><span class="va">obj</span><span class="op">)</span>, <span class="fu"><a href="pseries.html">pseries</a></span><span class="op">(</span><span class="va">trunc</span><span class="op">$</span><span class="va">obj</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example C (balanced truncation) ##########################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># construct a random rational matrix with statespace dimension s=10</span></span></span>
<span class="r-in"><span><span class="va">obj</span> <span class="op">=</span> <span class="fu"><a href="test_stsp.html">test_stsp</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, s <span class="op">=</span> <span class="fl">10</span>, bpoles <span class="op">=</span> <span class="fl">1</span>, bzeroes <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># compute an approximate realization with s0 = 8</span></span></span>
<span class="r-in"><span><span class="va">gr</span> <span class="op">=</span> <span class="fu"><a href="grammians.html">grammians</a></span><span class="op">(</span><span class="va">obj</span>, <span class="st">'minimum phase'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trunc</span> <span class="op">=</span> <span class="fu">balance</span><span class="op">(</span><span class="va">obj</span>, <span class="va">gr</span>, s0 <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">trunc</span><span class="op">$</span><span class="va">sigma</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 2.209162586 1.318023393 0.699404621 0.417914114 0.304352222 0.104232208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] 0.040550915 0.029675682 0.004633122 0.001629029</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span><span class="fu"><a href="pseries.html">pseries</a></span><span class="op">(</span><span class="va">obj</span>, lag.max <span class="op">=</span> <span class="fl">25</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> </span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span><span class="fu"><a href="pseries.html">pseries</a></span><span class="op">(</span><span class="va">trunc</span><span class="op">$</span><span class="va">ob</span>, lag.max <span class="op">=</span> <span class="fl">25</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.06920354</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="pseries.html">pseries</a></span><span class="op">(</span><span class="va">obj</span>, lag.max <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>, x_list<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="pseries.html">pseries</a></span><span class="op">(</span><span class="va">trunc</span><span class="op">$</span><span class="va">obj</span>, lag.max <span class="op">=</span> <span class="fl">25</span><span class="op">)</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>     type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'l'</span>,<span class="st">'p'</span><span class="op">)</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'s=10'</span>, <span class="st">'s=5'</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="balance-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Wolfgang Scherrer, Bernd Funovits.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

