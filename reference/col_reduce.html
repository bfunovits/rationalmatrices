<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Let \(a(z)\) be a square (non singular) polynomial matrix. 
This helper function constructs a unimodular transformation matrix \(v(z)\) such that \(a(z) v^{-1}(z)\) is column reduced (i.e. the column end matrix has full rank).
Algorithmic implementation are described e.g. in (Wolovich 1974)
 Theorem 2.5.7, page 27, (Krishnarao and Chen 1984)
, and (Geurts and Praagman 1996)
 who show that the KC implementations fails when the degree of the unimodular matrix \(v^{-1}(z)\) exceeds the degree of \(a(z)\) (page 4 in GP).
While all these implementations use elementary column operations to obtain zero columns in the column-end-matrix (in order to reduce the degree of the matrix polynomial), this implementation uses the svd.
The examples below are taken from (Geurts and Praagman 1996)
 and (Krishnarao and Chen 1984)
."><title>Construct a Column Reduced Polynomial Matrix — col_reduce • rationalmatrices</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Construct a Column Reduced Polynomial Matrix — col_reduce"><meta property="og:description" content="Let \(a(z)\) be a square (non singular) polynomial matrix. 
This helper function constructs a unimodular transformation matrix \(v(z)\) such that \(a(z) v^{-1}(z)\) is column reduced (i.e. the column end matrix has full rank).
Algorithmic implementation are described e.g. in (Wolovich 1974)
 Theorem 2.5.7, page 27, (Krishnarao and Chen 1984)
, and (Geurts and Praagman 1996)
 who show that the KC implementations fails when the degree of the unimodular matrix \(v^{-1}(z)\) exceeds the degree of \(a(z)\) (page 4 in GP).
While all these implementations use elementary column operations to obtain zero columns in the column-end-matrix (in order to reduce the degree of the matrix polynomial), this implementation uses the svd.
The examples below are taken from (Geurts and Praagman 1996)
 and (Krishnarao and Chen 1984)
."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rationalmatrices</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a_rational_matrices.html">Rational Matrices</a>
    <a class="dropdown-item" href="../articles/b_technical_details_ratm.html">Rational Matrices: Technical Details</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bfunovits/rationalmatrices/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Construct a Column Reduced Polynomial Matrix</h1>
      
      <div class="d-none name"><code>col_reduce.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Let \(a(z)\) be a square (non singular) polynomial matrix. 
This helper function constructs a unimodular transformation matrix \(v(z)\) such that \(a(z) v^{-1}(z)\) is column reduced (i.e. the column end matrix has full rank).
Algorithmic implementation are described e.g. in (Wolovich 1974)
 Theorem 2.5.7, page 27, (Krishnarao and Chen 1984)
, and (Geurts and Praagman 1996)
 who show that the KC implementations fails when the degree of the unimodular matrix \(v^{-1}(z)\) exceeds the degree of \(a(z)\) (page 4 in GP).
While all these implementations use elementary column operations to obtain zero columns in the column-end-matrix (in order to reduce the degree of the matrix polynomial), this implementation uses the <a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a>.
The examples below are taken from (Geurts and Praagman 1996)
 and (Krishnarao and Chen 1984)
.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">col_reduce</span><span class="op">(</span><span class="va">a</span>, tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">)</span>, debug <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>a</dt>
<dd><p><code><a href="polm.html">polm</a></code> object, which represents the square, polynomial matrix 
\(a(z)\).</p></dd>


<dt>tol</dt>
<dd><p>Double. Tolerance parameter. Default set to sqrt(.Machine$double.eps).</p></dd>


<dt>debug</dt>
<dd><p>Logical, default to FALSE. If TRUE, then some diagnostic messages are printed.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>List with components</p>
<dl><dt>a</dt>
<dd><p>(<code><a href="polm.html">polm</a></code> object) is the transformed (column reduced) matrix.</p></dd>

<dt>v,v_inv</dt>
<dd><p>(<code><a href="polm.html">polm</a></code> objects) are the the unimodular matrices \(v(z)\) and \(v^{-1}(z)\) such that \(a(z) v^{-1}(z)\) is column reduced</p></dd>
</dl><p>.</p>
<dl><dt>col_degrees</dt>
<dd><p>vector of column degrees of the transformed matrix. 
    Note that the columns are permuted such that the transformed matrix has *non-increasing* column degrees.</p></dd>

<dt>col_end_matrix</dt>
<dd><p>the column end matrix of the transformed matrix.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="possible-improvements-">Possible "Improvements"<a class="anchor" aria-label="anchor" href="#possible-improvements-"></a></h2>
    

<p>It is not clear whether the changes are improvements...
First: When a rank deficiency in the column-end-matrix is detected with the SVD, only one column is "reduced" to zero (even when the rank deficiency is larger than one). 
Fewer SVDs are calculated when both 
It might be better to reduce all columns to zero which pertain to (numerically) zero eigenvalues.
<br>
Second: The pivoting mechanism in the QR decomposition might be useful to single out the columns which should be set to zero.
It might be preferable to the SVD.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Wolovich WA (1974).
<em>Linear multivariable systems</em>,  Applied mathematical sciences.
Springer-Verlag.
ISBN 9783540901013.

Krishnarao I, Chen CT (1984).
“Two polynomial matrix operations.”
<em>IEEE Transactions on Automatic Control</em>, <b>29</b>(4), 346-348.

Geurts AJ, Praagman C (1996).
“Column Reduction of Polynomial Matrices; Some Remarks on the Algorithm of Wolovich.”
<em>European Journal of Control</em>, <b>2</b>(2), 152-157.
<a href="https://doi.org/10.1016/S0947-3580%2896%2970039-0" class="external-link">doi:10.1016/S0947-3580(96)70039-0</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>The column end matrix may be computed with <code><a href="col_end_matrix.html">col_end_matrix</a></code>. 
The function <code>col_reduce</code> is mainly used to compute the Wiener-Hopf factorization of a polynomial matrix, see <code><a href="whf.html">whf</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># #############################################################################</span></span></span>
<span class="r-in"><span><span class="co"># define a simple utility function for the computation of the rank of a matrix </span></span></span>
<span class="r-in"><span><span class="co"># compare e.g. Matrix::rankMatrix</span></span></span>
<span class="r-in"><span><span class="va">rkM</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">tol</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">m</span>,<span class="va">n</span><span class="op">)</span> <span class="op">*</span> <span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">m</span>,<span class="va">n</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">0L</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">s</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">$</span><span class="va">d</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">s</span> <span class="op">&gt;=</span> <span class="va">tol</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="co"># #############################################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">z</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2.5.4 in W. A. Wolovich, Linear Multivariable Systems ###############</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">0</span>,<span class="op">-</span><span class="fl">3</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="va">z</span> <span class="op">+</span> </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="va">z</span><span class="op">^</span><span class="fl">2</span> </span></span>
<span class="r-in"><span><span class="co"># Original Matrix:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">a</span>, format <span class="op">=</span> <span class="st">'c'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]   [,2]    [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  -3 + z^2      1      2z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    2 + 4z      2       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]      -z^2  3 + z  2 - 3z </span>
<span class="r-in"><span><span class="co"># Its column end matrix (and its rank) and column degrees</span></span></span>
<span class="r-in"><span><span class="fu"><a href="col_end_matrix.html">col_end_matrix</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1    0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   -1    1   -3</span>
<span class="r-in"><span><span class="fu"><a href="col_end_matrix.html">col_end_matrix</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="va">.</span><span class="op">$</span><span class="va">d</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3.9516798 0.6198604 0.0000000</span>
<span class="r-in"><span><span class="fu"><a href="degree.html">degree</a></span><span class="op">(</span><span class="va">a</span>, <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 1 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># After column reduction:</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">=</span> <span class="fu">col_reduce</span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">a</span>, format <span class="op">=</span> <span class="st">'c'</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        [,1]    [,2]       [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]      1      2z  -3 - 0.5z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]      2       0     2 + 3z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  3 + z  2 - 3z      -2.5z </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">col_degrees</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 1 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">col_end_matrix</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0    2 -0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    0  3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    1   -3 -2.5</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">col_end_matrix</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="va">.</span><span class="op">$</span><span class="va">d</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4.6460685 2.7744157 0.4654726</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check correctness:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="prune.html">prune</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">v</span> <span class="op"><a href="ratm_mult.html">%r%</a></span> <span class="va">out</span><span class="op">$</span><span class="va">v_inv</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="prune.html">prune</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>, <span class="fu"><a href="prune.html">prune</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">a</span> <span class="op"><a href="ratm_mult.html">%r%</a></span> <span class="va">out</span><span class="op">$</span><span class="va">v</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co"># Random example: col degrees = (0,1,-1): throws an error #####################################</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>, degree <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span>, random <span class="op">=</span> <span class="cn">TRUE</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">a</span>, format <span class="op">=</span> <span class="st">'c'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        [,1]          [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  -0.72  0.33 + 1.03z     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   0.75  0.06 + 0.43z     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   -1.1  -1.32 + 0.1z     0 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># this throws an error, since a(z) is singular</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">=</span> <span class="fu">col_reduce</span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Random example: Generic matrices are row reduced ############################################</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>, degree <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, random <span class="op">=</span> <span class="cn">TRUE</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">a</span>, format <span class="op">=</span> <span class="st">'c'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          [,1]          [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   -1.09 - 0.08z + 0.4z^2  0.32 + 1.18z  0.55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  -0.25 + 1.15z + 0.09z^2  1.92 + 1.01z  -0.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   1.11 + 0.08z - 0.17z^2  -0.07 - 1.4z  0.34 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Column reduction:</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">=</span> <span class="fu">col_reduce</span><span class="op">(</span><span class="va">a</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">a</span>, format <span class="op">=</span> <span class="st">'c'</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          [,1]          [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   -1.09 - 0.08z + 0.4z^2  0.32 + 1.18z  0.55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  -0.25 + 1.15z + 0.09z^2  1.92 + 1.01z  -0.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   1.11 + 0.08z - 0.17z^2  -0.07 - 1.4z  0.34 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">col_degrees</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 1 0</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">col_end_matrix</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]  [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.40  1.18  0.55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.09  1.01 -0.20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.17 -1.40  0.34</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">col_end_matrix</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="va">.</span><span class="op">$</span><span class="va">d</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.12622923 0.71094942 0.03605815</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="prune.html">prune</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">v</span> <span class="op"><a href="ratm_mult.html">%r%</a></span> <span class="va">out</span><span class="op">$</span><span class="va">v_inv</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="prune.html">prune</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>, <span class="fu"><a href="prune.html">prune</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">a</span> <span class="op"><a href="ratm_mult.html">%r%</a></span> <span class="va">out</span><span class="op">$</span><span class="va">v</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Random example: Column end matrix has rank 2 ################################</span></span></span>
<span class="r-in"><span><span class="va">col_end_matrix</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="fl">3</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> </span></span>
<span class="r-in"><span>                 <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="fl">3</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>, degree <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, random <span class="op">=</span> <span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>               digits <span class="op">=</span> <span class="fl">2</span>, col_end_matrix <span class="op">=</span> <span class="va">col_end_matrix</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">a</span>, format <span class="op">=</span> <span class="st">'c'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          [,1]          [,2]   [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  -0.35 + 0.62z + 1.96z^2  1.16 + 0.08z   1.59</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    1.5 - 0.53z + 0.54z^2  0.05 + 0.18z   0.89</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   0.01 + 1.47z - 1.01z^2  0.41 - 0.37z  -1.76 </span>
<span class="r-in"><span><span class="va">a</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="degree.html">degree</a></span><span class="op">(</span><span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 1 0</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">a</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="va">col_end_matrix</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]  [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.96  0.08  1.59</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.54  0.18  0.89</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -1.01 -0.37 -1.76</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">a</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="va">col_end_matrix</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="va">.</span><span class="op">$</span><span class="va">d</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3.3629744 0.6612132 0.0000000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Column reduction:</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">=</span> <span class="fu">col_reduce</span><span class="op">(</span><span class="va">a</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">a</span>, format <span class="op">=</span> <span class="st">'c'</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               [,1]          [,2]   [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.16 + 0.08z  -0.35 + 5.4z   1.59</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.05 + 0.18z   1.5 - 0.32z   0.89</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.41 - 0.37z  0.01 + 3.16z  -1.76 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">col_degrees</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 1 0</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">col_end_matrix</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]    [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.08  5.3992  1.59</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.18 -0.3240  0.89</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.37  3.1592 -1.76</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">col_end_matrix</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="va">.</span><span class="op">$</span><span class="va">d</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6.28302944 2.52052647 0.02947285</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="prune.html">prune</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">v</span> <span class="op"><a href="ratm_mult.html">%r%</a></span> <span class="va">out</span><span class="op">$</span><span class="va">v_inv</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="prune.html">prune</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>, <span class="fu"><a href="prune.html">prune</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">a</span> <span class="op"><a href="ratm_mult.html">%r%</a></span> <span class="va">out</span><span class="op">$</span><span class="va">v</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Random example: Column end matrix has rank 1 ################################ </span></span></span>
<span class="r-in"><span><span class="va">col_end_matrix</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> </span></span>
<span class="r-in"><span>                 <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>, degree <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, random <span class="op">=</span> <span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>               digits <span class="op">=</span> <span class="fl">2</span>, col_end_matrix <span class="op">=</span> <span class="va">col_end_matrix</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">a</span>, format <span class="op">=</span> <span class="st">'c'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          [,1]          [,2]           [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   0.63 - 0.14z - 0.24z^2  0.31 - 0.72z  -0.61 + 0.24z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   0.87 + 0.72z - 0.15z^2  1.67 - 0.45z   -0.3 + 0.15z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  -0.33 + 1.32z + 0.27z^2  0.56 + 0.81z  -0.77 - 0.27z </span>
<span class="r-in"><span><span class="va">a</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="degree.html">degree</a></span><span class="op">(</span><span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 1 1</span>
<span class="r-in"><span><span class="va">a</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="col_end_matrix.html">col_end_matrix</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="va">.</span><span class="op">$</span><span class="va">d</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.297305e+00 4.583682e-17 0.000000e+00</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Column reduction:</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">=</span> <span class="fu">col_reduce</span><span class="op">(</span><span class="va">a</span>, debug <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">a</span>, format <span class="op">=</span> <span class="st">'c'</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               [,1]           [,2]   [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.31 - 0.72z   0.63 - 0.75z  -0.51</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  1.67 - 0.45z   0.87 + 0.42z   0.26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.56 + 0.81z  -0.33 + 0.55z  -0.58 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">col_degrees</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 1 0</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">col_end_matrix</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]  [,2]       [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.72 -0.75 -0.5066667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.45  0.42  0.2566667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.81  0.55 -0.5833333</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">col_end_matrix</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="va">.</span><span class="op">$</span><span class="va">d</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.4236233 0.9098584 0.4761523</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="prune.html">prune</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">v</span> <span class="op"><a href="ratm_mult.html">%r%</a></span> <span class="va">out</span><span class="op">$</span><span class="va">v_inv</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="prune.html">prune</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>, <span class="fu"><a href="prune.html">prune</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">a</span> <span class="op"><a href="ratm_mult.html">%r%</a></span> <span class="va">out</span><span class="op">$</span><span class="va">v</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#################################################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># PG, Ex 1: Jordan Normal Form type (Unimodular matrix) ##########</span></span></span>
<span class="r-in"><span><span class="co"># Result: Works fine here (does not work with KC implementation)</span></span></span>
<span class="r-in"><span><span class="va">m0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,   </span></span>
<span class="r-in"><span>              <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,   </span></span>
<span class="r-in"><span>              <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Polymat:</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">m0</span>,<span class="va">m1</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]  [,3] z^1 [,1]  [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0     0        0     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1     0        0     0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]        0     0     1        0     0     0</span>
<span class="r-in"><span><span class="va">a</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]  [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     1     z     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]     0     1     z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]     0     0     1 </span>
<span class="r-in"><span><span class="va">a</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="degree.html">degree</a></span><span class="op">(</span><span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0 1 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Column reduced</span></span></span>
<span class="r-in"><span><span class="va">a_red</span> <span class="op">=</span> <span class="fu">col_reduce</span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a_red</span><span class="op">$</span><span class="va">a</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]        0     0     1</span>
<span class="r-in"><span><span class="fu"><a href="degree.html">degree</a></span><span class="op">(</span><span class="va">a_red</span><span class="op">$</span><span class="va">a</span>, <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0 0 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#################################################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># PG, Ex 2: Nothing special ##########</span></span></span>
<span class="r-in"><span><span class="co"># Result: Same as PG</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, degree <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">12</span>,<span class="fl">13</span>,<span class="fl">6</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="op">-</span><span class="fl">5</span>,<span class="op">-</span><span class="fl">4</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 2 x 2 ) matrix polynomial with degree &lt;= 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2] z^1 [,1]  [,2] z^2 [,1]  [,2] z^3 [,1]  [,2] z^4 [,1]  [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        4    -2       12    -5       13    -4        6    -1        1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     2        0     1        0     0        0     0        0     0</span>
<span class="r-in"><span><span class="va">a</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 2 x 2 ) matrix polynomial with degree &lt;= 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                               [,1]                  [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  4 + 12z + 13z^2 + 6z^3 + z^4  -2 - 5z - 4z^2 - z^3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]                             0                 2 + z </span>
<span class="r-in"><span><span class="fu"><a href="col_end_matrix.html">col_end_matrix</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    0</span>
<span class="r-in"><span><span class="fu"><a href="degree.html">degree</a></span><span class="op">(</span><span class="va">a</span>, <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4 3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Column reduction:</span></span></span>
<span class="r-in"><span><span class="va">a_red</span> <span class="op">=</span> <span class="fu">col_reduce</span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a_red</span><span class="op">$</span><span class="va">a</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 2 x 2 ) matrix polynomial with degree &lt;= 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2] z^1 [,1]  [,2] z^2 [,1]  [,2] z^3 [,1]  [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]       -2     0       -5     0       -4     0       -1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        2     4        1     4        0     1        0     0</span>
<span class="r-in"><span><span class="va">a_red</span><span class="op">$</span><span class="va">a</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 2 x 2 ) matrix polynomial with degree &lt;= 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       [,1]          [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  -2 - 5z - 4z^2 - z^3             0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]                 2 + z  4 + 4z + z^2 </span>
<span class="r-in"><span><span class="fu"><a href="degree.html">degree</a></span><span class="op">(</span><span class="va">a_red</span><span class="op">$</span><span class="va">a</span>, <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3 2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#################################################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># PG, Ex 3: Unimodular matrix ##########</span></span></span>
<span class="r-in"><span><span class="co"># Result: Works, but different matrices, v_inv (U(s) in PG notation is slightly "smaller" here)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>, degree <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]  [,3] z^1 [,1]  [,2]  [,3] z^2 [,1]  [,2]  [,3] z^3 [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        0     0     1        0     0     0        0     1     0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1     0        0     0     0        1     0     0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]        1     0     1        0     0     0        0     0     0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,2]  [,3] z^4 [,1]  [,2]  [,3] z^5 [,1]  [,2]  [,3] z^6 [,1]  [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     0     0        1     0     0        0     0     0        0     0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]     0     0        0     0     1        0     0     0        0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]     0     0        0     0     0        0     0     0        0     0     0</span>
<span class="r-in"><span><span class="va">a</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]  [,2]     [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   z^4   z^2  1 + z^6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   z^2     1      z^4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]     1     0        1 </span>
<span class="r-in"><span><span class="fu"><a href="col_end_matrix.html">col_end_matrix</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1    1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    0    0    0</span>
<span class="r-in"><span><span class="fu"><a href="degree.html">degree</a></span><span class="op">(</span><span class="va">a</span>, <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4 2 6</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Column reduction:</span></span></span>
<span class="r-in"><span><span class="va">a_red</span> <span class="op">=</span> <span class="fu">col_reduce</span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a_red</span><span class="op">$</span><span class="va">a</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        0     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]        1     1     0</span>
<span class="r-in"><span><span class="va">a_red</span><span class="op">$</span><span class="va">a</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]  [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     0     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]     0     0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]     1     1     0 </span>
<span class="r-in"><span><span class="fu"><a href="degree.html">degree</a></span><span class="op">(</span><span class="va">a_red</span><span class="op">$</span><span class="va">a</span>, <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0 0 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Verify the column-reduced matrix time v(z) is equal to original one:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">a_red</span>, <span class="va">a</span> <span class="op"><a href="ratm_mult.html">%r%</a></span> <span class="va">v</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]  [,2]     [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   z^4   z^2  1 + z^6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   z^2     1      z^4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]     1     0        1 </span>
<span class="r-in"><span><span class="va">a</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]  [,2]     [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   z^4   z^2  1 + z^6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   z^2     1      z^4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]     1     0        1 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Unimodular matrix transforming the column-reduced matrix to original one:</span></span></span>
<span class="r-in"><span><span class="va">a_red</span><span class="op">$</span><span class="va">v</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]  [,2]     [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1 - z^4  -z^2     -z^6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]      z^4   z^2  1 + z^6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]      z^2     1      z^4 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Verify that original matrix a(z) times v^{-1}(z) is column-reduced: PRUNING NECESSARY!</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">a</span> <span class="op"><a href="ratm_mult.html">%r%</a></span> <span class="va">a_red</span><span class="op">$</span><span class="va">v_inv</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]                         [,2]                         [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     0  1 - 8.88178419700125e-16z^6      8.88178419700125e-16z^8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]     0     -8.88178419700125e-16z^4  1 + 8.88178419700125e-16z^6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]     1                            1                            0 </span>
<span class="r-in"><span><span class="fu"><a href="prune.html">prune</a></span><span class="op">(</span><span class="va">a</span> <span class="op"><a href="ratm_mult.html">%r%</a></span> <span class="va">a_red</span><span class="op">$</span><span class="va">v_inv</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]  [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     0     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]     0     0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]     1     1     0 </span>
<span class="r-in"><span><span class="va">a_red</span><span class="op">$</span><span class="va">v_inv</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]  [,2]           [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     1     0            z^2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  -z^2  -z^4  1 - z^4 + z^6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]     0     1           -z^2 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#################################################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># PG, Ex 4: PG's "singular case" ##########</span></span></span>
<span class="r-in"><span><span class="co"># Result: Different results!</span></span></span>
<span class="r-in"><span><span class="co">#   If eps = 10^(-9) is chosen, </span></span></span>
<span class="r-in"><span><span class="co">#   then this algorithm breaks down because the a[0] is recognized as singular! </span></span></span>
<span class="r-in"><span><span class="co">#   If eps = 10^(-4) is chosen (as is done in PG), </span></span></span>
<span class="r-in"><span><span class="co">#   we obtain a result which is different from the one in PG</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Original matrix (could be argued to be numerically singular at a[0], depending on tolerance!)</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>, degree <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">eps</span> <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">eps</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]  [,3] z^1 [,1]  [,2]  [,3] z^2 [,1]  [,2]  [,3] z^3 [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        0     1     1        0 1e-04     0        1     0     0        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0    -1    -1        0 0e+00     0        2     0     0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]        0     1     1        0 0e+00     0        3     0     0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]     0     0</span>
<span class="r-in"><span><span class="va">a</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]        [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  z^2 + z^3  1 + 1e-04z     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]       2z^2          -1    -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]       3z^2           1     1 </span>
<span class="r-in"><span><span class="fu"><a href="col_end_matrix.html">col_end_matrix</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1]  [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1 1e-04    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0 0e+00   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    0 0e+00    1</span>
<span class="r-in"><span><span class="fu"><a href="col_end_matrix.html">col_end_matrix</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="va">.</span><span class="op">$</span><span class="va">d</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.847759e+00 7.653669e-01 1.355253e-20</span>
<span class="r-in"><span><span class="fu"><a href="degree.html">degree</a></span><span class="op">(</span><span class="va">a</span>, <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3 1 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Column reduction: Note that there is a column with "small length". </span></span></span>
<span class="r-in"><span><span class="co">#   It depends on the tolerance whether this column is considered to be zero.</span></span></span>
<span class="r-in"><span><span class="co">#   Also, note the singular values of the column-end-matrix of the reduced polymat!     </span></span></span>
<span class="r-in"><span><span class="va">a_red</span> <span class="op">=</span> <span class="fu">col_reduce</span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a_red</span><span class="op">$</span><span class="va">a</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]  [,3] z^1 [,1]  [,2]  [,3] z^2 [,1]  [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        0     1     1        0 1e-04     0    -9999     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0    -1    -1        0 0e+00     0    10002     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]        0     1     1        0 0e+00     0    -9997     0     0</span>
<span class="r-in"><span><span class="va">a_red</span><span class="op">$</span><span class="va">a</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       [,1]        [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  -9999.00000001665z^2  1 + 1e-04z     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   10002.0000000166z^2          -1    -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  -9997.00000001665z^2           1     1 </span>
<span class="r-in"><span><span class="va">a_red</span><span class="op">$</span><span class="va">a</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]  [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  -9999z^2     1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  10002z^2    -1    -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  -9997z^2     1     1 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">a_red</span><span class="op">$</span><span class="va">a</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="col_end_matrix.html">col_end_matrix</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]  [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -9999 1e-04    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 10002 0e+00   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -9997 0e+00    1</span>
<span class="r-in"><span><span class="va">a_red</span><span class="op">$</span><span class="va">a</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="col_end_matrix.html">col_end_matrix</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="va">.</span><span class="op">$</span><span class="va">d</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.731935e+04 3.560566e-04 8.108103e-05</span>
<span class="r-in"><span><span class="va">a_red</span><span class="op">$</span><span class="va">a</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="degree.html">degree</a></span><span class="op">(</span><span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 1 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Col-reduced matrix time v(z) = original: </span></span></span>
<span class="r-in"><span><span class="co"># It works up to a small numerical issue in the (1,1) element </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">a_red</span>, <span class="va">a</span> <span class="op"><a href="ratm_mult.html">%r%</a></span> <span class="va">v</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                            [,1]        [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  z^2 + 1.00000000000166z^3  1 + 1e-04z     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]                       2z^2          -1    -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]                       3z^2           1     1 </span>
<span class="r-in"><span><span class="va">a</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]        [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  z^2 + z^3  1 + 1e-04z     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]       2z^2          -1    -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]       3z^2           1     1 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check unimodular matrix taking the col-reduced matrix back to original:</span></span></span>
<span class="r-in"><span><span class="co"># Small (i.e. unproblematic) numerical issue in the (2,1)-element) which is also reflected above.</span></span></span>
<span class="r-in"><span><span class="va">a_red</span><span class="op">$</span><span class="va">v</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      [,1]  [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]                    1     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  10000.0000000166z^2     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]                    0     0     1 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Original times v^{-1}(z) = col-reduced:</span></span></span>
<span class="r-in"><span><span class="co"># Works fine, up to small (non-problematic) issue in (1,3)-element</span></span></span>
<span class="r-in"><span><span class="va">a_red</span><span class="op">$</span><span class="va">a</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       [,1]        [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  -9999.00000001665z^2  1 + 1e-04z     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   10002.0000000166z^2          -1    -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  -9997.00000001665z^2           1     1 </span>
<span class="r-in"><span><span class="op">(</span><span class="va">a</span> <span class="op"><a href="ratm_mult.html">%r%</a></span> <span class="va">a_red</span><span class="op">$</span><span class="va">v_inv</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                 [,1]        [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  -9999.00000001665z^2 - 1.66489044772788e-12z^3  1 + 1e-04z     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]                             10002.0000000166z^2          -1    -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]                            -9997.00000001665z^2           1     1 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Matrix transforming the original to column-reduced:</span></span></span>
<span class="r-in"><span><span class="co"># Small (unproblematic) issue in (2,3)-element</span></span></span>
<span class="r-in"><span><span class="va">a_red</span><span class="op">$</span><span class="va">v_inv</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       [,1]  [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]                     1     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  -10000.0000000166z^2     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]                     0     0     1 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Algebraic result given in PG: Different from the one obtained here! ####</span></span></span>
<span class="r-in"><span><span class="co"># The element (3,1) of matrix R(s) in PG seems to be incorrect. </span></span></span>
<span class="r-in"><span><span class="co"># Changing this element below results in a column-reduced matrix.</span></span></span>
<span class="r-in"><span><span class="va">eta</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">eps</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">r</span> <span class="op">=</span> <span class="fu"><a href="test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>, degree <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="op">-</span><span class="fl">3</span><span class="op">*</span><span class="va">eta</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">3</span><span class="op">*</span><span class="va">eta</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="va">eps</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">3</span><span class="op">*</span><span class="va">eta</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="op">-</span><span class="va">eps</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]  [,3] z^1 [,1]   [,2]  [,3] z^2 [,1]  [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        0     1     1   -30000  0e+00     0        0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0    -1    -1    30000  1e-04     0        0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]        1     1     1   -30000 -1e-04     0        5     0     0</span>
<span class="r-in"><span><span class="co"># PG: Col-reduced</span></span></span>
<span class="r-in"><span><span class="va">r</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    [,1]         [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]            -30000z            1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]             30000z  -1 + 1e-04z    -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  1 - 30000z + 5z^2   1 - 1e-04z     1 </span>
<span class="r-in"><span><span class="co"># Here: Col-reduced</span></span></span>
<span class="r-in"><span><span class="va">a_red</span><span class="op">$</span><span class="va">a</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       [,1]        [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  -9999.00000001665z^2  1 + 1e-04z     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   10002.0000000166z^2          -1    -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  -9997.00000001665z^2           1     1 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">u</span> <span class="op">=</span> <span class="fu"><a href="test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>, degree <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">u</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">u</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">u</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">u</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="op">-</span><span class="fl">3</span><span class="op">*</span><span class="va">eta</span>,<span class="op">-</span><span class="va">eta</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">u</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">u</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">u</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="va">eta</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">u</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="op">-</span><span class="va">eps</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">u</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">u</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]  [,3] z^1 [,1]   [,2]  [,3] z^2 [,1]  [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0     0        0  0e+00     0        0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1     0   -30000  0e+00     0   -10000     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]        0     0     1        0 -1e-04     0    10002     0     0</span>
<span class="r-in"><span><span class="va">u</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     [,1]     [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]                   1        0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  -30000z - 10000z^2        1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]            10002z^2  -1e-04z     1 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check whether their result makes sense:</span></span></span>
<span class="r-in"><span><span class="co"># Column-reduced matrix r is different from a %r% u!!! </span></span></span>
<span class="r-in"><span><span class="co"># This mistake can be corrected by adjusting element (3,1) of r</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]        [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  z^2 + z^3  1 + 1e-04z     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]       2z^2          -1    -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]       3z^2           1     1 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op"><a href="ratm_mult.html">%r%</a></span> <span class="va">u</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]  [,3] z^1 [,1]   [,2]  [,3] z^2 [,1]  [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        0     1     1   -30000  0e+00     0        0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0    -1    -1    30000  1e-04     0        0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]        0     1     1   -30000 -1e-04     0        5     0     0</span>
<span class="r-in"><span><span class="op">(</span><span class="va">a</span> <span class="op"><a href="ratm_mult.html">%r%</a></span> <span class="va">u</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 [,1]         [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]         -30000z            1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]          30000z  -1 + 1e-04z    -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  -30000z + 5z^2   1 - 1e-04z     1 </span>
<span class="r-in"><span><span class="op">(</span><span class="va">a</span> <span class="op"><a href="ratm_mult.html">%r%</a></span> <span class="va">u</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="col_end_matrix.html">col_end_matrix</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1]   [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0  0e+00    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0  1e-04   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    5 -1e-04    1</span>
<span class="r-in"><span><span class="op">(</span><span class="va">a</span> <span class="op"><a href="ratm_mult.html">%r%</a></span> <span class="va">u</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="col_end_matrix.html">col_end_matrix</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="va">.</span><span class="op">$</span><span class="va">d</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5.107156e+00 1.384541e+00 7.071068e-05</span>
<span class="r-in"><span><span class="op">(</span><span class="va">a</span> <span class="op"><a href="ratm_mult.html">%r%</a></span> <span class="va">u</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="degree.html">degree</a></span><span class="op">(</span><span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 1 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">r</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]  [,3] z^1 [,1]   [,2]  [,3] z^2 [,1]  [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        0     1     1   -30000  0e+00     0        0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0    -1    -1    30000  1e-04     0        0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]        1     1     1   -30000 -1e-04     0        5     0     0</span>
<span class="r-in"><span><span class="va">r</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    [,1]         [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]            -30000z            1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]             30000z  -1 + 1e-04z    -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  1 - 30000z + 5z^2   1 - 1e-04z     1 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#########################</span></span></span>
<span class="r-in"><span><span class="co"># Change an element in r</span></span></span>
<span class="r-in"><span><span class="va">r2</span> <span class="op">=</span> <span class="va">r</span></span></span>
<span class="r-in"><span><span class="va">r2</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="op">-</span><span class="fl">3</span><span class="op">*</span><span class="va">eta</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r2</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 [,1]         [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]         -30000z            1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]          30000z  -1 + 1e-04z    -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  -30000z + 5z^2   1 - 1e-04z     1 </span>
<span class="r-in"><span><span class="va">r2</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="col_end_matrix.html">col_end_matrix</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1]   [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0  0e+00    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0  1e-04   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    5 -1e-04    1</span>
<span class="r-in"><span><span class="va">r2</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="col_end_matrix.html">col_end_matrix</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="va">.</span><span class="op">$</span><span class="va">d</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5.107156e+00 1.384541e+00 7.071068e-05</span>
<span class="r-in"><span><span class="va">r2</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="col_end_matrix.html">col_end_matrix</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu">rkM</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-in"><span><span class="va">r2</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="degree.html">degree</a></span><span class="op">(</span><span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 1 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">a</span> <span class="op"><a href="ratm_mult.html">%r%</a></span> <span class="va">u</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 [,1]         [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]         -30000z            1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]          30000z  -1 + 1e-04z    -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  -30000z + 5z^2   1 - 1e-04z     1 </span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#################################################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># PG, Ex 5: Breaks down in PG, but they give an algebraic solution ##########</span></span></span>
<span class="r-in"><span><span class="co"># Result: Works here! </span></span></span>
<span class="r-in"><span><span class="co">#  Different result as algebraic solution indicated in PG (up to column permutation).</span></span></span>
<span class="r-in"><span><span class="co">#  Of course, the obtained result is also column-reduced!</span></span></span>
<span class="r-in"><span><span class="co">#  The unimodular matrix (which column-reduces the original polynomial matrix) is different </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, degree <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">eps</span> <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">9</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">eps</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">]</span> <span class="op">=</span> <span class="va">a</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">0</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">]</span> <span class="op">=</span> <span class="va">a</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">]</span> <span class="op">=</span> <span class="va">a</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">3</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">a</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 4 x 4 ) matrix polynomial with degree &lt;= 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]  [,3]  [,4] z^1 [,1]  [,2]  [,3]  [,4] z^2 [,1]  [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0     0     1        1 1e-09     0     0        1     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     0     1     1        2 0e+00     0     0        0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]        1     3     3     3        3 0e+00     0     0        0     0     3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]        0     0     1     1        4 0e+00     0     0        0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,4] z^3 [,1]  [,2]  [,3]  [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     0        0     0     1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]     0        0     0     2     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]     3        0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]     0        0     0     4     4</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Original matrix, its column-end-matrix with its singular values, and its column degrees</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 4 x 4 ) matrix polynomial with degree &lt;= 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,1]    [,2]      [,3]      [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1 + z + z^2  1e-09z       z^3   1 + z^3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]           2z       0  1 + 2z^3  1 + 2z^3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]       1 + 3z       3  3 + 3z^2  3 + 3z^2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]           4z       0  1 + 4z^3  1 + 4z^3 </span>
<span class="r-in"><span><span class="fu"><a href="col_end_matrix.html">col_end_matrix</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1]  [,2] [,3] [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1 1e-09    1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0 0e+00    2    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    0 0e+00    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]    0 0e+00    4    4</span>
<span class="r-in"><span><span class="fu"><a href="col_end_matrix.html">col_end_matrix</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="va">.</span><span class="op">$</span><span class="va">d</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6.484499e+00 9.753345e-01 5.849050e-25 0.000000e+00</span>
<span class="r-in"><span><span class="fu"><a href="col_end_matrix.html">col_end_matrix</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu">rkM</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-in"><span><span class="fu"><a href="degree.html">degree</a></span><span class="op">(</span><span class="va">a</span>, <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 1 3 3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Column-reduction:</span></span></span>
<span class="r-in"><span><span class="va">a_red</span> <span class="op">=</span> <span class="fu">col_reduce</span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a_red</span><span class="op">$</span><span class="va">a</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 4 x 4 ) matrix polynomial with degree &lt;= 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]  [,3]  [,4] z^1 [,1]  [,2]  [,3]  [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0     1     0        1     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     0     0     1        2     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]        1     3     0     3        3     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]        0     0     0     1        4     0     0     0</span>
<span class="r-in"><span><span class="va">a_red</span><span class="op">$</span><span class="va">a</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 4 x 4 ) matrix polynomial with degree &lt;= 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         [,1]  [,2]  [,3]  [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   1 + z     0     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]      2z     0     0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  1 + 3z     3     0     3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]      4z     0     0     1 </span>
<span class="r-in"><span><span class="fu"><a href="col_end_matrix.html">col_end_matrix</a></span><span class="op">(</span><span class="va">a_red</span><span class="op">$</span><span class="va">a</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    2    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    3    3    0    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]    4    0    0    1</span>
<span class="r-in"><span><span class="fu"><a href="col_end_matrix.html">col_end_matrix</a></span><span class="op">(</span><span class="va">a_red</span><span class="op">$</span><span class="va">a</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="va">.</span><span class="op">$</span><span class="va">d</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6.5378222 2.6726142 0.9977857 0.3441475</span>
<span class="r-in"><span><span class="fu"><a href="degree.html">degree</a></span><span class="op">(</span><span class="va">a_red</span><span class="op">$</span><span class="va">a</span>, <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 0 0 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check whether col-reduced matrix times unimodular v(z) = original:</span></span></span>
<span class="r-in"><span><span class="co"># Works with small (non-problematic) numerical mistakes.</span></span></span>
<span class="r-in"><span><span class="co"># Brutal pruning "solves" it</span></span></span>
<span class="r-in"><span><span class="co"># Similar for the unimodular matrix v(z) itself</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">a_red</span>, <span class="va">a</span> <span class="op"><a href="ratm_mult.html">%r%</a></span> <span class="va">v</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 4 x 4 ) matrix polynomial with degree &lt;= 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,1]  [,2]                                                   [,3]                                                       [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1 + z + z^2     0  1.30185189290517e-16z - 5.35948625484577e-16z^2 + z^3  1 + 1.30185189290517e-16z - 5.35948625484577e-16z^2 + z^3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]           2z     0                     1 + 2.60370378581034e-16z^2 + 2z^3                         1 + 2.60370378581034e-16z^2 + 2z^3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]       1 + 3z     3                       3 + 1.30185189290517e-16z + 3z^2                           3 + 1.30185189290517e-16z + 3z^2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]           4z     0                     1 + 5.20740757162067e-16z^2 + 4z^3                         1 + 5.20740757162067e-16z^2 + 4z^3 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">a_red</span>, <span class="va">a</span> <span class="op"><a href="ratm_mult.html">%r%</a></span> <span class="va">v</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="prune.html">prune</a></span><span class="op">(</span>brutal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 4 x 4 ) matrix polynomial with degree &lt;= 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,1]  [,2]      [,3]      [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1 + z + z^2     0       z^3   1 + z^3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]           2z     0  1 + 2z^3  1 + 2z^3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]       1 + 3z     3  3 + 3z^2  3 + 3z^2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]           4z     0  1 + 4z^3  1 + 4z^3 </span>
<span class="r-in"><span><span class="va">a_red</span><span class="op">$</span><span class="va">v</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 4 x 4 ) matrix polynomial with degree &lt;= 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]  [,2]                            [,3]                               [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     1     0     1.30185189290517e-16z + z^2        1.30185189290517e-16z + z^2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]     0     1      0.666666666666667z^2 - z^3         0.666666666666667z^2 - z^3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   z^2     0  -z^2 + 1.92296268638356e-16z^3  1 - z^2 + 1.92296268638356e-16z^3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]     0     0                               1                                  1 </span>
<span class="r-in"><span><span class="va">a_red</span><span class="op">$</span><span class="va">v</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="prune.html">prune</a></span><span class="op">(</span>brutal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 4 x 4 ) matrix polynomial with degree &lt;= 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]  [,2]                        [,3]                        [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     1     0                         z^2                         z^2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]     0     1  0.666666666666667z^2 - z^3  0.666666666666667z^2 - z^3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   z^2     0                        -z^2                     1 - z^2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]     0     0                           1                           1 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check whether original times v^{-1}(z) = col-reduced:</span></span></span>
<span class="r-in"><span><span class="co"># Same as above: non-problematic numerical mistakes, "solved" by brutally pruning</span></span></span>
<span class="r-in"><span><span class="co"># Same for unimodular v^{-1}(z)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">a</span> <span class="op"><a href="ratm_mult.html">%r%</a></span> <span class="va">a_red</span><span class="op">$</span><span class="va">v_inv</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 4 x 4 ) matrix polynomial with degree &lt;= 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  [,1]    [,2]  [,3]                                                                                                  [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1 + z - 4.44089209850063e-16z^2  1e-09z     1  -1.30185189290517e-16z + 5.35948625484577e-16z^2 - 6.66666943871519e-10z^3 + 1.00000052682958e-09z^4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]                               2z       0     0                                                                           1 - 2.60370378581034e-16z^2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]                           1 + 3z       3     0                         3 - 1.30185189290517e-16z - 4.44089209850063e-16z^2 + 2.22044604925031e-16z^4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]                               4z       0     0                                                                           1 - 5.20740757162067e-16z^2 </span>
<span class="r-in"><span><span class="op">(</span><span class="va">a</span> <span class="op"><a href="ratm_mult.html">%r%</a></span> <span class="va">a_red</span><span class="op">$</span><span class="va">v_inv</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="prune.html">prune</a></span><span class="op">(</span>brutal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 4 x 4 ) matrix polynomial with degree &lt;= 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         [,1]  [,2]  [,3]  [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   1 + z     0     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]      2z     0     0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  1 + 3z     3     0     3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]      4z     0     0     1 </span>
<span class="r-in"><span><span class="va">a_red</span><span class="op">$</span><span class="va">a</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 4 x 4 ) matrix polynomial with degree &lt;= 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         [,1]  [,2]  [,3]  [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   1 + z     0     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]      2z     0     0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  1 + 3z     3     0     3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]      4z     0     0     1 </span>
<span class="r-in"><span><span class="va">a_red</span><span class="op">$</span><span class="va">v_inv</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 4 x 4 ) matrix polynomial with degree &lt;= 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]  [,2]  [,3]                                     [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     1     0     0             -1.30185189290517e-16z - z^2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]     0     1     0              -0.666666666666667z^2 + z^3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   z^2     0    -1  1 - z^2 + 6.21110793478396e-17z^3 - z^4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  -z^2     0     1      z^2 - 6.21110793478396e-17z^3 + z^4 </span>
<span class="r-in"><span><span class="va">a_red</span><span class="op">$</span><span class="va">v_inv</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="prune.html">prune</a></span><span class="op">(</span>brutal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 4 x 4 ) matrix polynomial with degree &lt;= 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]  [,2]  [,3]                         [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     1     0     0                         -z^2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]     0     1     0  -0.666666666666667z^2 + z^3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   z^2     0    -1                1 - z^2 - z^4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  -z^2     0     1                    z^2 + z^4 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Krishnarao and Chen example #####################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">0</span>,<span class="op">-</span><span class="fl">2</span>,<span class="fl">2</span>,  </span></span>
<span class="r-in"><span>                  <span class="fl">12</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">5</span>, <span class="fl">1</span>,    </span></span>
<span class="r-in"><span>                  <span class="fl">13</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,   </span></span>
<span class="r-in"><span>                  <span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 2 x 2 ) matrix polynomial with degree &lt;= 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2] z^1 [,1]  [,2] z^2 [,1]  [,2] z^3 [,1]  [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        4    -2       12    -5       13     1        2     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     2        0     1        0     0        0     0</span>
<span class="r-in"><span><span class="va">out</span> <span class="op">=</span> <span class="fu">col_reduce</span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out</span><span class="op">$</span><span class="va">a</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 2 x 2 ) matrix polynomial with degree &lt;= 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2] z^1 [,1]  [,2] z^2 [,1]  [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]       -2     4       -5    16        1    23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        2     0        1    -4        0    -2</span>
<span class="r-in"><span><span class="va">a</span> <span class="op"><a href="ratm_mult.html">%r%</a></span> <span class="va">out</span><span class="op">$</span><span class="va">v_inv</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 2 x 2 ) matrix polynomial with degree &lt;= 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2] z^1 [,1]  [,2] z^2 [,1]  [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]       -2     4       -5    16        1    23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        2     0        1    -4        0    -2</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">out</span>, <span class="va">a</span> <span class="op"><a href="ratm_mult.html">%r%</a></span> <span class="va">v</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 2 x 2 ) matrix polynomial with degree &lt;= 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2] z^1 [,1]  [,2] z^2 [,1]  [,2] z^3 [,1]  [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        4    -2       12    -5       13     1        2     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     2        0     1        0     0        0     0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Majid: Ex 3 ################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">m0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">0</span>, <span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">0</span>,   <span class="fl">0</span>,<span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   -3    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    2    2    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    0    3    2</span>
<span class="r-in"><span><span class="op">(</span><span class="va">m1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">2</span>,   <span class="fl">4</span>,<span class="fl">0</span>,<span class="fl">0</span>,   <span class="fl">0</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">3</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0    0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    4    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    0    1   -3</span>
<span class="r-in"><span><span class="op">(</span><span class="va">m2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,   <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,   <span class="op">-</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   -1    0    0</span>
<span class="r-in"><span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">m0</span>,<span class="va">m1</span>,<span class="va">m2</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]   [,2]    [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  -3 + z^2      1      2z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    2 + 4z      2       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]      -z^2  3 + z  2 - 3z </span>
<span class="r-in"><span><span class="va">m</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="col_end_matrix.html">col_end_matrix</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1    0    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   -1    1   -3</span>
<span class="r-in"><span><span class="va">m</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="col_end_matrix.html">col_end_matrix</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="va">.</span><span class="op">$</span><span class="va">d</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3.9516798 0.6198604 0.0000000</span>
<span class="r-in"><span><span class="va">m</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="degree.html">degree</a></span><span class="op">(</span><span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 1 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">out</span> <span class="op">=</span> <span class="fu">col_reduce</span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $a</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]  [,3] z^1 [,1]  [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0    -3        0     2  -0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        2     0     2        0     0   3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]        3     2     0        1    -3  -2.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $v</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]  [,3] z^1 [,1]  [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        0     1     0      0.5     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     0     1      0.5     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]        1     0     0      0.0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $v_inv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 3 ) matrix polynomial with degree &lt;= 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]  [,3] z^1 [,1]  [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        0     0     1        0     0   0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        1     0     0        0     0  -0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]        0     1     0        0     0  -0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $col_degrees</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $col_end_matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0    2 -0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    0  3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    1   -3 -2.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># Majid: Ex 4 ################3</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">m0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,   <span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    1</span>
<span class="r-in"><span><span class="op">(</span><span class="va">m1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,   <span class="fl">2</span>,<span class="fl">0</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    2    0</span>
<span class="r-in"><span><span class="op">(</span><span class="va">m2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,   <span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    0</span>
<span class="r-in"><span><span class="op">(</span><span class="va">m3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0</span>,   <span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    2    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    0</span>
<span class="r-in"><span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="polm.html">polm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">m0</span>,<span class="va">m1</span>,<span class="va">m2</span>,<span class="va">m3</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 2 x 2 ) matrix polynomial with degree &lt;= 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 [,1]  [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1 + z^2 + 2z^3   z^2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]              2z     1 </span>
<span class="r-in"><span><span class="va">m</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="col_end_matrix.html">col_end_matrix</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    2    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    0</span>
<span class="r-in"><span><span class="va">m</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="col_end_matrix.html">col_end_matrix</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="va">.</span><span class="op">$</span><span class="va">d</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.236068 0.000000</span>
<span class="r-in"><span><span class="va">m</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="degree.html">degree</a></span><span class="op">(</span><span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3 2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">out</span> <span class="op">=</span> <span class="fu">col_reduce</span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $a</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 2 x 2 ) matrix polynomial with degree &lt;= 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2] z^1 [,1]  [,2] z^2 [,1]  [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        0     1        0     0        1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        1    -1        0     0        0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $v</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 2 x 2 ) matrix polynomial with degree &lt;= 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2] z^1 [,1]  [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     1        2     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        1     0        0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $v_inv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 2 x 2 ) matrix polynomial with degree &lt;= 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2] z^1 [,1]  [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        0     1        0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        1    -1        0    -2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $col_degrees</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $col_end_matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://scholar.google.com/citations?user=-Ytb9BYAAAAJ" class="external-link">Wolfgang Scherrer</a>, <a href="https://ch.linkedin.com/in/bernd-funovits-phd-cfa-a8215016" class="external-link">Bernd Funovits</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

