# Create Test Polynomial Matrix

This simple tool creates (random) polynomial matrices for testing
purposes.

## Usage

``` r
test_polm(
  dim = c(1, 1),
  degree = 0,
  random = FALSE,
  digits = NULL,
  col_end_matrix = NULL,
  value_at_0 = NULL,
  bzeroes = NULL,
  n.trials = 100
)
```

## Arguments

- dim:

  two dimensional vector of non negative integers, determines the
  dimension of the polynomial matrix to be created. If the prescribed
  number of rows or number of columns is zero then an "empty" polynomial
  matrix is generated. In this case all parameters below are ignored.

- degree:

  desired degree(s), either a scalar, a vector or a matrix. In the
  matrix case `degree` prescribes the degrees of the entries of the
  polynomial matrix. A vector `degree` defines the column degrees of the
  matrix, i.e. the respective maximal degrees within the columns, and a
  scalar `degree` determines the maximum degree of all entries of the
  matrix. Of course `degree` has to be compatible with the parameter
  `dim`. If the desired degree is \\-1\\ then a zero polynomial is
  generated and the parameters below are ignored.

- random:

  If TRUE the coefficents are generated by drawing from a normal
  distribution. If FALSE then the coefficient of the \\k\\-th power
  \\z^k\\ of the (i,j)-th entry is set equal to "\\ijk\\". In this case
  the parameters below are ignored!

- digits:

  integer, if non NULL then the randomly generated numbers are rounded
  to "digits" number of decimal places.

- col_end_matrix:

  desired column end matrix (or `NULL`).

- value_at_0:

  desired value of the polynomial at \\z=0\\ (or `NULL`).

- bzeroes:

  lower bound for the moduli of the zeroes of the rational matrix (or
  NULL). This parameter is ignored for non-square matrices (m != n).

- n.trials:

  maximum number of trials.

## Value

[`polm`](https://bfunovits.github.io/rationalmatrices/reference/polm.md)
object, which represents the generated polynomial matrix.

## Details

Note that the desired parameters `value_at_0` and `column_end_matrix`
may be in conflict to the desired degree(s). See the examples below.

The matrices `column_end_matrix` and `value_at_0` may contain `NA`'s.
These entries are replaced by randomly generated numbers.

The user may prescribe lower bounds for the moduli of the zeroes of the
polynomial. In this case the procedure simply generates (up to
`n.trials`) random matrices until a matrix is found which satisfies the
constraint. The standard deviation of the normal distribution, which is
used to generate the random entries, is decreased in each step. Of
course this is a very crude method and it may fail or need a very large
number of randomly generated matrices.

## Examples

``` r
### "empty" polynomials, number of rows or number of columns is zero. 
test_polm(dim = c(0,0))
#> ( 0 x 0 ) matrix polynomial with degree <= -1 
test_polm(dim = c(0,2))
#> ( 0 x 2 ) matrix polynomial with degree <= -1 
test_polm(dim = c(3,0))
#> ( 3 x 0 ) matrix polynomial with degree <= -1 

### (3,3) polynomial of degree -1 (i.e. a(z)=0) 
test_polm(dim = c(3,3), degree = -1)
#> ( 3 x 3 ) matrix polynomial with degree <= -1 

### (3,3) polynomial with degree 1 
test_polm(dim = c(3,3), degree = 1) %>% print(format = 'c')
#> ( 3 x 3 ) matrix polynomial with degree <= 1 
#>             [,1]        [,2]        [,3]
#> [1,]  110 + 111z  120 + 121z  130 + 131z
#> [2,]  210 + 211z  220 + 221z  230 + 231z
#> [3,]  310 + 311z  320 + 321z  330 + 331z 

### (3,3) polynomial with column degrees -1, 0 and 1 
test_polm(dim = c(3,3), degree = c(-1,0,1))  %>% print(format = 'c')
#> ( 3 x 3 ) matrix polynomial with degree <= 1 
#>       [,1]  [,2]        [,3]
#> [1,]     0   120  130 + 131z
#> [2,]     0   220  230 + 231z
#> [3,]     0   320  330 + 331z 

### random, (3,3) polynomial with prescribed degrees for each element 
deg = matrix(c(0, 1, 2,
               1,-1,-1,
               1, 1, 1), nrow = 3, ncol = 3, byrow = TRUE)
print(deg)
#>      [,1] [,2] [,3]
#> [1,]    0    1    2
#> [2,]    1   -1   -1
#> [3,]    1    1    1

a = test_polm(dim = c(3,3), degree = deg, random = TRUE)
print(a, digits = 2, format = 'c')
#> ( 3 x 3 ) matrix polynomial with degree <= 2 
#>                [,1]          [,2]                    [,3]
#> [1,]           0.71  0.44 + 1.86z  0.43 - 1.13z + 0.64z^2
#> [2,]  -0.19 - 0.67z             0                       0
#> [3,]  -2.71 + 0.47z  1.17 - 1.61z            -1.31 + 0.3z 

### random, (3,3) polynomial with prescribed column degree and column end matrix
cm = matrix(NA_real_, nrow = 3, ncol = 3)
cm[lower.tri(cm, diag = FALSE)] = 0
a = test_polm(dim = c(3,3), degree = c(0,1,2), random = TRUE, 
              digits = 2, col_end_matrix = cm)
print(a, digits = 2, format = 'c')
#> ( 3 x 3 ) matrix polynomial with degree <= 2 
#>        [,1]           [,2]                    [,3]
#> [1,]  -0.75   1.94 + 0.94z  -0.24 + 0.04z + 0.2z^2
#> [2,]      0  -1.69 - 1.15z  -0.93 + 0.13z - 0.9z^2
#> [3,]      0           0.25  -0.08 - 0.84z + 1.5z^2 
print(degree(a, which = 'column'))
#> [1] 0 1 2
print(col_end_matrix(a))
#>       [,1]  [,2] [,3]
#> [1,] -0.75  0.94  0.2
#> [2,]  0.00 -1.15 -0.9
#> [3,]  0.00  0.00  1.5

### the parameters column_end_matrix and value_at_zero 
### may be in conflict with the prescribed degree(s). 

# E.g. if we set the second column of "cm" equal to zero
cm[, 2] = 0
a = test_polm(dim = c(3,3), degree = c(0,1,2), random = TRUE, 
              digits = 2, col_end_matrix = cm)
print(a, digits = 2, format = 'c')
#> ( 3 x 3 ) matrix polynomial with degree <= 2 
#>        [,1]   [,2]                    [,3]
#> [1,]  -0.22   -0.5  2.57 - 0.32z - 0.67z^2
#> [2,]      0   0.09  0.63 - 0.12z + 0.15z^2
#> [3,]      0  -0.53    2.1 - 0.4z + 1.29z^2 

# then the generated polynomial has column degrees 0,0,2 
# and the column end matrix is not upper triangular!
print(degree(a, which = 'column'))
#> [1] 0 0 2
print(col_end_matrix(a))
#>       [,1]  [,2]  [,3]
#> [1,] -0.22 -0.50 -0.67
#> [2,]  0.00  0.09  0.15
#> [3,]  0.00 -0.53  1.29

### here we set a(0) equal to the identity matrix and 
### require that a(z) has no zeroes within the unit circle
a = try(test_polm(dim = c(3,3), degree = 2, random = TRUE, 
        digits = 2, value_at_0 = diag(3), bzeroes = 1))
if (!inherits(a, 'try-error')) {
  print(a, digits = 2, format = 'c')
  print(abs(zeroes(a)))
}
#> ( 3 x 3 ) matrix polynomial with degree <= 2 
#>                      [,1]                 [,2]                 [,3]
#> [1,]  1 - 0.32z - 0.39z^2     -0.06z + 0.52z^2                0.17z
#> [2,]     -0.18z - 0.64z^2  1 + 0.49z + 0.53z^2     -0.18z + 0.02z^2
#> [3,]       0.18z + 0.4z^2      0.66z - 0.01z^2  1 + 0.21z + 0.07z^2 
#> [1] 1.278922 1.278922 1.385339 2.257975 2.257975 6.705406
```
