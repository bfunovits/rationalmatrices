<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Construct an RMFD Representation from Impulse Response — pseries2rmfd • rationalmatrices</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Construct an RMFD Representation from Impulse Response — pseries2rmfd"><meta name="description" content="This (helper) function constructs a right matrix fraction description of a rational matrix from its impulse response.
Of course, the impulse response must contain sufficently many lags.
The constructed RMFD is in canonical form."><meta property="og:description" content="This (helper) function constructs a right matrix fraction description of a rational matrix from its impulse response.
Of course, the impulse response must contain sufficently many lags.
The constructed RMFD is in canonical form."><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rationalmatrices</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/a_rational_matrices.html">Rational Matrices</a></li>
    <li><a class="dropdown-item" href="../articles/b_technical_details_ratm.html">Rational Matrices: Technical Details</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../claude.html">Claude Guide</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bfunovits/rationalmatrices/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Construct an RMFD Representation from Impulse Response</h1>

      <div class="d-none name"><code>pseries2rmfd.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This (helper) function constructs a right matrix fraction description of a rational matrix from its impulse response.
Of course, the impulse response must contain sufficently many lags.
The constructed RMFD is in canonical form.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pseries2rmfd</span><span class="op">(</span><span class="va">obj</span>, Hsize <span class="op">=</span> <span class="cn">NULL</span>, mu <span class="op">=</span> <span class="cn">NULL</span>, tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-obj">obj<a class="anchor" aria-label="anchor" href="#arg-obj"></a></dt>
<dd><p><code><a href="pseries.html">pseries</a></code> object or 3-D array with dimension \((m,n,l+1)\).</p></dd>


<dt id="arg-hsize">Hsize<a class="anchor" aria-label="anchor" href="#arg-hsize"></a></dt>
<dd><p>integer vector <code>c(f,p)</code>, number of block rows and block columns of the Hankel matrix which is used to construct the RMFD.
If NULL a default choice is made.</p></dd>


<dt id="arg-mu">mu<a class="anchor" aria-label="anchor" href="#arg-mu"></a></dt>
<dd><p>integer vector with the right-Kronecker indices.
If <code>NULL</code> then the right-Kronecker indices are computed via a QR decomposition of the transpose of the Hankel matrix, see <code><a href="https://rdrr.io/r/base/qr.html" class="external-link">qr</a></code>.</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>tolerance parameter, used by <code><a href="https://rdrr.io/r/base/qr.html" class="external-link">qr</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List with components</p>
<dl><dt>Xr</dt>
<dd><p><code><a href="rmfd.html">rmfd</a></code> object which contains the RMFD resresentation
         of the rational matrix (in echelon form).</p></dd>

<dt>mu</dt>
<dd><p>integer vector with the right-Kronecker indices.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>There are a number of restrictions on the dimension \((m,n)\) and number of lags \(l\) of the impulse response,
the number of block rows (\(f\)), block columns (\(p\)) of the Hankel matrix and the right-Kronecker indices \(\mu_i\):</p>
<p>We require that:</p><ul><li><p>\(m&gt;0\), \(p&gt;0\), \(f&gt;1\),</p></li>
<li><p>\(l \geq f+p-1\) and</p></li>
<li><p>\(\nu_i &lt;f\).</p></li>
</ul><p>If these restrictions are not satisfied an error is thrown.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># generate a random RMFD object</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">=</span> <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">q</span> <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">cc</span> <span class="op">=</span> <span class="fu"><a href="test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">n</span>,<span class="va">n</span><span class="op">)</span>, degree <span class="op">=</span> <span class="va">p</span>, random <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dd</span> <span class="op">=</span> <span class="fu"><a href="test_polm.html">test_polm</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">m</span>,<span class="va">n</span><span class="op">)</span>, degree <span class="op">=</span> <span class="va">q</span>, random <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Xr</span> <span class="op">=</span> <span class="fu"><a href="rmfd.html">rmfd</a></span><span class="op">(</span><span class="va">cc</span>,<span class="va">dd</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compute impulse response of this matrix</span></span></span>
<span class="r-in"><span><span class="va">Xi</span> <span class="op">=</span> <span class="fu"><a href="pseries.html">pseries</a></span><span class="op">(</span><span class="va">Xr</span>, lag.max <span class="op">=</span> <span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">p</span>,<span class="va">q</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># reconstruct a matrix from this impulse response</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">=</span> <span class="fu">pseries2rmfd</span><span class="op">(</span><span class="va">Xi</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'X' matrix was collinear</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'X' matrix was collinear</span>
<span class="r-in"><span><span class="va">out</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Xr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 3 x 2 ) right matrix fraction description d(z) c^(-1)(z) with degrees deg(c(z)) = p = 1, deg(d(z)) = q = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> left factor d(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       z^0 [,1]       [,2]   z^1 [,1]       [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  49.02065  39.684749  -14.82652  -12.10711</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 148.21825 120.537069 -248.87162 -201.31285</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -10.25606  -8.293895   41.56984   33.61174</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> right factor c(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2] z^1 [,1]     [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0 88.46234 70.67135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1  0.00000  0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $mu</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># check that the lmfd object is a realization of the given impulse response</span></span></span>
<span class="r-in"><span><span class="va">Xi1</span> <span class="op">=</span> <span class="fu"><a href="pseries.html">pseries</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">Xr</span>, lag.max <span class="op">=</span> <span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">p</span>,<span class="va">q</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">Xi</span>, <span class="va">Xi1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Mean relative difference: 0.0002085268"</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://scholar.google.com/citations?user=-Ytb9BYAAAAJ" class="external-link">Wolfgang Scherrer</a>, <a href="https://ch.linkedin.com/in/bernd-funovits-phd-cfa-a8215016" class="external-link">Bernd Funovits</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

