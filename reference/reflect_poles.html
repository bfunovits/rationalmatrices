<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Given a square, rational matrix \(x(z)\) and a set of poles of \(x(z)\), 
the function reflect_poles constructs an allpass matrix \(U(z)\) 
such that \(x(z)U(z)\) has poles which are the reciprocals of the 
selected poles and the other poles are not changed. 
Also the zeroes are not changed, i.e. \(x\) and \(xU\) have the same zeroes."><title>Reflect Poles of Rational Matrices — reflect_poles • rationalmatrices</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Reflect Poles of Rational Matrices — reflect_poles"><meta property="og:description" content="Given a square, rational matrix \(x(z)\) and a set of poles of \(x(z)\), 
the function reflect_poles constructs an allpass matrix \(U(z)\) 
such that \(x(z)U(z)\) has poles which are the reciprocals of the 
selected poles and the other poles are not changed. 
Also the zeroes are not changed, i.e. \(x\) and \(xU\) have the same zeroes."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rationalmatrices</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a_rational_matrices.html">Rational Matrices</a>
    <a class="dropdown-item" href="../articles/b_technical_details_ratm.html">Rational Matrices: Technical Details</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bfunovits/rationalmatrices/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Reflect Poles of Rational Matrices</h1>
      
      <div class="d-none name"><code>reflect_poles.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Given a square, rational matrix \(x(z)\) and a set of poles of \(x(z)\), 
the function <code>reflect_poles</code> constructs an allpass matrix \(U(z)\) 
such that \(x(z)U(z)\) has poles which are the reciprocals of the 
selected poles and the other poles are not changed. 
Also the zeroes are not changed, i.e. \(x\) and \(xU\) have the same zeroes.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">reflect_poles</span><span class="op">(</span><span class="va">x</span>, <span class="va">poles</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for stsp</span></span>
<span><span class="fu">reflect_poles</span><span class="op">(</span><span class="va">x</span>, <span class="va">poles</span>, tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for rmfd</span></span>
<span><span class="fu">reflect_poles</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">poles</span>,</span>
<span>  tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">)</span>,</span>
<span>  check_poles <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>Square, rational matrix object (with real coefficients).</p></dd>


<dt>poles</dt>
<dd><p>Complex or real vector of poles to be reflected. 
It is assumed that for complex conjugated pairs of poles, 
only <b>one</b> is contained in this vector.</p></dd>


<dt>...</dt>
<dd><p>Not used.</p></dd>


<dt>tol</dt>
<dd><p>(double) Tolerance parameter used for the checks.</p></dd>


<dt>check_poles</dt>
<dd><p>If <code>TRUE</code> then the procedure checks that the 
given poles are poles of the rational matrix x(z).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Rational matrix object which represents the rational matrix</p>
<p></p>
<p>\(x(z)U(z)\) with the reflected poles. The object is of the 
        same class as the input object <code>x</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The procedures are only implemented for rational matrices with real coefficients. 
Therefore complex poles occur in complex conjugated pairs and such pairs are
<b>jointly</b> reflected to ensure that the result again has real coefficients. 
Note however, that the argument <code>poles</code> must only contain <b>one</b> element 
of the pairs to be reflected.</p> 
<p>In some degnerate cases the procedure(s) may run into numerical problems: 
For matrices in <code>rmfd</code> form, 
the procedure assumes that the matrix has no poles at \(z=0\). 
For the matrices in statespace form, poles 
on (or close to) the unit circle are not allowed. In addition multiple 
poles may lead to unreliable results.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>The procedure uses the helper functions <code><a href="blaschke.html">blaschke</a></code> 
         and <code><a href="make_allpass.html">make_allpass</a></code>. For reflecting zeroes, 
         see <code><a href="reflect_zeroes.html">reflect_zeroes</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># ###################################################################</span></span></span>
<span class="r-in"><span><span class="co"># rational matrix in statespace form ('stsp' object)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># create random (2,2) rational matrix in state space form </span></span></span>
<span class="r-in"><span><span class="co"># with state dimension s=5</span></span></span>
<span class="r-in"><span><span class="op">(</span> <span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="test_stsp.html">test_stsp</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, s <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> statespace realization [2,2] with s = 5 states</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            s[1]       s[2]       s[3]       s[4]       s[5]        u[1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[1]  0.5855288 -0.2761841 -0.7505320  1.4557851  0.6121235  0.49118828</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[2]  0.7094660 -0.2841597  0.8168998 -0.6443284 -0.1623110 -0.32408658</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[3] -0.1093033 -0.9193220 -0.8863575 -1.5531374  0.8118732 -1.66205024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[4] -0.4534972 -0.1162478 -0.3315776 -1.5977095  2.1968335  1.76773385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[5]  0.6058875  1.8173120  1.1207127  1.8050975  2.0491903  0.02580105</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[1] -1.8179560  0.3706279  0.2987237 -0.4816474  1.6324456  1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[2]  0.6300986  0.5202165  0.7796219  0.6203798  0.2542712  0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            u[2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[1]  1.1285108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[2] -2.3803581</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[3] -1.0602656</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[4]  0.9371405</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[5]  0.8544517</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[1]  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[2]  1.0000000</span>
<span class="r-in"><span><span class="co"># poles of x(z)</span></span></span>
<span class="r-in"><span><span class="op">(</span> <span class="va">x_poles</span> <span class="op">=</span> <span class="fu"><a href="poles_and_zeroes.html">poles</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  0.3228713+0.0000000i -0.3326091+0.0000000i  0.0091529-0.8604103i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4]  0.0091529+0.8604103i -4.0175418+0.0000000i</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># reflect all unstable poles (inside the unit circle) ###########</span></span></span>
<span class="r-in"><span><span class="co"># note: for complex zeroes, select only one of the complex conjugated pair!</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">=</span> <span class="fu">reflect_poles</span><span class="op">(</span><span class="va">x</span>, poles <span class="op">=</span> <span class="va">x_poles</span><span class="op">[</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">x_poles</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Im</a></span><span class="op">(</span><span class="va">x_poles</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">0</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">r_poles</span> <span class="op">=</span> <span class="va">x_poles</span></span></span>
<span class="r-in"><span><span class="va">r_poles</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">r_poles</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">r_poles</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">r_poles</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">x1_poles</span> <span class="op">=</span> <span class="fu"><a href="poles_and_zeroes.html">poles</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  0.012362-1.162105i  0.012362+1.162105i -3.006533+0.000000i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4]  3.097209+0.000000i -4.017542+0.000000i</span>
<span class="r-in"><span><span class="va">j</span> <span class="op">=</span> <span class="fu"><a href="match_vectors.html">match_vectors</a></span><span class="op">(</span><span class="va">r_poles</span>, <span class="va">x1_poles</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">r_poles</span>, <span class="va">x1_poles</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check that the transformation matrix U (x1 = x %r% U) is all-pass</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="ratm_mult.html">%r%</a></span> <span class="fu"><a href="Ht.html">Ht</a></span><span class="op">(</span><span class="fu"><a href="zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> <span class="op"><a href="ratm_mult.html">%r%</a></span> <span class="fu"><a href="Ht.html">Ht</a></span><span class="op">(</span><span class="fu"><a href="zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ###################################################################</span></span></span>
<span class="r-in"><span><span class="co"># rational matrix in RMFD form</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># create random (2 x 2) rational matrix in RMFD form with degrees (2,1)</span></span></span>
<span class="r-in"><span><span class="op">(</span> <span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="test_rmfd.html">test_rmfd</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, degree <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ( 2 x 2 ) right matrix fraction description d(z) c^(-1)(z) with degrees deg(c(z)) = p = 2, deg(d(z)) = q = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> left factor d(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        z^0 [,1]       [,2]  z^1 [,1]       [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.2841597 -0.1162478 0.3706279 -0.7505320</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.9193220  1.8173120 0.5202165  0.8168998</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> right factor c(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]  z^1 [,1]       [,2]   z^2 [,1]       [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0 0.5855288 -0.1093033  0.6058875  0.6300986</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1 0.7094660 -0.4534972 -1.8179560 -0.2761841</span>
<span class="r-in"><span><span class="co"># poles of x(z)</span></span></span>
<span class="r-in"><span><span class="op">(</span> <span class="va">x_poles</span> <span class="op">=</span> <span class="fu"><a href="poles_and_zeroes.html">poles</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.492635-0.6478764i -0.492635+0.6478764i  1.045832-0.6704744i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4]  1.045832+0.6704744i</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># reflect all unstable poles (inside the unit circle) ###########</span></span></span>
<span class="r-in"><span><span class="co"># note: for complex zeroes, select only one of the complex conjugated pair!</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">=</span> <span class="fu">reflect_poles</span><span class="op">(</span><span class="va">x</span>, poles <span class="op">=</span> <span class="va">x_poles</span><span class="op">[</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">x_poles</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Im</a></span><span class="op">(</span><span class="va">x_poles</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">0</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">r_poles</span> <span class="op">=</span> <span class="va">x_poles</span></span></span>
<span class="r-in"><span><span class="va">r_poles</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">r_poles</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">r_poles</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">r_poles</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">x1_poles</span> <span class="op">=</span> <span class="fu"><a href="poles_and_zeroes.html">poles</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.7436752-0.9780254i -0.7436752+0.9780254i  1.0458317-0.6704744i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4]  1.0458317+0.6704744i</span>
<span class="r-in"><span><span class="va">j</span> <span class="op">=</span> <span class="fu"><a href="match_vectors.html">match_vectors</a></span><span class="op">(</span><span class="va">r_poles</span>, <span class="va">x1_poles</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">r_poles</span>, <span class="va">x1_poles</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check that the transformation matrix U (x1 = x %r% U) is all-pass</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="ratm_mult.html">%r%</a></span> <span class="fu"><a href="Ht.html">Ht</a></span><span class="op">(</span><span class="fu"><a href="zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> <span class="op"><a href="ratm_mult.html">%r%</a></span> <span class="fu"><a href="Ht.html">Ht</a></span><span class="op">(</span><span class="fu"><a href="zvalues.html">zvalues</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://scholar.google.com/citations?user=-Ytb9BYAAAAJ" class="external-link">Wolfgang Scherrer</a>, <a href="https://ch.linkedin.com/in/bernd-funovits-phd-cfa-a8215016" class="external-link">Bernd Funovits</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

