<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This helper function implements the Ho-Kalman algorithm."><title>Ho-Kalman Realization Algorithm — pseries2stsp • rationalmatrices</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Ho-Kalman Realization Algorithm — pseries2stsp"><meta property="og:description" content="This helper function implements the Ho-Kalman algorithm."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rationalmatrices</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a_rational_matrices.html">Rational Matrices</a>
    <a class="dropdown-item" href="../articles/b_technical_details_ratm.html">Rational Matrices: Technical Details</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Ho-Kalman Realization Algorithm</h1>
      
      <div class="d-none name"><code>pseries2stsp.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This helper function implements the Ho-Kalman algorithm.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pseries2stsp</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"balanced"</span>, <span class="st">"echelon"</span><span class="op">)</span>,</span>
<span>  Hsize <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  s <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nu <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">)</span>,</span>
<span>  Wrow <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Wcol <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>obj</dt>
<dd><p><code><a href="pseries.html">pseries</a></code> object or 3-D array with dimension \((m,n,l+1)\).</p></dd>


<dt>method</dt>
<dd><p>Character string, which determines the method and the "parametrization" type
of the state space model. See below for more details.</p></dd>


<dt>Hsize</dt>
<dd><p>integer vector <code>c(f,p)</code>, number of block rows and block columns
of the Hankel matrix which is used to construct the statespace realization.
If NULL a default choice is made.</p></dd>


<dt>s</dt>
<dd><p>desired state dimension. Only used for <code>method = "balanced"</code>.
Note however, if \(s\) is larger than the rank of the Hankel matrix,
then the procedure will break down.
If <code>s</code> is missing, then the state dimension is determined from
the singular values of the Hankel matrix.
To be precise the state dimension is chosen as the number of singular values which are
greater than or equal to <code>tol</code> times the maximum singular value.</p></dd>


<dt>nu</dt>
<dd><p>Kronecker indices. Only used for  <code>method = "echelon"</code>.
If missing, then <code>nu</code> is computed with a QR decomposition of the
transpose of the Hankel matrix of the impulse response coefficients.</p></dd>


<dt>tol</dt>
<dd><p>tolerance parameter used for the QR decomposition or the SVD decomposition
of the Hankel matrix \(H\) of the impulse response coefficients.</p></dd>


<dt>Wrow, Wcol</dt>
<dd><p>weighting matrices (default is no weighting, i.e. identity matrices).
These weighting matrices are only used for <code>method="balanced"</code>, where the
SVD of the weighted Hankel matrix <code>Wrow %*% H %*% t(Wcol)</code> is computed.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>List with slots</p>
<dl><dt>Xs</dt>
<dd><p><code><a href="stsp.html">stsp</a></code> object, the rational matrix in statespace form</p></dd>

<dt>Hsv</dt>
<dd><p>Singular values of the Hankel matrix for <code>method='balanced'</code> and <code>NULL</code> else.</p></dd>

<dt>nu</dt>
<dd><p>Kronecker indices for <code>method='echelon'</code> and <code>NULL</code> else.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The procedure(s) may be used for model reduction (with some care).</p>
<p>There are a number of restrictions on the number of lags \(l\)
of the impulse response, the number of block rows (\(f\)),
block columns (\(p\)) of the Hankel matrix and the Kronecker
indices \(\nu_i\). We require that:
\(p&gt;0\), \(f&gt;1\),
\(l \geq f+p-1\) and \(\nu_i &lt;f\).
If these restrictions are not satisfied an error is thrown.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># generate random rational matrix X(z) in statespace form</span></span></span>
<span class="r-in"><span><span class="co"># make sure that the A matrix is stable</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">=</span> <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">=</span> <span class="fl">7</span></span></span>
<span class="r-in"><span><span class="va">A</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">s</span><span class="op">*</span><span class="va">s</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">s</span>, ncol <span class="op">=</span> <span class="va">s</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">A</span> <span class="op">=</span> <span class="va">A</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1.1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="va">A</span>, only.values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">values</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Xs</span> <span class="op">=</span> <span class="fu"><a href="stsp.html">stsp</a></span><span class="op">(</span><span class="va">A</span>, B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">s</span><span class="op">*</span><span class="va">n</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">s</span>, ncol <span class="op">=</span> <span class="va">n</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">s</span><span class="op">*</span><span class="va">m</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">m</span>, ncol <span class="op">=</span> <span class="va">s</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          D <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, nrow <span class="op">=</span> <span class="va">m</span>, ncol <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Xi</span> <span class="op">=</span> <span class="fu"><a href="pseries.html">pseries</a></span><span class="op">(</span><span class="va">Xs</span>, lag.max <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">=</span> <span class="fu">pseries2stsp</span><span class="op">(</span><span class="va">Xi</span>, method <span class="op">=</span> <span class="st">'balanced'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Xs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> statespace realization [3,2] with s = 7 states</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             s[1]         s[2]        s[3]        s[4]          s[5]        s[6]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[1]  0.94059576 -0.077400057 -0.14467953 -0.10142121  0.0008186168 -0.03978968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[2]  0.13979877 -0.391080136  0.43510004  0.26385470 -0.1920962871 -0.10392392</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[3]  0.19215554  0.170454565 -0.09702761 -0.17671571 -0.2023622757  0.12768778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[4] -0.03104238 -0.643291247  0.31225486 -0.10452909  0.0991831151 -0.06277821</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[5]  0.01136420  0.172348201  0.30454896  0.12242087 -0.5621051342  0.11346711</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[6] -0.02402529 -0.084165683 -0.10863003 -0.19484134 -0.5706754654  0.16468170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[7] -0.00158137  0.008479835  0.04223383 -0.08950554  0.0814023245  0.30049401</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[1]  0.37524517  0.315063567  0.99848755 -0.60132403  0.1319152937  0.16531778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[2]  0.13220776  0.976381715  0.30715097  0.11136427 -0.0379094538 -0.32236101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[3] -0.65787270 -0.203696993 -0.24002398 -0.99523744 -0.1478933766 -0.21448852</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              s[7]        u[1]         u[2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[1] -0.010729627  0.28617084 -0.763454772</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[2] -0.043342636  0.64065669  0.940671073</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[3]  0.064504440 -0.94489090  0.817468020</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[4]  0.091902326 -0.63576753 -0.357681166</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[5] -0.079535367 -0.09549396 -0.154750062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[6]  0.193961292  0.09813842  0.010462806</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[7] -0.733126907  0.02750497  0.007446502</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[1] -0.007200611  1.00000000  0.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[2]  0.038605876  0.00000000  1.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[3] -0.057758278  0.00000000  0.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Hsv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 4.989318e+00 2.222811e+00 1.895922e+00 1.665142e+00 4.444566e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6] 2.675638e-01 9.535001e-02 4.345988e-16 3.423288e-16 3.128856e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] 2.953181e-16 2.559072e-16 2.177170e-16 1.769149e-16 1.422830e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] 1.321921e-16 9.415949e-17 7.567866e-17 6.810119e-17 5.112092e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $nu</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># check impulse response</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="pseries.html">pseries</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">Xs</span>, lag.max <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>, <span class="va">Xi</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Xs1</span> <span class="op">=</span> <span class="fu"><a href="as.stsp.html">as.stsp</a></span><span class="op">(</span><span class="va">Xi</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">Xs1</span>, <span class="va">out</span><span class="op">$</span><span class="va">Xs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">=</span> <span class="fu">pseries2stsp</span><span class="op">(</span><span class="va">Xi</span>, method <span class="op">=</span> <span class="st">'echelon'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Xs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> statespace realization [3,2] with s = 7 states</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             s[1]        s[2]        s[3]        s[4]       s[5]       s[6]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[1]  0.00000000  0.00000000  0.00000000  1.00000000  0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[2]  0.00000000  0.00000000  0.00000000  0.00000000  1.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[3]  0.00000000  0.00000000  0.00000000  0.00000000  0.0000000  1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[4]  0.00000000  0.00000000  0.00000000  0.00000000  0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[5]  0.07171019  0.09925553 -0.06150195 -0.04182307 -0.7976700 -0.2799509</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[6] -0.30898396  0.32531639 -0.11511100 -0.58224594  0.4533548 -0.9470607</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[7]  0.14974483 -0.13227020  0.06138948  0.36205164  0.1158408  0.4834687</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[1]  1.00000000  0.00000000  0.00000000  0.00000000  0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[2]  0.00000000  1.00000000  0.00000000  0.00000000  0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[3]  0.00000000  0.00000000  1.00000000  0.00000000  0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            s[7]        u[1]       u[2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[1]  0.0000000 -0.24849885  1.0224646</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[2]  0.0000000  0.27537951  1.0315537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[3]  0.0000000  0.53225702  0.4906222</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[4]  1.0000000  0.72432651 -0.1122603</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[5]  0.5935999 -0.72912387 -0.3388397</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[6] -1.7121241  0.42327569  0.8356666</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[7]  0.9621392  0.04322717 -0.8011817</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[1]  0.0000000  1.00000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[2]  0.0000000  0.00000000  1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[3]  0.0000000  0.00000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Hsv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $nu</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3 2 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># check impulse response</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="pseries.html">pseries</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">Xs</span>, lag.max <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>, <span class="va">Xi</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Xs1</span> <span class="op">=</span> <span class="fu"><a href="as.stsp.html">as.stsp</a></span><span class="op">(</span><span class="va">Xi</span>, method <span class="op">=</span> <span class="st">'echelon'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">Xs1</span>, <span class="va">out</span><span class="op">$</span><span class="va">Xs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Wolfgang Scherrer, Bernd Funovits.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

